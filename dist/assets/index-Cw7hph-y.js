var Rw=Object.defineProperty;var Dw=(t,e,n)=>e in t?Rw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Di=(t,e,n)=>Dw(t,typeof e!="symbol"?e+"":e,n);function jw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ld(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Lw(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Dm={exports:{}},Hl={},jm={exports:{}},V={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Js=Symbol.for("react.element"),$w=Symbol.for("react.portal"),zw=Symbol.for("react.fragment"),Bw=Symbol.for("react.strict_mode"),Fw=Symbol.for("react.profiler"),Uw=Symbol.for("react.provider"),Vw=Symbol.for("react.context"),Hw=Symbol.for("react.forward_ref"),Ww=Symbol.for("react.suspense"),qw=Symbol.for("react.memo"),Kw=Symbol.for("react.lazy"),$f=Symbol.iterator;function Jw(t){return t===null||typeof t!="object"?null:(t=$f&&t[$f]||t["@@iterator"],typeof t=="function"?t:null)}var Lm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$m=Object.assign,zm={};function Ei(t,e,n){this.props=t,this.context=e,this.refs=zm,this.updater=n||Lm}Ei.prototype.isReactComponent={};Ei.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ei.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Bm(){}Bm.prototype=Ei.prototype;function ad(t,e,n){this.props=t,this.context=e,this.refs=zm,this.updater=n||Lm}var ud=ad.prototype=new Bm;ud.constructor=ad;$m(ud,Ei.prototype);ud.isPureReactComponent=!0;var zf=Array.isArray,Fm=Object.prototype.hasOwnProperty,cd={current:null},Um={key:!0,ref:!0,__self:!0,__source:!0};function Vm(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Fm.call(e,r)&&!Um.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Js,type:t,key:s,ref:o,props:i,_owner:cd.current}}function Gw(t,e){return{$$typeof:Js,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function dd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Js}function Qw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Bf=/\/+/g;function Ia(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Qw(""+t.key):e.toString(36)}function Vo(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Js:case $w:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ia(o,0):r,zf(i)?(n="",t!=null&&(n=t.replace(Bf,"$&/")+"/"),Vo(i,e,n,"",function(u){return u})):i!=null&&(dd(i)&&(i=Gw(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Bf,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",zf(t))for(var l=0;l<t.length;l++){s=t[l];var a=r+Ia(s,l);o+=Vo(s,e,n,a,i)}else if(a=Jw(t),typeof a=="function")for(t=a.call(t),l=0;!(s=t.next()).done;)s=s.value,a=r+Ia(s,l++),o+=Vo(s,e,n,a,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ho(t,e,n){if(t==null)return t;var r=[],i=0;return Vo(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Yw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ue={current:null},Ho={transition:null},Xw={ReactCurrentDispatcher:Ue,ReactCurrentBatchConfig:Ho,ReactCurrentOwner:cd};function Hm(){throw Error("act(...) is not supported in production builds of React.")}V.Children={map:ho,forEach:function(t,e,n){ho(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ho(t,function(){e++}),e},toArray:function(t){return ho(t,function(e){return e})||[]},only:function(t){if(!dd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};V.Component=Ei;V.Fragment=zw;V.Profiler=Fw;V.PureComponent=ad;V.StrictMode=Bw;V.Suspense=Ww;V.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xw;V.act=Hm;V.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=$m({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=cd.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)Fm.call(e,a)&&!Um.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Js,type:t.type,key:i,ref:s,props:r,_owner:o}};V.createContext=function(t){return t={$$typeof:Vw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Uw,_context:t},t.Consumer=t};V.createElement=Vm;V.createFactory=function(t){var e=Vm.bind(null,t);return e.type=t,e};V.createRef=function(){return{current:null}};V.forwardRef=function(t){return{$$typeof:Hw,render:t}};V.isValidElement=dd;V.lazy=function(t){return{$$typeof:Kw,_payload:{_status:-1,_result:t},_init:Yw}};V.memo=function(t,e){return{$$typeof:qw,type:t,compare:e===void 0?null:e}};V.startTransition=function(t){var e=Ho.transition;Ho.transition={};try{t()}finally{Ho.transition=e}};V.unstable_act=Hm;V.useCallback=function(t,e){return Ue.current.useCallback(t,e)};V.useContext=function(t){return Ue.current.useContext(t)};V.useDebugValue=function(){};V.useDeferredValue=function(t){return Ue.current.useDeferredValue(t)};V.useEffect=function(t,e){return Ue.current.useEffect(t,e)};V.useId=function(){return Ue.current.useId()};V.useImperativeHandle=function(t,e,n){return Ue.current.useImperativeHandle(t,e,n)};V.useInsertionEffect=function(t,e){return Ue.current.useInsertionEffect(t,e)};V.useLayoutEffect=function(t,e){return Ue.current.useLayoutEffect(t,e)};V.useMemo=function(t,e){return Ue.current.useMemo(t,e)};V.useReducer=function(t,e,n){return Ue.current.useReducer(t,e,n)};V.useRef=function(t){return Ue.current.useRef(t)};V.useState=function(t){return Ue.current.useState(t)};V.useSyncExternalStore=function(t,e,n){return Ue.current.useSyncExternalStore(t,e,n)};V.useTransition=function(){return Ue.current.useTransition()};V.version="18.3.1";jm.exports=V;var C=jm.exports;const me=ld(C),Zw=jw({__proto__:null,default:me},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1=C,t1=Symbol.for("react.element"),n1=Symbol.for("react.fragment"),r1=Object.prototype.hasOwnProperty,i1=e1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s1={key:!0,ref:!0,__self:!0,__source:!0};function Wm(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)r1.call(e,r)&&!s1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:t1,type:t,key:s,ref:o,props:i,_owner:i1.current}}Hl.Fragment=n1;Hl.jsx=Wm;Hl.jsxs=Wm;Dm.exports=Hl;var k=Dm.exports,Du={},qm={exports:{}},at={},Km={exports:{}},Jm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(P,$){var F=P.length;P.push($);e:for(;0<F;){var ie=F-1>>>1,fe=P[ie];if(0<i(fe,$))P[ie]=$,P[F]=fe,F=ie;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var $=P[0],F=P.pop();if(F!==$){P[0]=F;e:for(var ie=0,fe=P.length,co=fe>>>1;ie<co;){var Jn=2*(ie+1)-1,Aa=P[Jn],Gn=Jn+1,fo=P[Gn];if(0>i(Aa,F))Gn<fe&&0>i(fo,Aa)?(P[ie]=fo,P[Gn]=F,ie=Gn):(P[ie]=Aa,P[Jn]=F,ie=Jn);else if(Gn<fe&&0>i(fo,F))P[ie]=fo,P[Gn]=F,ie=Gn;else break e}}return $}function i(P,$){var F=P.sortIndex-$.sortIndex;return F!==0?F:P.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var a=[],u=[],c=1,d=null,f=3,h=!1,p=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(P){for(var $=n(u);$!==null;){if($.callback===null)r(u);else if($.startTime<=P)r(u),$.sortIndex=$.expirationTime,e(a,$);else break;$=n(u)}}function x(P){if(m=!1,w(P),!p)if(n(a)!==null)p=!0,Ma(b);else{var $=n(u);$!==null&&Pa(x,$.startTime-P)}}function b(P,$){p=!1,m&&(m=!1,g(_),_=-1),h=!0;var F=f;try{for(w($),d=n(a);d!==null&&(!(d.expirationTime>$)||P&&!et());){var ie=d.callback;if(typeof ie=="function"){d.callback=null,f=d.priorityLevel;var fe=ie(d.expirationTime<=$);$=t.unstable_now(),typeof fe=="function"?d.callback=fe:d===n(a)&&r(a),w($)}else r(a);d=n(a)}if(d!==null)var co=!0;else{var Jn=n(u);Jn!==null&&Pa(x,Jn.startTime-$),co=!1}return co}finally{d=null,f=F,h=!1}}var S=!1,E=null,_=-1,D=5,R=-1;function et(){return!(t.unstable_now()-R<D)}function Ii(){if(E!==null){var P=t.unstable_now();R=P;var $=!0;try{$=E(!0,P)}finally{$?Ri():(S=!1,E=null)}}else S=!1}var Ri;if(typeof v=="function")Ri=function(){v(Ii)};else if(typeof MessageChannel<"u"){var Lf=new MessageChannel,Iw=Lf.port2;Lf.port1.onmessage=Ii,Ri=function(){Iw.postMessage(null)}}else Ri=function(){y(Ii,0)};function Ma(P){E=P,S||(S=!0,Ri())}function Pa(P,$){_=y(function(){P(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,Ma(b))},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(P){switch(f){case 1:case 2:case 3:var $=3;break;default:$=f}var F=f;f=$;try{return P()}finally{f=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(P,$){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var F=f;f=P;try{return $()}finally{f=F}},t.unstable_scheduleCallback=function(P,$,F){var ie=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?ie+F:ie):F=ie,P){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=F+fe,P={id:c++,callback:$,priorityLevel:P,startTime:F,expirationTime:fe,sortIndex:-1},F>ie?(P.sortIndex=F,e(u,P),n(a)===null&&P===n(u)&&(m?(g(_),_=-1):m=!0,Pa(x,F-ie))):(P.sortIndex=fe,e(a,P),p||h||(p=!0,Ma(b))),P},t.unstable_shouldYield=et,t.unstable_wrapCallback=function(P){var $=f;return function(){var F=f;f=$;try{return P.apply(this,arguments)}finally{f=F}}}})(Jm);Km.exports=Jm;var o1=Km.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l1=C,lt=o1;function O(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Gm=new Set,vs={};function Or(t,e){di(t,e),di(t+"Capture",e)}function di(t,e){for(vs[t]=e,t=0;t<e.length;t++)Gm.add(e[t])}var en=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ju=Object.prototype.hasOwnProperty,a1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ff={},Uf={};function u1(t){return ju.call(Uf,t)?!0:ju.call(Ff,t)?!1:a1.test(t)?Uf[t]=!0:(Ff[t]=!0,!1)}function c1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function d1(t,e,n,r){if(e===null||typeof e>"u"||c1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ve(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var _e={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_e[t]=new Ve(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_e[e]=new Ve(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_e[t]=new Ve(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_e[t]=new Ve(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_e[t]=new Ve(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_e[t]=new Ve(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_e[t]=new Ve(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_e[t]=new Ve(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_e[t]=new Ve(t,5,!1,t.toLowerCase(),null,!1,!1)});var fd=/[\-:]([a-z])/g;function hd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fd,hd);_e[e]=new Ve(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fd,hd);_e[e]=new Ve(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fd,hd);_e[e]=new Ve(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_e[t]=new Ve(t,1,!1,t.toLowerCase(),null,!1,!1)});_e.xlinkHref=new Ve("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_e[t]=new Ve(t,1,!1,t.toLowerCase(),null,!0,!0)});function pd(t,e,n,r){var i=_e.hasOwnProperty(e)?_e[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(d1(e,n,i,r)&&(n=null),r||i===null?u1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var on=l1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,po=Symbol.for("react.element"),Vr=Symbol.for("react.portal"),Hr=Symbol.for("react.fragment"),md=Symbol.for("react.strict_mode"),Lu=Symbol.for("react.profiler"),Qm=Symbol.for("react.provider"),Ym=Symbol.for("react.context"),gd=Symbol.for("react.forward_ref"),$u=Symbol.for("react.suspense"),zu=Symbol.for("react.suspense_list"),yd=Symbol.for("react.memo"),cn=Symbol.for("react.lazy"),Xm=Symbol.for("react.offscreen"),Vf=Symbol.iterator;function ji(t){return t===null||typeof t!="object"?null:(t=Vf&&t[Vf]||t["@@iterator"],typeof t=="function"?t:null)}var te=Object.assign,Ra;function qi(t){if(Ra===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ra=e&&e[1]||""}return`
`+Ra+t}var Da=!1;function ja(t,e){if(!t||Da)return"";Da=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=o&&0<=l);break}}}finally{Da=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?qi(t):""}function f1(t){switch(t.tag){case 5:return qi(t.type);case 16:return qi("Lazy");case 13:return qi("Suspense");case 19:return qi("SuspenseList");case 0:case 2:case 15:return t=ja(t.type,!1),t;case 11:return t=ja(t.type.render,!1),t;case 1:return t=ja(t.type,!0),t;default:return""}}function Bu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hr:return"Fragment";case Vr:return"Portal";case Lu:return"Profiler";case md:return"StrictMode";case $u:return"Suspense";case zu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ym:return(t.displayName||"Context")+".Consumer";case Qm:return(t._context.displayName||"Context")+".Provider";case gd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case yd:return e=t.displayName||null,e!==null?e:Bu(t.type)||"Memo";case cn:e=t._payload,t=t._init;try{return Bu(t(e))}catch{}}return null}function h1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bu(e);case 8:return e===md?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $n(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Zm(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function p1(t){var e=Zm(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mo(t){t._valueTracker||(t._valueTracker=p1(t))}function eg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Zm(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fu(t,e){var n=e.checked;return te({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Hf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=$n(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tg(t,e){e=e.checked,e!=null&&pd(t,"checked",e,!1)}function Uu(t,e){tg(t,e);var n=$n(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vu(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vu(t,e.type,$n(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Wf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vu(t,e,n){(e!=="number"||sl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ki=Array.isArray;function ri(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$n(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Hu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(O(91));return te({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function qf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(O(92));if(Ki(n)){if(1<n.length)throw Error(O(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:$n(n)}}function ng(t,e){var n=$n(e.value),r=$n(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Kf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var go,ig=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(go=go||document.createElement("div"),go.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=go.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ws(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},m1=["Webkit","ms","Moz","O"];Object.keys(es).forEach(function(t){m1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),es[e]=es[t]})});function sg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||es.hasOwnProperty(t)&&es[t]?(""+e).trim():e+"px"}function og(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=sg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var g1=te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qu(t,e){if(e){if(g1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(O(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(O(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(O(61))}if(e.style!=null&&typeof e.style!="object")throw Error(O(62))}}function Ku(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ju=null;function vd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gu=null,ii=null,si=null;function Jf(t){if(t=Ys(t)){if(typeof Gu!="function")throw Error(O(280));var e=t.stateNode;e&&(e=Gl(e),Gu(t.stateNode,t.type,e))}}function lg(t){ii?si?si.push(t):si=[t]:ii=t}function ag(){if(ii){var t=ii,e=si;if(si=ii=null,Jf(t),e)for(t=0;t<e.length;t++)Jf(e[t])}}function ug(t,e){return t(e)}function cg(){}var La=!1;function dg(t,e,n){if(La)return t(e,n);La=!0;try{return ug(t,e,n)}finally{La=!1,(ii!==null||si!==null)&&(cg(),ag())}}function ks(t,e){var n=t.stateNode;if(n===null)return null;var r=Gl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(O(231,e,typeof n));return n}var Qu=!1;if(en)try{var Li={};Object.defineProperty(Li,"passive",{get:function(){Qu=!0}}),window.addEventListener("test",Li,Li),window.removeEventListener("test",Li,Li)}catch{Qu=!1}function y1(t,e,n,r,i,s,o,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var ts=!1,ol=null,ll=!1,Yu=null,v1={onError:function(t){ts=!0,ol=t}};function w1(t,e,n,r,i,s,o,l,a){ts=!1,ol=null,y1.apply(v1,arguments)}function k1(t,e,n,r,i,s,o,l,a){if(w1.apply(this,arguments),ts){if(ts){var u=ol;ts=!1,ol=null}else throw Error(O(198));ll||(ll=!0,Yu=u)}}function Nr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function fg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Gf(t){if(Nr(t)!==t)throw Error(O(188))}function x1(t){var e=t.alternate;if(!e){if(e=Nr(t),e===null)throw Error(O(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Gf(i),t;if(s===r)return Gf(i),e;s=s.sibling}throw Error(O(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(O(189))}}if(n.alternate!==r)throw Error(O(190))}if(n.tag!==3)throw Error(O(188));return n.stateNode.current===n?t:e}function hg(t){return t=x1(t),t!==null?pg(t):null}function pg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pg(t);if(e!==null)return e;t=t.sibling}return null}var mg=lt.unstable_scheduleCallback,Qf=lt.unstable_cancelCallback,S1=lt.unstable_shouldYield,b1=lt.unstable_requestPaint,se=lt.unstable_now,C1=lt.unstable_getCurrentPriorityLevel,wd=lt.unstable_ImmediatePriority,gg=lt.unstable_UserBlockingPriority,al=lt.unstable_NormalPriority,E1=lt.unstable_LowPriority,yg=lt.unstable_IdlePriority,Wl=null,Lt=null;function _1(t){if(Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(Wl,t,void 0,(t.current.flags&128)===128)}catch{}}var Tt=Math.clz32?Math.clz32:N1,T1=Math.log,O1=Math.LN2;function N1(t){return t>>>=0,t===0?32:31-(T1(t)/O1|0)|0}var yo=64,vo=4194304;function Ji(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ul(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Ji(l):(s&=o,s!==0&&(r=Ji(s)))}else o=n&~i,o!==0?r=Ji(o):s!==0&&(r=Ji(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Tt(e),i=1<<n,r|=t[n],e&=~i;return r}function M1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P1(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Tt(s),l=1<<o,a=i[o];a===-1?(!(l&n)||l&r)&&(i[o]=M1(l,e)):a<=e&&(t.expiredLanes|=l),s&=~l}}function Xu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vg(){var t=yo;return yo<<=1,!(yo&4194240)&&(yo=64),t}function $a(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Gs(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Tt(e),t[e]=n}function A1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Tt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function kd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Tt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var W=0;function wg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kg,xd,xg,Sg,bg,Zu=!1,wo=[],En=null,_n=null,Tn=null,xs=new Map,Ss=new Map,mn=[],I1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yf(t,e){switch(t){case"focusin":case"focusout":En=null;break;case"dragenter":case"dragleave":_n=null;break;case"mouseover":case"mouseout":Tn=null;break;case"pointerover":case"pointerout":xs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ss.delete(e.pointerId)}}function $i(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ys(e),e!==null&&xd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function R1(t,e,n,r,i){switch(e){case"focusin":return En=$i(En,t,e,n,r,i),!0;case"dragenter":return _n=$i(_n,t,e,n,r,i),!0;case"mouseover":return Tn=$i(Tn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return xs.set(s,$i(xs.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ss.set(s,$i(Ss.get(s)||null,t,e,n,r,i)),!0}return!1}function Cg(t){var e=rr(t.target);if(e!==null){var n=Nr(e);if(n!==null){if(e=n.tag,e===13){if(e=fg(n),e!==null){t.blockedOn=e,bg(t.priority,function(){xg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ec(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ju=r,n.target.dispatchEvent(r),Ju=null}else return e=Ys(n),e!==null&&xd(e),t.blockedOn=n,!1;e.shift()}return!0}function Xf(t,e,n){Wo(t)&&n.delete(e)}function D1(){Zu=!1,En!==null&&Wo(En)&&(En=null),_n!==null&&Wo(_n)&&(_n=null),Tn!==null&&Wo(Tn)&&(Tn=null),xs.forEach(Xf),Ss.forEach(Xf)}function zi(t,e){t.blockedOn===e&&(t.blockedOn=null,Zu||(Zu=!0,lt.unstable_scheduleCallback(lt.unstable_NormalPriority,D1)))}function bs(t){function e(i){return zi(i,t)}if(0<wo.length){zi(wo[0],t);for(var n=1;n<wo.length;n++){var r=wo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(En!==null&&zi(En,t),_n!==null&&zi(_n,t),Tn!==null&&zi(Tn,t),xs.forEach(e),Ss.forEach(e),n=0;n<mn.length;n++)r=mn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<mn.length&&(n=mn[0],n.blockedOn===null);)Cg(n),n.blockedOn===null&&mn.shift()}var oi=on.ReactCurrentBatchConfig,cl=!0;function j1(t,e,n,r){var i=W,s=oi.transition;oi.transition=null;try{W=1,Sd(t,e,n,r)}finally{W=i,oi.transition=s}}function L1(t,e,n,r){var i=W,s=oi.transition;oi.transition=null;try{W=4,Sd(t,e,n,r)}finally{W=i,oi.transition=s}}function Sd(t,e,n,r){if(cl){var i=ec(t,e,n,r);if(i===null)Ja(t,e,r,dl,n),Yf(t,r);else if(R1(i,t,e,n,r))r.stopPropagation();else if(Yf(t,r),e&4&&-1<I1.indexOf(t)){for(;i!==null;){var s=Ys(i);if(s!==null&&kg(s),s=ec(t,e,n,r),s===null&&Ja(t,e,r,dl,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ja(t,e,r,null,n)}}var dl=null;function ec(t,e,n,r){if(dl=null,t=vd(r),t=rr(t),t!==null)if(e=Nr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=fg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dl=t,null}function Eg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(C1()){case wd:return 1;case gg:return 4;case al:case E1:return 16;case yg:return 536870912;default:return 16}default:return 16}}var wn=null,bd=null,qo=null;function _g(){if(qo)return qo;var t,e=bd,n=e.length,r,i="value"in wn?wn.value:wn.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return qo=i.slice(t,1<r?1-r:void 0)}function Ko(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ko(){return!0}function Zf(){return!1}function ut(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ko:Zf,this.isPropagationStopped=Zf,this}return te(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ko)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ko)},persist:function(){},isPersistent:ko}),e}var _i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cd=ut(_i),Qs=te({},_i,{view:0,detail:0}),$1=ut(Qs),za,Ba,Bi,ql=te({},Qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ed,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bi&&(Bi&&t.type==="mousemove"?(za=t.screenX-Bi.screenX,Ba=t.screenY-Bi.screenY):Ba=za=0,Bi=t),za)},movementY:function(t){return"movementY"in t?t.movementY:Ba}}),eh=ut(ql),z1=te({},ql,{dataTransfer:0}),B1=ut(z1),F1=te({},Qs,{relatedTarget:0}),Fa=ut(F1),U1=te({},_i,{animationName:0,elapsedTime:0,pseudoElement:0}),V1=ut(U1),H1=te({},_i,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),W1=ut(H1),q1=te({},_i,{data:0}),th=ut(q1),K1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},J1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Q1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=G1[t])?!!e[t]:!1}function Ed(){return Q1}var Y1=te({},Qs,{key:function(t){if(t.key){var e=K1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ko(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?J1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ed,charCode:function(t){return t.type==="keypress"?Ko(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ko(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),X1=ut(Y1),Z1=te({},ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nh=ut(Z1),ek=te({},Qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ed}),tk=ut(ek),nk=te({},_i,{propertyName:0,elapsedTime:0,pseudoElement:0}),rk=ut(nk),ik=te({},ql,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sk=ut(ik),ok=[9,13,27,32],_d=en&&"CompositionEvent"in window,ns=null;en&&"documentMode"in document&&(ns=document.documentMode);var lk=en&&"TextEvent"in window&&!ns,Tg=en&&(!_d||ns&&8<ns&&11>=ns),rh=" ",ih=!1;function Og(t,e){switch(t){case"keyup":return ok.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ng(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wr=!1;function ak(t,e){switch(t){case"compositionend":return Ng(e);case"keypress":return e.which!==32?null:(ih=!0,rh);case"textInput":return t=e.data,t===rh&&ih?null:t;default:return null}}function uk(t,e){if(Wr)return t==="compositionend"||!_d&&Og(t,e)?(t=_g(),qo=bd=wn=null,Wr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Tg&&e.locale!=="ko"?null:e.data;default:return null}}var ck={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ck[t.type]:e==="textarea"}function Mg(t,e,n,r){lg(r),e=fl(e,"onChange"),0<e.length&&(n=new Cd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var rs=null,Cs=null;function dk(t){Fg(t,0)}function Kl(t){var e=Jr(t);if(eg(e))return t}function fk(t,e){if(t==="change")return e}var Pg=!1;if(en){var Ua;if(en){var Va="oninput"in document;if(!Va){var oh=document.createElement("div");oh.setAttribute("oninput","return;"),Va=typeof oh.oninput=="function"}Ua=Va}else Ua=!1;Pg=Ua&&(!document.documentMode||9<document.documentMode)}function lh(){rs&&(rs.detachEvent("onpropertychange",Ag),Cs=rs=null)}function Ag(t){if(t.propertyName==="value"&&Kl(Cs)){var e=[];Mg(e,Cs,t,vd(t)),dg(dk,e)}}function hk(t,e,n){t==="focusin"?(lh(),rs=e,Cs=n,rs.attachEvent("onpropertychange",Ag)):t==="focusout"&&lh()}function pk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Kl(Cs)}function mk(t,e){if(t==="click")return Kl(e)}function gk(t,e){if(t==="input"||t==="change")return Kl(e)}function yk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nt=typeof Object.is=="function"?Object.is:yk;function Es(t,e){if(Nt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ju.call(e,i)||!Nt(t[i],e[i]))return!1}return!0}function ah(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function uh(t,e){var n=ah(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ah(n)}}function Ig(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ig(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Rg(){for(var t=window,e=sl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sl(t.document)}return e}function Td(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function vk(t){var e=Rg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ig(n.ownerDocument.documentElement,n)){if(r!==null&&Td(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=uh(n,s);var o=uh(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wk=en&&"documentMode"in document&&11>=document.documentMode,qr=null,tc=null,is=null,nc=!1;function ch(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nc||qr==null||qr!==sl(r)||(r=qr,"selectionStart"in r&&Td(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),is&&Es(is,r)||(is=r,r=fl(tc,"onSelect"),0<r.length&&(e=new Cd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=qr)))}function xo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Kr={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionend:xo("Transition","TransitionEnd")},Ha={},Dg={};en&&(Dg=document.createElement("div").style,"AnimationEvent"in window||(delete Kr.animationend.animation,delete Kr.animationiteration.animation,delete Kr.animationstart.animation),"TransitionEvent"in window||delete Kr.transitionend.transition);function Jl(t){if(Ha[t])return Ha[t];if(!Kr[t])return t;var e=Kr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Dg)return Ha[t]=e[n];return t}var jg=Jl("animationend"),Lg=Jl("animationiteration"),$g=Jl("animationstart"),zg=Jl("transitionend"),Bg=new Map,dh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fn(t,e){Bg.set(t,e),Or(e,[t])}for(var Wa=0;Wa<dh.length;Wa++){var qa=dh[Wa],kk=qa.toLowerCase(),xk=qa[0].toUpperCase()+qa.slice(1);Fn(kk,"on"+xk)}Fn(jg,"onAnimationEnd");Fn(Lg,"onAnimationIteration");Fn($g,"onAnimationStart");Fn("dblclick","onDoubleClick");Fn("focusin","onFocus");Fn("focusout","onBlur");Fn(zg,"onTransitionEnd");di("onMouseEnter",["mouseout","mouseover"]);di("onMouseLeave",["mouseout","mouseover"]);di("onPointerEnter",["pointerout","pointerover"]);di("onPointerLeave",["pointerout","pointerover"]);Or("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Or("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Or("onBeforeInput",["compositionend","keypress","textInput","paste"]);Or("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Or("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Or("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gi));function fh(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,k1(r,e,void 0,t),t.currentTarget=null}function Fg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;fh(i,l,u),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,u=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;fh(i,l,u),s=a}}}if(ll)throw t=Yu,ll=!1,Yu=null,t}function Q(t,e){var n=e[lc];n===void 0&&(n=e[lc]=new Set);var r=t+"__bubble";n.has(r)||(Ug(e,t,2,!1),n.add(r))}function Ka(t,e,n){var r=0;e&&(r|=4),Ug(n,t,r,e)}var So="_reactListening"+Math.random().toString(36).slice(2);function _s(t){if(!t[So]){t[So]=!0,Gm.forEach(function(n){n!=="selectionchange"&&(Sk.has(n)||Ka(n,!1,t),Ka(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[So]||(e[So]=!0,Ka("selectionchange",!1,e))}}function Ug(t,e,n,r){switch(Eg(e)){case 1:var i=j1;break;case 4:i=L1;break;default:i=Sd}n=i.bind(null,e,n,t),i=void 0,!Qu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ja(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=rr(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}dg(function(){var u=s,c=vd(n),d=[];e:{var f=Bg.get(t);if(f!==void 0){var h=Cd,p=t;switch(t){case"keypress":if(Ko(n)===0)break e;case"keydown":case"keyup":h=X1;break;case"focusin":p="focus",h=Fa;break;case"focusout":p="blur",h=Fa;break;case"beforeblur":case"afterblur":h=Fa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=eh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=B1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=tk;break;case jg:case Lg:case $g:h=V1;break;case zg:h=rk;break;case"scroll":h=$1;break;case"wheel":h=sk;break;case"copy":case"cut":case"paste":h=W1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=nh}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var v=u,w;v!==null;){w=v;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,g!==null&&(x=ks(v,g),x!=null&&m.push(Ts(v,x,w)))),y)break;v=v.return}0<m.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Ju&&(p=n.relatedTarget||n.fromElement)&&(rr(p)||p[tn]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=u,p=p?rr(p):null,p!==null&&(y=Nr(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(m=eh,x="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=nh,x="onPointerLeave",g="onPointerEnter",v="pointer"),y=h==null?f:Jr(h),w=p==null?f:Jr(p),f=new m(x,v+"leave",h,n,c),f.target=y,f.relatedTarget=w,x=null,rr(c)===u&&(m=new m(g,v+"enter",p,n,c),m.target=w,m.relatedTarget=y,x=m),y=x,h&&p)t:{for(m=h,g=p,v=0,w=m;w;w=Ir(w))v++;for(w=0,x=g;x;x=Ir(x))w++;for(;0<v-w;)m=Ir(m),v--;for(;0<w-v;)g=Ir(g),w--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=Ir(m),g=Ir(g)}m=null}else m=null;h!==null&&hh(d,f,h,m,!1),p!==null&&y!==null&&hh(d,y,p,m,!0)}}e:{if(f=u?Jr(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=fk;else if(sh(f))if(Pg)b=gk;else{b=pk;var S=hk}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=mk);if(b&&(b=b(t,u))){Mg(d,b,n,c);break e}S&&S(t,f,u),t==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&Vu(f,"number",f.value)}switch(S=u?Jr(u):window,t){case"focusin":(sh(S)||S.contentEditable==="true")&&(qr=S,tc=u,is=null);break;case"focusout":is=tc=qr=null;break;case"mousedown":nc=!0;break;case"contextmenu":case"mouseup":case"dragend":nc=!1,ch(d,n,c);break;case"selectionchange":if(wk)break;case"keydown":case"keyup":ch(d,n,c)}var E;if(_d)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Wr?Og(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(Tg&&n.locale!=="ko"&&(Wr||_!=="onCompositionStart"?_==="onCompositionEnd"&&Wr&&(E=_g()):(wn=c,bd="value"in wn?wn.value:wn.textContent,Wr=!0)),S=fl(u,_),0<S.length&&(_=new th(_,t,null,n,c),d.push({event:_,listeners:S}),E?_.data=E:(E=Ng(n),E!==null&&(_.data=E)))),(E=lk?ak(t,n):uk(t,n))&&(u=fl(u,"onBeforeInput"),0<u.length&&(c=new th("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=E))}Fg(d,e)})}function Ts(t,e,n){return{instance:t,listener:e,currentTarget:n}}function fl(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ks(t,n),s!=null&&r.unshift(Ts(t,s,i)),s=ks(t,e),s!=null&&r.push(Ts(t,s,i))),t=t.return}return r}function Ir(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function hh(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=ks(n,s),a!=null&&o.unshift(Ts(n,a,l))):i||(a=ks(n,s),a!=null&&o.push(Ts(n,a,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bk=/\r\n?/g,Ck=/\u0000|\uFFFD/g;function ph(t){return(typeof t=="string"?t:""+t).replace(bk,`
`).replace(Ck,"")}function bo(t,e,n){if(e=ph(e),ph(t)!==e&&n)throw Error(O(425))}function hl(){}var rc=null,ic=null;function sc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var oc=typeof setTimeout=="function"?setTimeout:void 0,Ek=typeof clearTimeout=="function"?clearTimeout:void 0,mh=typeof Promise=="function"?Promise:void 0,_k=typeof queueMicrotask=="function"?queueMicrotask:typeof mh<"u"?function(t){return mh.resolve(null).then(t).catch(Tk)}:oc;function Tk(t){setTimeout(function(){throw t})}function Ga(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),bs(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);bs(e)}function On(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function gh(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ti=Math.random().toString(36).slice(2),Dt="__reactFiber$"+Ti,Os="__reactProps$"+Ti,tn="__reactContainer$"+Ti,lc="__reactEvents$"+Ti,Ok="__reactListeners$"+Ti,Nk="__reactHandles$"+Ti;function rr(t){var e=t[Dt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[tn]||n[Dt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=gh(t);t!==null;){if(n=t[Dt])return n;t=gh(t)}return e}t=n,n=t.parentNode}return null}function Ys(t){return t=t[Dt]||t[tn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Jr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(O(33))}function Gl(t){return t[Os]||null}var ac=[],Gr=-1;function Un(t){return{current:t}}function Y(t){0>Gr||(t.current=ac[Gr],ac[Gr]=null,Gr--)}function G(t,e){Gr++,ac[Gr]=t.current,t.current=e}var zn={},Ie=Un(zn),Ge=Un(!1),yr=zn;function fi(t,e){var n=t.type.contextTypes;if(!n)return zn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Qe(t){return t=t.childContextTypes,t!=null}function pl(){Y(Ge),Y(Ie)}function yh(t,e,n){if(Ie.current!==zn)throw Error(O(168));G(Ie,e),G(Ge,n)}function Vg(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(O(108,h1(t)||"Unknown",i));return te({},n,r)}function ml(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||zn,yr=Ie.current,G(Ie,t),G(Ge,Ge.current),!0}function vh(t,e,n){var r=t.stateNode;if(!r)throw Error(O(169));n?(t=Vg(t,e,yr),r.__reactInternalMemoizedMergedChildContext=t,Y(Ge),Y(Ie),G(Ie,t)):Y(Ge),G(Ge,n)}var Kt=null,Ql=!1,Qa=!1;function Hg(t){Kt===null?Kt=[t]:Kt.push(t)}function Mk(t){Ql=!0,Hg(t)}function Vn(){if(!Qa&&Kt!==null){Qa=!0;var t=0,e=W;try{var n=Kt;for(W=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Kt=null,Ql=!1}catch(i){throw Kt!==null&&(Kt=Kt.slice(t+1)),mg(wd,Vn),i}finally{W=e,Qa=!1}}return null}var Qr=[],Yr=0,gl=null,yl=0,dt=[],ft=0,vr=null,Jt=1,Gt="";function Yn(t,e){Qr[Yr++]=yl,Qr[Yr++]=gl,gl=t,yl=e}function Wg(t,e,n){dt[ft++]=Jt,dt[ft++]=Gt,dt[ft++]=vr,vr=t;var r=Jt;t=Gt;var i=32-Tt(r)-1;r&=~(1<<i),n+=1;var s=32-Tt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Jt=1<<32-Tt(e)+i|n<<i|r,Gt=s+t}else Jt=1<<s|n<<i|r,Gt=t}function Od(t){t.return!==null&&(Yn(t,1),Wg(t,1,0))}function Nd(t){for(;t===gl;)gl=Qr[--Yr],Qr[Yr]=null,yl=Qr[--Yr],Qr[Yr]=null;for(;t===vr;)vr=dt[--ft],dt[ft]=null,Gt=dt[--ft],dt[ft]=null,Jt=dt[--ft],dt[ft]=null}var st=null,rt=null,X=!1,Et=null;function qg(t,e){var n=pt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function wh(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,st=t,rt=On(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,st=t,rt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vr!==null?{id:Jt,overflow:Gt}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,st=t,rt=null,!0):!1;default:return!1}}function uc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cc(t){if(X){var e=rt;if(e){var n=e;if(!wh(t,e)){if(uc(t))throw Error(O(418));e=On(n.nextSibling);var r=st;e&&wh(t,e)?qg(r,n):(t.flags=t.flags&-4097|2,X=!1,st=t)}}else{if(uc(t))throw Error(O(418));t.flags=t.flags&-4097|2,X=!1,st=t}}}function kh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;st=t}function Co(t){if(t!==st)return!1;if(!X)return kh(t),X=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sc(t.type,t.memoizedProps)),e&&(e=rt)){if(uc(t))throw Kg(),Error(O(418));for(;e;)qg(t,e),e=On(e.nextSibling)}if(kh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(O(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){rt=On(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}rt=null}}else rt=st?On(t.stateNode.nextSibling):null;return!0}function Kg(){for(var t=rt;t;)t=On(t.nextSibling)}function hi(){rt=st=null,X=!1}function Md(t){Et===null?Et=[t]:Et.push(t)}var Pk=on.ReactCurrentBatchConfig;function Fi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(O(309));var r=n.stateNode}if(!r)throw Error(O(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(O(284));if(!n._owner)throw Error(O(290,t))}return t}function Eo(t,e){throw t=Object.prototype.toString.call(e),Error(O(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function xh(t){var e=t._init;return e(t._payload)}function Jg(t){function e(g,v){if(t){var w=g.deletions;w===null?(g.deletions=[v],g.flags|=16):w.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function i(g,v){return g=An(g,v),g.index=0,g.sibling=null,g}function s(g,v,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<v?(g.flags|=2,v):w):(g.flags|=2,v)):(g.flags|=1048576,v)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,v,w,x){return v===null||v.tag!==6?(v=ru(w,g.mode,x),v.return=g,v):(v=i(v,w),v.return=g,v)}function a(g,v,w,x){var b=w.type;return b===Hr?c(g,v,w.props.children,x,w.key):v!==null&&(v.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===cn&&xh(b)===v.type)?(x=i(v,w.props),x.ref=Fi(g,v,w),x.return=g,x):(x=el(w.type,w.key,w.props,null,g.mode,x),x.ref=Fi(g,v,w),x.return=g,x)}function u(g,v,w,x){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=iu(w,g.mode,x),v.return=g,v):(v=i(v,w.children||[]),v.return=g,v)}function c(g,v,w,x,b){return v===null||v.tag!==7?(v=cr(w,g.mode,x,b),v.return=g,v):(v=i(v,w),v.return=g,v)}function d(g,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=ru(""+v,g.mode,w),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case po:return w=el(v.type,v.key,v.props,null,g.mode,w),w.ref=Fi(g,null,v),w.return=g,w;case Vr:return v=iu(v,g.mode,w),v.return=g,v;case cn:var x=v._init;return d(g,x(v._payload),w)}if(Ki(v)||ji(v))return v=cr(v,g.mode,w,null),v.return=g,v;Eo(g,v)}return null}function f(g,v,w,x){var b=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:l(g,v,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case po:return w.key===b?a(g,v,w,x):null;case Vr:return w.key===b?u(g,v,w,x):null;case cn:return b=w._init,f(g,v,b(w._payload),x)}if(Ki(w)||ji(w))return b!==null?null:c(g,v,w,x,null);Eo(g,w)}return null}function h(g,v,w,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return g=g.get(w)||null,l(v,g,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case po:return g=g.get(x.key===null?w:x.key)||null,a(v,g,x,b);case Vr:return g=g.get(x.key===null?w:x.key)||null,u(v,g,x,b);case cn:var S=x._init;return h(g,v,w,S(x._payload),b)}if(Ki(x)||ji(x))return g=g.get(w)||null,c(v,g,x,b,null);Eo(v,x)}return null}function p(g,v,w,x){for(var b=null,S=null,E=v,_=v=0,D=null;E!==null&&_<w.length;_++){E.index>_?(D=E,E=null):D=E.sibling;var R=f(g,E,w[_],x);if(R===null){E===null&&(E=D);break}t&&E&&R.alternate===null&&e(g,E),v=s(R,v,_),S===null?b=R:S.sibling=R,S=R,E=D}if(_===w.length)return n(g,E),X&&Yn(g,_),b;if(E===null){for(;_<w.length;_++)E=d(g,w[_],x),E!==null&&(v=s(E,v,_),S===null?b=E:S.sibling=E,S=E);return X&&Yn(g,_),b}for(E=r(g,E);_<w.length;_++)D=h(E,g,_,w[_],x),D!==null&&(t&&D.alternate!==null&&E.delete(D.key===null?_:D.key),v=s(D,v,_),S===null?b=D:S.sibling=D,S=D);return t&&E.forEach(function(et){return e(g,et)}),X&&Yn(g,_),b}function m(g,v,w,x){var b=ji(w);if(typeof b!="function")throw Error(O(150));if(w=b.call(w),w==null)throw Error(O(151));for(var S=b=null,E=v,_=v=0,D=null,R=w.next();E!==null&&!R.done;_++,R=w.next()){E.index>_?(D=E,E=null):D=E.sibling;var et=f(g,E,R.value,x);if(et===null){E===null&&(E=D);break}t&&E&&et.alternate===null&&e(g,E),v=s(et,v,_),S===null?b=et:S.sibling=et,S=et,E=D}if(R.done)return n(g,E),X&&Yn(g,_),b;if(E===null){for(;!R.done;_++,R=w.next())R=d(g,R.value,x),R!==null&&(v=s(R,v,_),S===null?b=R:S.sibling=R,S=R);return X&&Yn(g,_),b}for(E=r(g,E);!R.done;_++,R=w.next())R=h(E,g,_,R.value,x),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?_:R.key),v=s(R,v,_),S===null?b=R:S.sibling=R,S=R);return t&&E.forEach(function(Ii){return e(g,Ii)}),X&&Yn(g,_),b}function y(g,v,w,x){if(typeof w=="object"&&w!==null&&w.type===Hr&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case po:e:{for(var b=w.key,S=v;S!==null;){if(S.key===b){if(b=w.type,b===Hr){if(S.tag===7){n(g,S.sibling),v=i(S,w.props.children),v.return=g,g=v;break e}}else if(S.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===cn&&xh(b)===S.type){n(g,S.sibling),v=i(S,w.props),v.ref=Fi(g,S,w),v.return=g,g=v;break e}n(g,S);break}else e(g,S);S=S.sibling}w.type===Hr?(v=cr(w.props.children,g.mode,x,w.key),v.return=g,g=v):(x=el(w.type,w.key,w.props,null,g.mode,x),x.ref=Fi(g,v,w),x.return=g,g=x)}return o(g);case Vr:e:{for(S=w.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(g,v.sibling),v=i(v,w.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=iu(w,g.mode,x),v.return=g,g=v}return o(g);case cn:return S=w._init,y(g,v,S(w._payload),x)}if(Ki(w))return p(g,v,w,x);if(ji(w))return m(g,v,w,x);Eo(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(g,v.sibling),v=i(v,w),v.return=g,g=v):(n(g,v),v=ru(w,g.mode,x),v.return=g,g=v),o(g)):n(g,v)}return y}var pi=Jg(!0),Gg=Jg(!1),vl=Un(null),wl=null,Xr=null,Pd=null;function Ad(){Pd=Xr=wl=null}function Id(t){var e=vl.current;Y(vl),t._currentValue=e}function dc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function li(t,e){wl=t,Pd=Xr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Je=!0),t.firstContext=null)}function vt(t){var e=t._currentValue;if(Pd!==t)if(t={context:t,memoizedValue:e,next:null},Xr===null){if(wl===null)throw Error(O(308));Xr=t,wl.dependencies={lanes:0,firstContext:t}}else Xr=Xr.next=t;return e}var ir=null;function Rd(t){ir===null?ir=[t]:ir.push(t)}function Qg(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Rd(e)):(n.next=i.next,i.next=n),e.interleaved=n,nn(t,r)}function nn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var dn=!1;function Dd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yg(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yt(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Nn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,H&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,nn(t,n)}return i=r.interleaved,i===null?(e.next=e,Rd(r)):(e.next=i.next,i.next=e),r.interleaved=e,nn(t,n)}function Jo(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kd(t,n)}}function Sh(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function kl(t,e,n,r){var i=t.updateQueue;dn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,o===null?s=u:o.next=u,o=a;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==o&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(s!==null){var d=i.baseState;o=0,c=u=a=null,l=s;do{var f=l.lane,h=l.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=t,m=l;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=te({},d,f);break e;case 2:dn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else h={eventTime:h,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=h,a=d):c=c.next=h,o|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(a=d),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);kr|=o,t.lanes=o,t.memoizedState=d}}function bh(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(O(191,i));i.call(r)}}}var Xs={},$t=Un(Xs),Ns=Un(Xs),Ms=Un(Xs);function sr(t){if(t===Xs)throw Error(O(174));return t}function jd(t,e){switch(G(Ms,e),G(Ns,t),G($t,Xs),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wu(e,t)}Y($t),G($t,e)}function mi(){Y($t),Y(Ns),Y(Ms)}function Xg(t){sr(Ms.current);var e=sr($t.current),n=Wu(e,t.type);e!==n&&(G(Ns,t),G($t,n))}function Ld(t){Ns.current===t&&(Y($t),Y(Ns))}var Z=Un(0);function xl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ya=[];function $d(){for(var t=0;t<Ya.length;t++)Ya[t]._workInProgressVersionPrimary=null;Ya.length=0}var Go=on.ReactCurrentDispatcher,Xa=on.ReactCurrentBatchConfig,wr=0,ee=null,ce=null,pe=null,Sl=!1,ss=!1,Ps=0,Ak=0;function Te(){throw Error(O(321))}function zd(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Nt(t[n],e[n]))return!1;return!0}function Bd(t,e,n,r,i,s){if(wr=s,ee=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Go.current=t===null||t.memoizedState===null?jk:Lk,t=n(r,i),ss){s=0;do{if(ss=!1,Ps=0,25<=s)throw Error(O(301));s+=1,pe=ce=null,e.updateQueue=null,Go.current=$k,t=n(r,i)}while(ss)}if(Go.current=bl,e=ce!==null&&ce.next!==null,wr=0,pe=ce=ee=null,Sl=!1,e)throw Error(O(300));return t}function Fd(){var t=Ps!==0;return Ps=0,t}function It(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pe===null?ee.memoizedState=pe=t:pe=pe.next=t,pe}function wt(){if(ce===null){var t=ee.alternate;t=t!==null?t.memoizedState:null}else t=ce.next;var e=pe===null?ee.memoizedState:pe.next;if(e!==null)pe=e,ce=t;else{if(t===null)throw Error(O(310));ce=t,t={memoizedState:ce.memoizedState,baseState:ce.baseState,baseQueue:ce.baseQueue,queue:ce.queue,next:null},pe===null?ee.memoizedState=pe=t:pe=pe.next=t}return pe}function As(t,e){return typeof e=="function"?e(t):e}function Za(t){var e=wt(),n=e.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=t;var r=ce,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,u=s;do{var c=u.lane;if((wr&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=d,o=r):a=a.next=d,ee.lanes|=c,kr|=c}u=u.next}while(u!==null&&u!==s);a===null?o=r:a.next=l,Nt(r,e.memoizedState)||(Je=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ee.lanes|=s,kr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function eu(t){var e=wt(),n=e.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Nt(s,e.memoizedState)||(Je=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Zg(){}function ey(t,e){var n=ee,r=wt(),i=e(),s=!Nt(r.memoizedState,i);if(s&&(r.memoizedState=i,Je=!0),r=r.queue,Ud(ry.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||pe!==null&&pe.memoizedState.tag&1){if(n.flags|=2048,Is(9,ny.bind(null,n,r,i,e),void 0,null),ye===null)throw Error(O(349));wr&30||ty(n,e,i)}return i}function ty(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ee.updateQueue,e===null?(e={lastEffect:null,stores:null},ee.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ny(t,e,n,r){e.value=n,e.getSnapshot=r,iy(e)&&sy(t)}function ry(t,e,n){return n(function(){iy(e)&&sy(t)})}function iy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Nt(t,n)}catch{return!0}}function sy(t){var e=nn(t,1);e!==null&&Ot(e,t,1,-1)}function Ch(t){var e=It();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:As,lastRenderedState:t},e.queue=t,t=t.dispatch=Dk.bind(null,ee,t),[e.memoizedState,t]}function Is(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ee.updateQueue,e===null?(e={lastEffect:null,stores:null},ee.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function oy(){return wt().memoizedState}function Qo(t,e,n,r){var i=It();ee.flags|=t,i.memoizedState=Is(1|e,n,void 0,r===void 0?null:r)}function Yl(t,e,n,r){var i=wt();r=r===void 0?null:r;var s=void 0;if(ce!==null){var o=ce.memoizedState;if(s=o.destroy,r!==null&&zd(r,o.deps)){i.memoizedState=Is(e,n,s,r);return}}ee.flags|=t,i.memoizedState=Is(1|e,n,s,r)}function Eh(t,e){return Qo(8390656,8,t,e)}function Ud(t,e){return Yl(2048,8,t,e)}function ly(t,e){return Yl(4,2,t,e)}function ay(t,e){return Yl(4,4,t,e)}function uy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function cy(t,e,n){return n=n!=null?n.concat([t]):null,Yl(4,4,uy.bind(null,e,t),n)}function Vd(){}function dy(t,e){var n=wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zd(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function fy(t,e){var n=wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zd(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function hy(t,e,n){return wr&21?(Nt(n,e)||(n=vg(),ee.lanes|=n,kr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Je=!0),t.memoizedState=n)}function Ik(t,e){var n=W;W=n!==0&&4>n?n:4,t(!0);var r=Xa.transition;Xa.transition={};try{t(!1),e()}finally{W=n,Xa.transition=r}}function py(){return wt().memoizedState}function Rk(t,e,n){var r=Pn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},my(t))gy(e,n);else if(n=Qg(t,e,n,r),n!==null){var i=$e();Ot(n,t,r,i),yy(n,e,r)}}function Dk(t,e,n){var r=Pn(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(my(t))gy(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Nt(l,o)){var a=e.interleaved;a===null?(i.next=i,Rd(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=Qg(t,e,i,r),n!==null&&(i=$e(),Ot(n,t,r,i),yy(n,e,r))}}function my(t){var e=t.alternate;return t===ee||e!==null&&e===ee}function gy(t,e){ss=Sl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function yy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kd(t,n)}}var bl={readContext:vt,useCallback:Te,useContext:Te,useEffect:Te,useImperativeHandle:Te,useInsertionEffect:Te,useLayoutEffect:Te,useMemo:Te,useReducer:Te,useRef:Te,useState:Te,useDebugValue:Te,useDeferredValue:Te,useTransition:Te,useMutableSource:Te,useSyncExternalStore:Te,useId:Te,unstable_isNewReconciler:!1},jk={readContext:vt,useCallback:function(t,e){return It().memoizedState=[t,e===void 0?null:e],t},useContext:vt,useEffect:Eh,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Qo(4194308,4,uy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Qo(4194308,4,t,e)},useInsertionEffect:function(t,e){return Qo(4,2,t,e)},useMemo:function(t,e){var n=It();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=It();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Rk.bind(null,ee,t),[r.memoizedState,t]},useRef:function(t){var e=It();return t={current:t},e.memoizedState=t},useState:Ch,useDebugValue:Vd,useDeferredValue:function(t){return It().memoizedState=t},useTransition:function(){var t=Ch(!1),e=t[0];return t=Ik.bind(null,t[1]),It().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ee,i=It();if(X){if(n===void 0)throw Error(O(407));n=n()}else{if(n=e(),ye===null)throw Error(O(349));wr&30||ty(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Eh(ry.bind(null,r,s,t),[t]),r.flags|=2048,Is(9,ny.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=It(),e=ye.identifierPrefix;if(X){var n=Gt,r=Jt;n=(r&~(1<<32-Tt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ps++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Ak++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Lk={readContext:vt,useCallback:dy,useContext:vt,useEffect:Ud,useImperativeHandle:cy,useInsertionEffect:ly,useLayoutEffect:ay,useMemo:fy,useReducer:Za,useRef:oy,useState:function(){return Za(As)},useDebugValue:Vd,useDeferredValue:function(t){var e=wt();return hy(e,ce.memoizedState,t)},useTransition:function(){var t=Za(As)[0],e=wt().memoizedState;return[t,e]},useMutableSource:Zg,useSyncExternalStore:ey,useId:py,unstable_isNewReconciler:!1},$k={readContext:vt,useCallback:dy,useContext:vt,useEffect:Ud,useImperativeHandle:cy,useInsertionEffect:ly,useLayoutEffect:ay,useMemo:fy,useReducer:eu,useRef:oy,useState:function(){return eu(As)},useDebugValue:Vd,useDeferredValue:function(t){var e=wt();return ce===null?e.memoizedState=t:hy(e,ce.memoizedState,t)},useTransition:function(){var t=eu(As)[0],e=wt().memoizedState;return[t,e]},useMutableSource:Zg,useSyncExternalStore:ey,useId:py,unstable_isNewReconciler:!1};function St(t,e){if(t&&t.defaultProps){e=te({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function fc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:te({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Xl={isMounted:function(t){return(t=t._reactInternals)?Nr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=$e(),i=Pn(t),s=Yt(r,i);s.payload=e,n!=null&&(s.callback=n),e=Nn(t,s,i),e!==null&&(Ot(e,t,i,r),Jo(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=$e(),i=Pn(t),s=Yt(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Nn(t,s,i),e!==null&&(Ot(e,t,i,r),Jo(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$e(),r=Pn(t),i=Yt(n,r);i.tag=2,e!=null&&(i.callback=e),e=Nn(t,i,r),e!==null&&(Ot(e,t,r,n),Jo(e,t,r))}};function _h(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Es(n,r)||!Es(i,s):!0}function vy(t,e,n){var r=!1,i=zn,s=e.contextType;return typeof s=="object"&&s!==null?s=vt(s):(i=Qe(e)?yr:Ie.current,r=e.contextTypes,s=(r=r!=null)?fi(t,i):zn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Xl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Th(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Xl.enqueueReplaceState(e,e.state,null)}function hc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Dd(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=vt(s):(s=Qe(e)?yr:Ie.current,i.context=fi(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(fc(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Xl.enqueueReplaceState(i,i.state,null),kl(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function gi(t,e){try{var n="",r=e;do n+=f1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function tu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function pc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var zk=typeof WeakMap=="function"?WeakMap:Map;function wy(t,e,n){n=Yt(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){El||(El=!0,Cc=r),pc(t,e)},n}function ky(t,e,n){n=Yt(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){pc(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){pc(t,e),typeof r!="function"&&(Mn===null?Mn=new Set([this]):Mn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Oh(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new zk;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Zk.bind(null,t,e,n),e.then(t,t))}function Nh(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Mh(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yt(-1,1),e.tag=2,Nn(n,e,1))),n.lanes|=1),t)}var Bk=on.ReactCurrentOwner,Je=!1;function Le(t,e,n,r){e.child=t===null?Gg(e,null,n,r):pi(e,t.child,n,r)}function Ph(t,e,n,r,i){n=n.render;var s=e.ref;return li(e,i),r=Bd(t,e,n,r,s,i),n=Fd(),t!==null&&!Je?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rn(t,e,i)):(X&&n&&Od(e),e.flags|=1,Le(t,e,r,i),e.child)}function Ah(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Yd(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,xy(t,e,s,r,i)):(t=el(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Es,n(o,r)&&t.ref===e.ref)return rn(t,e,i)}return e.flags|=1,t=An(s,r),t.ref=e.ref,t.return=e,e.child=t}function xy(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Es(s,r)&&t.ref===e.ref)if(Je=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Je=!0);else return e.lanes=t.lanes,rn(t,e,i)}return mc(t,e,n,r,i)}function Sy(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ei,tt),tt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,G(ei,tt),tt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,G(ei,tt),tt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,G(ei,tt),tt|=r;return Le(t,e,i,n),e.child}function by(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mc(t,e,n,r,i){var s=Qe(n)?yr:Ie.current;return s=fi(e,s),li(e,i),n=Bd(t,e,n,r,s,i),r=Fd(),t!==null&&!Je?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rn(t,e,i)):(X&&r&&Od(e),e.flags|=1,Le(t,e,n,i),e.child)}function Ih(t,e,n,r,i){if(Qe(n)){var s=!0;ml(e)}else s=!1;if(li(e,i),e.stateNode===null)Yo(t,e),vy(e,n,r),hc(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=vt(u):(u=Qe(n)?yr:Ie.current,u=fi(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==u)&&Th(e,o,r,u),dn=!1;var f=e.memoizedState;o.state=f,kl(e,r,o,i),a=e.memoizedState,l!==r||f!==a||Ge.current||dn?(typeof c=="function"&&(fc(e,n,c,r),a=e.memoizedState),(l=dn||_h(e,n,l,r,f,a,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Yg(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:St(e.type,l),o.props=u,d=e.pendingProps,f=o.context,a=n.contextType,typeof a=="object"&&a!==null?a=vt(a):(a=Qe(n)?yr:Ie.current,a=fi(e,a));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==a)&&Th(e,o,r,a),dn=!1,f=e.memoizedState,o.state=f,kl(e,r,o,i);var p=e.memoizedState;l!==d||f!==p||Ge.current||dn?(typeof h=="function"&&(fc(e,n,h,r),p=e.memoizedState),(u=dn||_h(e,n,u,r,f,p,a)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=a,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return gc(t,e,n,r,s,i)}function gc(t,e,n,r,i,s){by(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&vh(e,n,!1),rn(t,e,s);r=e.stateNode,Bk.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=pi(e,t.child,null,s),e.child=pi(e,null,l,s)):Le(t,e,l,s),e.memoizedState=r.state,i&&vh(e,n,!0),e.child}function Cy(t){var e=t.stateNode;e.pendingContext?yh(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yh(t,e.context,!1),jd(t,e.containerInfo)}function Rh(t,e,n,r,i){return hi(),Md(i),e.flags|=256,Le(t,e,n,r),e.child}var yc={dehydrated:null,treeContext:null,retryLane:0};function vc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ey(t,e,n){var r=e.pendingProps,i=Z.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),G(Z,i&1),t===null)return cc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ta(o,r,0,null),t=cr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=vc(n),e.memoizedState=yc,t):Hd(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Fk(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=An(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=An(l,s):(s=cr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?vc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=yc,r}return s=t.child,t=s.sibling,r=An(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hd(t,e){return e=ta({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _o(t,e,n,r){return r!==null&&Md(r),pi(e,t.child,null,n),t=Hd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Fk(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=tu(Error(O(422))),_o(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ta({mode:"visible",children:r.children},i,0,null),s=cr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&pi(e,t.child,null,o),e.child.memoizedState=vc(o),e.memoizedState=yc,s);if(!(e.mode&1))return _o(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(O(419)),r=tu(s,r,void 0),_o(t,e,o,r)}if(l=(o&t.childLanes)!==0,Je||l){if(r=ye,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,nn(t,i),Ot(r,t,i,-1))}return Qd(),r=tu(Error(O(421))),_o(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=ex.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,rt=On(i.nextSibling),st=e,X=!0,Et=null,t!==null&&(dt[ft++]=Jt,dt[ft++]=Gt,dt[ft++]=vr,Jt=t.id,Gt=t.overflow,vr=e),e=Hd(e,r.children),e.flags|=4096,e)}function Dh(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),dc(t.return,e,n)}function nu(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function _y(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Le(t,e,r.children,n),r=Z.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Dh(t,n,e);else if(t.tag===19)Dh(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(G(Z,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&xl(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),nu(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&xl(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}nu(e,!0,n,null,s);break;case"together":nu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Yo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function rn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),kr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(O(153));if(e.child!==null){for(t=e.child,n=An(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=An(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Uk(t,e,n){switch(e.tag){case 3:Cy(e),hi();break;case 5:Xg(e);break;case 1:Qe(e.type)&&ml(e);break;case 4:jd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;G(vl,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(G(Z,Z.current&1),e.flags|=128,null):n&e.child.childLanes?Ey(t,e,n):(G(Z,Z.current&1),t=rn(t,e,n),t!==null?t.sibling:null);G(Z,Z.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return _y(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),G(Z,Z.current),r)break;return null;case 22:case 23:return e.lanes=0,Sy(t,e,n)}return rn(t,e,n)}var Ty,wc,Oy,Ny;Ty=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wc=function(){};Oy=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,sr($t.current);var s=null;switch(n){case"input":i=Fu(t,i),r=Fu(t,r),s=[];break;case"select":i=te({},i,{value:void 0}),r=te({},r,{value:void 0}),s=[];break;case"textarea":i=Hu(t,i),r=Hu(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hl)}qu(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(vs.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(n||(n={}),n[o]=a[o])}else n||(s||(s=[]),s.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(vs.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&Q("scroll",t),s||l===a||(s=[])):(s=s||[]).push(u,a))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Ny=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ui(t,e){if(!X)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Oe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Vk(t,e,n){var r=e.pendingProps;switch(Nd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oe(e),null;case 1:return Qe(e.type)&&pl(),Oe(e),null;case 3:return r=e.stateNode,mi(),Y(Ge),Y(Ie),$d(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Co(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Et!==null&&(Tc(Et),Et=null))),wc(t,e),Oe(e),null;case 5:Ld(e);var i=sr(Ms.current);if(n=e.type,t!==null&&e.stateNode!=null)Oy(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(O(166));return Oe(e),null}if(t=sr($t.current),Co(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Dt]=e,r[Os]=s,t=(e.mode&1)!==0,n){case"dialog":Q("cancel",r),Q("close",r);break;case"iframe":case"object":case"embed":Q("load",r);break;case"video":case"audio":for(i=0;i<Gi.length;i++)Q(Gi[i],r);break;case"source":Q("error",r);break;case"img":case"image":case"link":Q("error",r),Q("load",r);break;case"details":Q("toggle",r);break;case"input":Hf(r,s),Q("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Q("invalid",r);break;case"textarea":qf(r,s),Q("invalid",r)}qu(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&bo(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&bo(r.textContent,l,t),i=["children",""+l]):vs.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Q("scroll",r)}switch(n){case"input":mo(r),Wf(r,s,!0);break;case"textarea":mo(r),Kf(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=hl)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Dt]=e,t[Os]=r,Ty(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ku(n,r),n){case"dialog":Q("cancel",t),Q("close",t),i=r;break;case"iframe":case"object":case"embed":Q("load",t),i=r;break;case"video":case"audio":for(i=0;i<Gi.length;i++)Q(Gi[i],t);i=r;break;case"source":Q("error",t),i=r;break;case"img":case"image":case"link":Q("error",t),Q("load",t),i=r;break;case"details":Q("toggle",t),i=r;break;case"input":Hf(t,r),i=Fu(t,r),Q("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=te({},r,{value:void 0}),Q("invalid",t);break;case"textarea":qf(t,r),i=Hu(t,r),Q("invalid",t);break;default:i=r}qu(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?og(t,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&ig(t,a)):s==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&ws(t,a):typeof a=="number"&&ws(t,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(vs.hasOwnProperty(s)?a!=null&&s==="onScroll"&&Q("scroll",t):a!=null&&pd(t,s,a,o))}switch(n){case"input":mo(t),Wf(t,r,!1);break;case"textarea":mo(t),Kf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$n(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ri(t,!!r.multiple,s,!1):r.defaultValue!=null&&ri(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=hl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Oe(e),null;case 6:if(t&&e.stateNode!=null)Ny(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(O(166));if(n=sr(Ms.current),sr($t.current),Co(e)){if(r=e.stateNode,n=e.memoizedProps,r[Dt]=e,(s=r.nodeValue!==n)&&(t=st,t!==null))switch(t.tag){case 3:bo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&bo(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Dt]=e,e.stateNode=r}return Oe(e),null;case 13:if(Y(Z),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(X&&rt!==null&&e.mode&1&&!(e.flags&128))Kg(),hi(),e.flags|=98560,s=!1;else if(s=Co(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(O(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(O(317));s[Dt]=e}else hi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Oe(e),s=!1}else Et!==null&&(Tc(Et),Et=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Z.current&1?de===0&&(de=3):Qd())),e.updateQueue!==null&&(e.flags|=4),Oe(e),null);case 4:return mi(),wc(t,e),t===null&&_s(e.stateNode.containerInfo),Oe(e),null;case 10:return Id(e.type._context),Oe(e),null;case 17:return Qe(e.type)&&pl(),Oe(e),null;case 19:if(Y(Z),s=e.memoizedState,s===null)return Oe(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ui(s,!1);else{if(de!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=xl(t),o!==null){for(e.flags|=128,Ui(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return G(Z,Z.current&1|2),e.child}t=t.sibling}s.tail!==null&&se()>yi&&(e.flags|=128,r=!0,Ui(s,!1),e.lanes=4194304)}else{if(!r)if(t=xl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ui(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!X)return Oe(e),null}else 2*se()-s.renderingStartTime>yi&&n!==1073741824&&(e.flags|=128,r=!0,Ui(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=se(),e.sibling=null,n=Z.current,G(Z,r?n&1|2:n&1),e):(Oe(e),null);case 22:case 23:return Gd(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?tt&1073741824&&(Oe(e),e.subtreeFlags&6&&(e.flags|=8192)):Oe(e),null;case 24:return null;case 25:return null}throw Error(O(156,e.tag))}function Hk(t,e){switch(Nd(e),e.tag){case 1:return Qe(e.type)&&pl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mi(),Y(Ge),Y(Ie),$d(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ld(e),null;case 13:if(Y(Z),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(O(340));hi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Y(Z),null;case 4:return mi(),null;case 10:return Id(e.type._context),null;case 22:case 23:return Gd(),null;case 24:return null;default:return null}}var To=!1,Pe=!1,Wk=typeof WeakSet=="function"?WeakSet:Set,M=null;function Zr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ne(t,e,r)}else n.current=null}function kc(t,e,n){try{n()}catch(r){ne(t,e,r)}}var jh=!1;function qk(t,e){if(rc=cl,t=Rg(),Td(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,a=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||i!==0&&d.nodeType!==3||(l=o+i),d!==s||r!==0&&d.nodeType!==3||(a=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++u===i&&(l=o),f===s&&++c===r&&(a=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(ic={focusedElem:t,selectionRange:n},cl=!1,M=e;M!==null;)if(e=M,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,M=t;else for(;M!==null;){e=M;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,y=p.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:St(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(O(163))}}catch(x){ne(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,M=t;break}M=e.return}return p=jh,jh=!1,p}function ls(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&kc(e,n,s)}i=i.next}while(i!==r)}}function Zl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function xc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function My(t){var e=t.alternate;e!==null&&(t.alternate=null,My(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Dt],delete e[Os],delete e[lc],delete e[Ok],delete e[Nk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Py(t){return t.tag===5||t.tag===3||t.tag===4}function Lh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Py(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hl));else if(r!==4&&(t=t.child,t!==null))for(Sc(t,e,n),t=t.sibling;t!==null;)Sc(t,e,n),t=t.sibling}function bc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(bc(t,e,n),t=t.sibling;t!==null;)bc(t,e,n),t=t.sibling}var xe=null,bt=!1;function ln(t,e,n){for(n=n.child;n!==null;)Ay(t,e,n),n=n.sibling}function Ay(t,e,n){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(Wl,n)}catch{}switch(n.tag){case 5:Pe||Zr(n,e);case 6:var r=xe,i=bt;xe=null,ln(t,e,n),xe=r,bt=i,xe!==null&&(bt?(t=xe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):xe.removeChild(n.stateNode));break;case 18:xe!==null&&(bt?(t=xe,n=n.stateNode,t.nodeType===8?Ga(t.parentNode,n):t.nodeType===1&&Ga(t,n),bs(t)):Ga(xe,n.stateNode));break;case 4:r=xe,i=bt,xe=n.stateNode.containerInfo,bt=!0,ln(t,e,n),xe=r,bt=i;break;case 0:case 11:case 14:case 15:if(!Pe&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&kc(n,e,o),i=i.next}while(i!==r)}ln(t,e,n);break;case 1:if(!Pe&&(Zr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ne(n,e,l)}ln(t,e,n);break;case 21:ln(t,e,n);break;case 22:n.mode&1?(Pe=(r=Pe)||n.memoizedState!==null,ln(t,e,n),Pe=r):ln(t,e,n);break;default:ln(t,e,n)}}function $h(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Wk),e.forEach(function(r){var i=tx.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function kt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:xe=l.stateNode,bt=!1;break e;case 3:xe=l.stateNode.containerInfo,bt=!0;break e;case 4:xe=l.stateNode.containerInfo,bt=!0;break e}l=l.return}if(xe===null)throw Error(O(160));Ay(s,o,i),xe=null,bt=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){ne(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Iy(e,t),e=e.sibling}function Iy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(kt(e,t),At(t),r&4){try{ls(3,t,t.return),Zl(3,t)}catch(m){ne(t,t.return,m)}try{ls(5,t,t.return)}catch(m){ne(t,t.return,m)}}break;case 1:kt(e,t),At(t),r&512&&n!==null&&Zr(n,n.return);break;case 5:if(kt(e,t),At(t),r&512&&n!==null&&Zr(n,n.return),t.flags&32){var i=t.stateNode;try{ws(i,"")}catch(m){ne(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&tg(i,s),Ku(l,o);var u=Ku(l,s);for(o=0;o<a.length;o+=2){var c=a[o],d=a[o+1];c==="style"?og(i,d):c==="dangerouslySetInnerHTML"?ig(i,d):c==="children"?ws(i,d):pd(i,c,d,u)}switch(l){case"input":Uu(i,s);break;case"textarea":ng(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?ri(i,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?ri(i,!!s.multiple,s.defaultValue,!0):ri(i,!!s.multiple,s.multiple?[]:"",!1))}i[Os]=s}catch(m){ne(t,t.return,m)}}break;case 6:if(kt(e,t),At(t),r&4){if(t.stateNode===null)throw Error(O(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){ne(t,t.return,m)}}break;case 3:if(kt(e,t),At(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{bs(e.containerInfo)}catch(m){ne(t,t.return,m)}break;case 4:kt(e,t),At(t);break;case 13:kt(e,t),At(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Kd=se())),r&4&&$h(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Pe=(u=Pe)||c,kt(e,t),Pe=u):kt(e,t),At(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(M=t,c=t.child;c!==null;){for(d=M=c;M!==null;){switch(f=M,h=f.child,f.tag){case 0:case 11:case 14:case 15:ls(4,f,f.return);break;case 1:Zr(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){ne(r,n,m)}}break;case 5:Zr(f,f.return);break;case 22:if(f.memoizedState!==null){Bh(d);continue}}h!==null?(h.return=f,M=h):Bh(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=d.stateNode,a=d.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=sg("display",o))}catch(m){ne(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){ne(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:kt(e,t),At(t),r&4&&$h(t);break;case 21:break;default:kt(e,t),At(t)}}function At(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Py(n)){var r=n;break e}n=n.return}throw Error(O(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ws(i,""),r.flags&=-33);var s=Lh(t);bc(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Lh(t);Sc(t,l,o);break;default:throw Error(O(161))}}catch(a){ne(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Kk(t,e,n){M=t,Ry(t)}function Ry(t,e,n){for(var r=(t.mode&1)!==0;M!==null;){var i=M,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||To;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||Pe;l=To;var u=Pe;if(To=o,(Pe=a)&&!u)for(M=i;M!==null;)o=M,a=o.child,o.tag===22&&o.memoizedState!==null?Fh(i):a!==null?(a.return=o,M=a):Fh(i);for(;s!==null;)M=s,Ry(s),s=s.sibling;M=i,To=l,Pe=u}zh(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,M=s):zh(t)}}function zh(t){for(;M!==null;){var e=M;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Pe||Zl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Pe)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:St(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&bh(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}bh(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&bs(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(O(163))}Pe||e.flags&512&&xc(e)}catch(f){ne(e,e.return,f)}}if(e===t){M=null;break}if(n=e.sibling,n!==null){n.return=e.return,M=n;break}M=e.return}}function Bh(t){for(;M!==null;){var e=M;if(e===t){M=null;break}var n=e.sibling;if(n!==null){n.return=e.return,M=n;break}M=e.return}}function Fh(t){for(;M!==null;){var e=M;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Zl(4,e)}catch(a){ne(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){ne(e,i,a)}}var s=e.return;try{xc(e)}catch(a){ne(e,s,a)}break;case 5:var o=e.return;try{xc(e)}catch(a){ne(e,o,a)}}}catch(a){ne(e,e.return,a)}if(e===t){M=null;break}var l=e.sibling;if(l!==null){l.return=e.return,M=l;break}M=e.return}}var Jk=Math.ceil,Cl=on.ReactCurrentDispatcher,Wd=on.ReactCurrentOwner,mt=on.ReactCurrentBatchConfig,H=0,ye=null,le=null,Ee=0,tt=0,ei=Un(0),de=0,Rs=null,kr=0,ea=0,qd=0,as=null,qe=null,Kd=0,yi=1/0,Ht=null,El=!1,Cc=null,Mn=null,Oo=!1,kn=null,_l=0,us=0,Ec=null,Xo=-1,Zo=0;function $e(){return H&6?se():Xo!==-1?Xo:Xo=se()}function Pn(t){return t.mode&1?H&2&&Ee!==0?Ee&-Ee:Pk.transition!==null?(Zo===0&&(Zo=vg()),Zo):(t=W,t!==0||(t=window.event,t=t===void 0?16:Eg(t.type)),t):1}function Ot(t,e,n,r){if(50<us)throw us=0,Ec=null,Error(O(185));Gs(t,n,r),(!(H&2)||t!==ye)&&(t===ye&&(!(H&2)&&(ea|=n),de===4&&gn(t,Ee)),Ye(t,r),n===1&&H===0&&!(e.mode&1)&&(yi=se()+500,Ql&&Vn()))}function Ye(t,e){var n=t.callbackNode;P1(t,e);var r=ul(t,t===ye?Ee:0);if(r===0)n!==null&&Qf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Qf(n),e===1)t.tag===0?Mk(Uh.bind(null,t)):Hg(Uh.bind(null,t)),_k(function(){!(H&6)&&Vn()}),n=null;else{switch(wg(r)){case 1:n=wd;break;case 4:n=gg;break;case 16:n=al;break;case 536870912:n=yg;break;default:n=al}n=Uy(n,Dy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Dy(t,e){if(Xo=-1,Zo=0,H&6)throw Error(O(327));var n=t.callbackNode;if(ai()&&t.callbackNode!==n)return null;var r=ul(t,t===ye?Ee:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Tl(t,r);else{e=r;var i=H;H|=2;var s=Ly();(ye!==t||Ee!==e)&&(Ht=null,yi=se()+500,ur(t,e));do try{Yk();break}catch(l){jy(t,l)}while(!0);Ad(),Cl.current=s,H=i,le!==null?e=0:(ye=null,Ee=0,e=de)}if(e!==0){if(e===2&&(i=Xu(t),i!==0&&(r=i,e=_c(t,i))),e===1)throw n=Rs,ur(t,0),gn(t,r),Ye(t,se()),n;if(e===6)gn(t,r);else{if(i=t.current.alternate,!(r&30)&&!Gk(i)&&(e=Tl(t,r),e===2&&(s=Xu(t),s!==0&&(r=s,e=_c(t,s))),e===1))throw n=Rs,ur(t,0),gn(t,r),Ye(t,se()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(O(345));case 2:Xn(t,qe,Ht);break;case 3:if(gn(t,r),(r&130023424)===r&&(e=Kd+500-se(),10<e)){if(ul(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){$e(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=oc(Xn.bind(null,t,qe,Ht),e);break}Xn(t,qe,Ht);break;case 4:if(gn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Tt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=se()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Jk(r/1960))-r,10<r){t.timeoutHandle=oc(Xn.bind(null,t,qe,Ht),r);break}Xn(t,qe,Ht);break;case 5:Xn(t,qe,Ht);break;default:throw Error(O(329))}}}return Ye(t,se()),t.callbackNode===n?Dy.bind(null,t):null}function _c(t,e){var n=as;return t.current.memoizedState.isDehydrated&&(ur(t,e).flags|=256),t=Tl(t,e),t!==2&&(e=qe,qe=n,e!==null&&Tc(e)),t}function Tc(t){qe===null?qe=t:qe.push.apply(qe,t)}function Gk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Nt(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gn(t,e){for(e&=~qd,e&=~ea,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Tt(e),r=1<<n;t[n]=-1,e&=~r}}function Uh(t){if(H&6)throw Error(O(327));ai();var e=ul(t,0);if(!(e&1))return Ye(t,se()),null;var n=Tl(t,e);if(t.tag!==0&&n===2){var r=Xu(t);r!==0&&(e=r,n=_c(t,r))}if(n===1)throw n=Rs,ur(t,0),gn(t,e),Ye(t,se()),n;if(n===6)throw Error(O(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xn(t,qe,Ht),Ye(t,se()),null}function Jd(t,e){var n=H;H|=1;try{return t(e)}finally{H=n,H===0&&(yi=se()+500,Ql&&Vn())}}function xr(t){kn!==null&&kn.tag===0&&!(H&6)&&ai();var e=H;H|=1;var n=mt.transition,r=W;try{if(mt.transition=null,W=1,t)return t()}finally{W=r,mt.transition=n,H=e,!(H&6)&&Vn()}}function Gd(){tt=ei.current,Y(ei)}function ur(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ek(n)),le!==null)for(n=le.return;n!==null;){var r=n;switch(Nd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pl();break;case 3:mi(),Y(Ge),Y(Ie),$d();break;case 5:Ld(r);break;case 4:mi();break;case 13:Y(Z);break;case 19:Y(Z);break;case 10:Id(r.type._context);break;case 22:case 23:Gd()}n=n.return}if(ye=t,le=t=An(t.current,null),Ee=tt=e,de=0,Rs=null,qd=ea=kr=0,qe=as=null,ir!==null){for(e=0;e<ir.length;e++)if(n=ir[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ir=null}return t}function jy(t,e){do{var n=le;try{if(Ad(),Go.current=bl,Sl){for(var r=ee.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Sl=!1}if(wr=0,pe=ce=ee=null,ss=!1,Ps=0,Wd.current=null,n===null||n.return===null){de=1,Rs=e,le=null;break}e:{var s=t,o=n.return,l=n,a=e;if(e=Ee,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=Nh(o);if(h!==null){h.flags&=-257,Mh(h,o,l,s,e),h.mode&1&&Oh(s,u,e),e=h,a=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(a),e.updateQueue=m}else p.add(a);break e}else{if(!(e&1)){Oh(s,u,e),Qd();break e}a=Error(O(426))}}else if(X&&l.mode&1){var y=Nh(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Mh(y,o,l,s,e),Md(gi(a,l));break e}}s=a=gi(a,l),de!==4&&(de=2),as===null?as=[s]:as.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=wy(s,a,e);Sh(s,g);break e;case 1:l=a;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Mn===null||!Mn.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var x=ky(s,l,e);Sh(s,x);break e}}s=s.return}while(s!==null)}zy(n)}catch(b){e=b,le===n&&n!==null&&(le=n=n.return);continue}break}while(!0)}function Ly(){var t=Cl.current;return Cl.current=bl,t===null?bl:t}function Qd(){(de===0||de===3||de===2)&&(de=4),ye===null||!(kr&268435455)&&!(ea&268435455)||gn(ye,Ee)}function Tl(t,e){var n=H;H|=2;var r=Ly();(ye!==t||Ee!==e)&&(Ht=null,ur(t,e));do try{Qk();break}catch(i){jy(t,i)}while(!0);if(Ad(),H=n,Cl.current=r,le!==null)throw Error(O(261));return ye=null,Ee=0,de}function Qk(){for(;le!==null;)$y(le)}function Yk(){for(;le!==null&&!S1();)$y(le)}function $y(t){var e=Fy(t.alternate,t,tt);t.memoizedProps=t.pendingProps,e===null?zy(t):le=e,Wd.current=null}function zy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Hk(n,e),n!==null){n.flags&=32767,le=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{de=6,le=null;return}}else if(n=Vk(n,e,tt),n!==null){le=n;return}if(e=e.sibling,e!==null){le=e;return}le=e=t}while(e!==null);de===0&&(de=5)}function Xn(t,e,n){var r=W,i=mt.transition;try{mt.transition=null,W=1,Xk(t,e,n,r)}finally{mt.transition=i,W=r}return null}function Xk(t,e,n,r){do ai();while(kn!==null);if(H&6)throw Error(O(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(O(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(A1(t,s),t===ye&&(le=ye=null,Ee=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Oo||(Oo=!0,Uy(al,function(){return ai(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=mt.transition,mt.transition=null;var o=W;W=1;var l=H;H|=4,Wd.current=null,qk(t,n),Iy(n,t),vk(ic),cl=!!rc,ic=rc=null,t.current=n,Kk(n),b1(),H=l,W=o,mt.transition=s}else t.current=n;if(Oo&&(Oo=!1,kn=t,_l=i),s=t.pendingLanes,s===0&&(Mn=null),_1(n.stateNode),Ye(t,se()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(El)throw El=!1,t=Cc,Cc=null,t;return _l&1&&t.tag!==0&&ai(),s=t.pendingLanes,s&1?t===Ec?us++:(us=0,Ec=t):us=0,Vn(),null}function ai(){if(kn!==null){var t=wg(_l),e=mt.transition,n=W;try{if(mt.transition=null,W=16>t?16:t,kn===null)var r=!1;else{if(t=kn,kn=null,_l=0,H&6)throw Error(O(331));var i=H;for(H|=4,M=t.current;M!==null;){var s=M,o=s.child;if(M.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(M=u;M!==null;){var c=M;switch(c.tag){case 0:case 11:case 15:ls(8,c,s)}var d=c.child;if(d!==null)d.return=c,M=d;else for(;M!==null;){c=M;var f=c.sibling,h=c.return;if(My(c),c===u){M=null;break}if(f!==null){f.return=h,M=f;break}M=h}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}M=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,M=o;else e:for(;M!==null;){if(s=M,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ls(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,M=g;break e}M=s.return}}var v=t.current;for(M=v;M!==null;){o=M;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,M=w;else e:for(o=v;M!==null;){if(l=M,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Zl(9,l)}}catch(b){ne(l,l.return,b)}if(l===o){M=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,M=x;break e}M=l.return}}if(H=i,Vn(),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(Wl,t)}catch{}r=!0}return r}finally{W=n,mt.transition=e}}return!1}function Vh(t,e,n){e=gi(n,e),e=wy(t,e,1),t=Nn(t,e,1),e=$e(),t!==null&&(Gs(t,1,e),Ye(t,e))}function ne(t,e,n){if(t.tag===3)Vh(t,t,n);else for(;e!==null;){if(e.tag===3){Vh(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mn===null||!Mn.has(r))){t=gi(n,t),t=ky(e,t,1),e=Nn(e,t,1),t=$e(),e!==null&&(Gs(e,1,t),Ye(e,t));break}}e=e.return}}function Zk(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=$e(),t.pingedLanes|=t.suspendedLanes&n,ye===t&&(Ee&n)===n&&(de===4||de===3&&(Ee&130023424)===Ee&&500>se()-Kd?ur(t,0):qd|=n),Ye(t,e)}function By(t,e){e===0&&(t.mode&1?(e=vo,vo<<=1,!(vo&130023424)&&(vo=4194304)):e=1);var n=$e();t=nn(t,e),t!==null&&(Gs(t,e,n),Ye(t,n))}function ex(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),By(t,n)}function tx(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(O(314))}r!==null&&r.delete(e),By(t,n)}var Fy;Fy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ge.current)Je=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Je=!1,Uk(t,e,n);Je=!!(t.flags&131072)}else Je=!1,X&&e.flags&1048576&&Wg(e,yl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Yo(t,e),t=e.pendingProps;var i=fi(e,Ie.current);li(e,n),i=Bd(null,e,r,t,i,n);var s=Fd();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qe(r)?(s=!0,ml(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Dd(e),i.updater=Xl,e.stateNode=i,i._reactInternals=e,hc(e,r,t,n),e=gc(null,e,r,!0,s,n)):(e.tag=0,X&&s&&Od(e),Le(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Yo(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=rx(r),t=St(r,t),i){case 0:e=mc(null,e,r,t,n);break e;case 1:e=Ih(null,e,r,t,n);break e;case 11:e=Ph(null,e,r,t,n);break e;case 14:e=Ah(null,e,r,St(r.type,t),n);break e}throw Error(O(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:St(r,i),mc(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:St(r,i),Ih(t,e,r,i,n);case 3:e:{if(Cy(e),t===null)throw Error(O(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Yg(t,e),kl(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=gi(Error(O(423)),e),e=Rh(t,e,r,n,i);break e}else if(r!==i){i=gi(Error(O(424)),e),e=Rh(t,e,r,n,i);break e}else for(rt=On(e.stateNode.containerInfo.firstChild),st=e,X=!0,Et=null,n=Gg(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hi(),r===i){e=rn(t,e,n);break e}Le(t,e,r,n)}e=e.child}return e;case 5:return Xg(e),t===null&&cc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,sc(r,i)?o=null:s!==null&&sc(r,s)&&(e.flags|=32),by(t,e),Le(t,e,o,n),e.child;case 6:return t===null&&cc(e),null;case 13:return Ey(t,e,n);case 4:return jd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pi(e,null,r,n):Le(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:St(r,i),Ph(t,e,r,i,n);case 7:return Le(t,e,e.pendingProps,n),e.child;case 8:return Le(t,e,e.pendingProps.children,n),e.child;case 12:return Le(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,G(vl,r._currentValue),r._currentValue=o,s!==null)if(Nt(s.value,o)){if(s.children===i.children&&!Ge.current){e=rn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Yt(-1,n&-n),a.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),dc(s.return,n,e),l.lanes|=n;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(O(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),dc(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Le(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,li(e,n),i=vt(i),r=r(i),e.flags|=1,Le(t,e,r,n),e.child;case 14:return r=e.type,i=St(r,e.pendingProps),i=St(r.type,i),Ah(t,e,r,i,n);case 15:return xy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:St(r,i),Yo(t,e),e.tag=1,Qe(r)?(t=!0,ml(e)):t=!1,li(e,n),vy(e,r,i),hc(e,r,i,n),gc(null,e,r,!0,t,n);case 19:return _y(t,e,n);case 22:return Sy(t,e,n)}throw Error(O(156,e.tag))};function Uy(t,e){return mg(t,e)}function nx(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pt(t,e,n,r){return new nx(t,e,n,r)}function Yd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function rx(t){if(typeof t=="function")return Yd(t)?1:0;if(t!=null){if(t=t.$$typeof,t===gd)return 11;if(t===yd)return 14}return 2}function An(t,e){var n=t.alternate;return n===null?(n=pt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function el(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Yd(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Hr:return cr(n.children,i,s,e);case md:o=8,i|=8;break;case Lu:return t=pt(12,n,e,i|2),t.elementType=Lu,t.lanes=s,t;case $u:return t=pt(13,n,e,i),t.elementType=$u,t.lanes=s,t;case zu:return t=pt(19,n,e,i),t.elementType=zu,t.lanes=s,t;case Xm:return ta(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Qm:o=10;break e;case Ym:o=9;break e;case gd:o=11;break e;case yd:o=14;break e;case cn:o=16,r=null;break e}throw Error(O(130,t==null?t:typeof t,""))}return e=pt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function cr(t,e,n,r){return t=pt(7,t,r,e),t.lanes=n,t}function ta(t,e,n,r){return t=pt(22,t,r,e),t.elementType=Xm,t.lanes=n,t.stateNode={isHidden:!1},t}function ru(t,e,n){return t=pt(6,t,null,e),t.lanes=n,t}function iu(t,e,n){return e=pt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ix(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$a(0),this.expirationTimes=$a(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$a(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xd(t,e,n,r,i,s,o,l,a){return t=new ix(t,e,n,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=pt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dd(s),t}function sx(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Vy(t){if(!t)return zn;t=t._reactInternals;e:{if(Nr(t)!==t||t.tag!==1)throw Error(O(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qe(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(O(171))}if(t.tag===1){var n=t.type;if(Qe(n))return Vg(t,n,e)}return e}function Hy(t,e,n,r,i,s,o,l,a){return t=Xd(n,r,!0,t,i,s,o,l,a),t.context=Vy(null),n=t.current,r=$e(),i=Pn(n),s=Yt(r,i),s.callback=e??null,Nn(n,s,i),t.current.lanes=i,Gs(t,i,r),Ye(t,r),t}function na(t,e,n,r){var i=e.current,s=$e(),o=Pn(i);return n=Vy(n),e.context===null?e.context=n:e.pendingContext=n,e=Yt(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Nn(i,e,o),t!==null&&(Ot(t,i,o,s),Jo(t,i,o)),o}function Ol(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Hh(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Zd(t,e){Hh(t,e),(t=t.alternate)&&Hh(t,e)}function ox(){return null}var Wy=typeof reportError=="function"?reportError:function(t){console.error(t)};function ef(t){this._internalRoot=t}ra.prototype.render=ef.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(O(409));na(t,e,null,null)};ra.prototype.unmount=ef.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xr(function(){na(null,t,null,null)}),e[tn]=null}};function ra(t){this._internalRoot=t}ra.prototype.unstable_scheduleHydration=function(t){if(t){var e=Sg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<mn.length&&e!==0&&e<mn[n].priority;n++);mn.splice(n,0,t),n===0&&Cg(t)}};function tf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ia(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Wh(){}function lx(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Ol(o);s.call(u)}}var o=Hy(e,r,t,0,null,!1,!1,"",Wh);return t._reactRootContainer=o,t[tn]=o.current,_s(t.nodeType===8?t.parentNode:t),xr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Ol(a);l.call(u)}}var a=Xd(t,0,!1,null,null,!1,!1,"",Wh);return t._reactRootContainer=a,t[tn]=a.current,_s(t.nodeType===8?t.parentNode:t),xr(function(){na(e,a,n,r)}),a}function sa(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=Ol(o);l.call(a)}}na(e,o,t,i)}else o=lx(n,e,t,i,r);return Ol(o)}kg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ji(e.pendingLanes);n!==0&&(kd(e,n|1),Ye(e,se()),!(H&6)&&(yi=se()+500,Vn()))}break;case 13:xr(function(){var r=nn(t,1);if(r!==null){var i=$e();Ot(r,t,1,i)}}),Zd(t,1)}};xd=function(t){if(t.tag===13){var e=nn(t,134217728);if(e!==null){var n=$e();Ot(e,t,134217728,n)}Zd(t,134217728)}};xg=function(t){if(t.tag===13){var e=Pn(t),n=nn(t,e);if(n!==null){var r=$e();Ot(n,t,e,r)}Zd(t,e)}};Sg=function(){return W};bg=function(t,e){var n=W;try{return W=t,e()}finally{W=n}};Gu=function(t,e,n){switch(e){case"input":if(Uu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Gl(r);if(!i)throw Error(O(90));eg(r),Uu(r,i)}}}break;case"textarea":ng(t,n);break;case"select":e=n.value,e!=null&&ri(t,!!n.multiple,e,!1)}};ug=Jd;cg=xr;var ax={usingClientEntryPoint:!1,Events:[Ys,Jr,Gl,lg,ag,Jd]},Vi={findFiberByHostInstance:rr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ux={bundleType:Vi.bundleType,version:Vi.version,rendererPackageName:Vi.rendererPackageName,rendererConfig:Vi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:on.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=hg(t),t===null?null:t.stateNode},findFiberByHostInstance:Vi.findFiberByHostInstance||ox,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var No=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!No.isDisabled&&No.supportsFiber)try{Wl=No.inject(ux),Lt=No}catch{}}at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ax;at.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tf(e))throw Error(O(200));return sx(t,e,null,n)};at.createRoot=function(t,e){if(!tf(t))throw Error(O(299));var n=!1,r="",i=Wy;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xd(t,1,!1,null,null,n,!1,r,i),t[tn]=e.current,_s(t.nodeType===8?t.parentNode:t),new ef(e)};at.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(O(188)):(t=Object.keys(t).join(","),Error(O(268,t)));return t=hg(e),t=t===null?null:t.stateNode,t};at.flushSync=function(t){return xr(t)};at.hydrate=function(t,e,n){if(!ia(e))throw Error(O(200));return sa(null,t,e,!0,n)};at.hydrateRoot=function(t,e,n){if(!tf(t))throw Error(O(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Wy;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Hy(e,null,t,1,n??null,i,!1,s,o),t[tn]=e.current,_s(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new ra(e)};at.render=function(t,e,n){if(!ia(e))throw Error(O(200));return sa(null,t,e,!1,n)};at.unmountComponentAtNode=function(t){if(!ia(t))throw Error(O(40));return t._reactRootContainer?(xr(function(){sa(null,null,t,!1,function(){t._reactRootContainer=null,t[tn]=null})}),!0):!1};at.unstable_batchedUpdates=Jd;at.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ia(n))throw Error(O(200));if(t==null||t._reactInternals===void 0)throw Error(O(38));return sa(t,e,n,!1,r)};at.version="18.3.1-next-f1338f8080-20240426";function qy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qy)}catch(t){console.error(t)}}qy(),qm.exports=at;var Ky=qm.exports;const cx=ld(Ky);var qh=Ky;Du.createRoot=qh.createRoot,Du.hydrateRoot=qh.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ds(){return Ds=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ds.apply(this,arguments)}var xn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(xn||(xn={}));const Kh="popstate";function dx(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:l}=r.location;return Oc("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Gy(i)}return hx(e,n,null,t)}function ue(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Jy(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function fx(){return Math.random().toString(36).substr(2,8)}function Jh(t,e){return{usr:t.state,key:t.key,idx:e}}function Oc(t,e,n,r){return n===void 0&&(n=null),Ds({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Oi(e):e,{state:n,key:e&&e.key||r||fx()})}function Gy(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Oi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function hx(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,l=xn.Pop,a=null,u=c();u==null&&(u=0,o.replaceState(Ds({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function d(){l=xn.Pop;let y=c(),g=y==null?null:y-u;u=y,a&&a({action:l,location:m.location,delta:g})}function f(y,g){l=xn.Push;let v=Oc(m.location,y,g);u=c()+1;let w=Jh(v,u),x=m.createHref(v);try{o.pushState(w,"",x)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;i.location.assign(x)}s&&a&&a({action:l,location:m.location,delta:1})}function h(y,g){l=xn.Replace;let v=Oc(m.location,y,g);u=c();let w=Jh(v,u),x=m.createHref(v);o.replaceState(w,"",x),s&&a&&a({action:l,location:m.location,delta:0})}function p(y){let g=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:Gy(y);return v=v.replace(/ $/,"%20"),ue(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let m={get action(){return l},get location(){return t(i,o)},listen(y){if(a)throw new Error("A history only accepts one active listener");return i.addEventListener(Kh,d),a=y,()=>{i.removeEventListener(Kh,d),a=null}},createHref(y){return e(i,y)},createURL:p,encodeLocation(y){let g=p(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(y){return o.go(y)}};return m}var Gh;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Gh||(Gh={}));function px(t,e,n){return n===void 0&&(n="/"),mx(t,e,n)}function mx(t,e,n,r){let i=typeof e=="string"?Oi(e):e,s=Xy(i.pathname||"/",n);if(s==null)return null;let o=Qy(t);gx(o);let l=null;for(let a=0;l==null&&a<o.length;++a){let u=Ox(s);l=Ex(o[a],u)}return l}function Qy(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,l)=>{let a={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};a.relativePath.startsWith("/")&&(ue(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(r.length));let u=dr([r,a.relativePath]),c=n.concat(a);s.children&&s.children.length>0&&(ue(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Qy(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:bx(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let a of Yy(s.path))i(s,o,a)}),e}function Yy(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=Yy(r.join("/")),l=[];return l.push(...o.map(a=>a===""?s:[s,a].join("/"))),i&&l.push(...o),l.map(a=>t.startsWith("/")&&a===""?"/":a)}function gx(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Cx(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const yx=/^:[\w-]+$/,vx=3,wx=2,kx=1,xx=10,Sx=-2,Qh=t=>t==="*";function bx(t,e){let n=t.split("/"),r=n.length;return n.some(Qh)&&(r+=Sx),e&&(r+=wx),n.filter(i=>!Qh(i)).reduce((i,s)=>i+(yx.test(s)?vx:s===""?kx:xx),r)}function Cx(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function Ex(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let l=0;l<r.length;++l){let a=r[l],u=l===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",d=_x({path:a.relativePath,caseSensitive:a.caseSensitive,end:u},c),f=a.route;if(!d)return null;Object.assign(i,d.params),o.push({params:i,pathname:dr([s,d.pathname]),pathnameBase:Ax(dr([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=dr([s,d.pathnameBase]))}return o}function _x(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Tx(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((u,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let m=l[d]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=l[d];return h&&!p?u[f]=void 0:u[f]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function Tx(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Jy(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,a)=>(r.push({paramName:l,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Ox(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Jy(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Xy(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Nx(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Oi(t):t;return{pathname:n?n.startsWith("/")?n:Mx(n,e):e,search:Ix(r),hash:Rx(i)}}function Mx(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function su(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Px(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Zy(t,e){let n=Px(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function e0(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Oi(t):(i=Ds({},t),ue(!i.pathname||!i.pathname.includes("?"),su("?","pathname","search",i)),ue(!i.pathname||!i.pathname.includes("#"),su("#","pathname","hash",i)),ue(!i.search||!i.search.includes("#"),su("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}l=d>=0?e[d]:"/"}let a=Nx(i,l),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&n.endsWith("/");return!a.pathname.endsWith("/")&&(u||c)&&(a.pathname+="/"),a}const dr=t=>t.join("/").replace(/\/\/+/g,"/"),Ax=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Ix=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Rx=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Dx(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const t0=["post","put","patch","delete"];new Set(t0);const jx=["get",...t0];new Set(jx);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function js(){return js=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},js.apply(this,arguments)}const nf=C.createContext(null),Lx=C.createContext(null),Zs=C.createContext(null),oa=C.createContext(null),Mr=C.createContext({outlet:null,matches:[],isDataRoute:!1}),n0=C.createContext(null);function eo(){return C.useContext(oa)!=null}function rf(){return eo()||ue(!1),C.useContext(oa).location}function r0(t){C.useContext(Zs).static||C.useLayoutEffect(t)}function sf(){let{isDataRoute:t}=C.useContext(Mr);return t?Qx():$x()}function $x(){eo()||ue(!1);let t=C.useContext(nf),{basename:e,future:n,navigator:r}=C.useContext(Zs),{matches:i}=C.useContext(Mr),{pathname:s}=rf(),o=JSON.stringify(Zy(i,n.v7_relativeSplatPath)),l=C.useRef(!1);return r0(()=>{l.current=!0}),C.useCallback(function(u,c){if(c===void 0&&(c={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let d=e0(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:dr([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,o,s,t])}function zx(t,e){return Bx(t,e)}function Bx(t,e,n,r){eo()||ue(!1);let{navigator:i}=C.useContext(Zs),{matches:s}=C.useContext(Mr),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let u=rf(),c;if(e){var d;let y=typeof e=="string"?Oi(e):e;a==="/"||(d=y.pathname)!=null&&d.startsWith(a)||ue(!1),c=y}else c=u;let f=c.pathname||"/",h=f;if(a!=="/"){let y=a.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=px(t,{pathname:h}),m=Wx(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:dr([a,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?a:dr([a,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,n,r);return e&&m?C.createElement(oa.Provider,{value:{location:js({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:xn.Pop}},m):m}function Fx(){let t=Gx(),e=Dx(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:i},n):null,null)}const Ux=C.createElement(Fx,null);class Vx extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(Mr.Provider,{value:this.props.routeContext},C.createElement(n0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Hx(t){let{routeContext:e,match:n,children:r}=t,i=C.useContext(nf);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(Mr.Provider,{value:e},r)}function Wx(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(i=n)==null?void 0:i.errors;if(l!=null){let c=o.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);c>=0||ue(!1),o=o.slice(0,Math.min(o.length,c+1))}let a=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let d=o[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){a=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,d,f)=>{let h,p=!1,m=null,y=null;n&&(h=l&&d.route.id?l[d.route.id]:void 0,m=d.route.errorElement||Ux,a&&(u<0&&f===0?(Yx("route-fallback"),p=!0,y=null):u===f&&(p=!0,y=d.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),v=()=>{let w;return h?w=m:p?w=y:d.route.Component?w=C.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=c,C.createElement(Hx,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?C.createElement(Vx,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:v(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):v()},null)}var i0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(i0||{}),s0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(s0||{});function qx(t){let e=C.useContext(nf);return e||ue(!1),e}function Kx(t){let e=C.useContext(Lx);return e||ue(!1),e}function Jx(t){let e=C.useContext(Mr);return e||ue(!1),e}function o0(t){let e=Jx(),n=e.matches[e.matches.length-1];return n.route.id||ue(!1),n.route.id}function Gx(){var t;let e=C.useContext(n0),n=Kx(),r=o0();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function Qx(){let{router:t}=qx(i0.UseNavigateStable),e=o0(s0.UseNavigateStable),n=C.useRef(!1);return r0(()=>{n.current=!0}),C.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,js({fromRouteId:e},s)))},[t,e])}const Yh={};function Yx(t,e,n){Yh[t]||(Yh[t]=!0)}function Xx(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Zx(t){let{to:e,replace:n,state:r,relative:i}=t;eo()||ue(!1);let{future:s,static:o}=C.useContext(Zs),{matches:l}=C.useContext(Mr),{pathname:a}=rf(),u=sf(),c=e0(e,Zy(l,s.v7_relativeSplatPath),a,i==="path"),d=JSON.stringify(c);return C.useEffect(()=>u(JSON.parse(d),{replace:n,state:r,relative:i}),[u,d,i,n,r]),null}function Nc(t){ue(!1)}function eS(t){let{basename:e="/",children:n=null,location:r,navigationType:i=xn.Pop,navigator:s,static:o=!1,future:l}=t;eo()&&ue(!1);let a=e.replace(/^\/*/,"/"),u=C.useMemo(()=>({basename:a,navigator:s,static:o,future:js({v7_relativeSplatPath:!1},l)}),[a,l,s,o]);typeof r=="string"&&(r=Oi(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=C.useMemo(()=>{let y=Xy(c,a);return y==null?null:{location:{pathname:y,search:d,hash:f,state:h,key:p},navigationType:i}},[a,c,d,f,h,p,i]);return m==null?null:C.createElement(Zs.Provider,{value:u},C.createElement(oa.Provider,{children:n,value:m}))}function tS(t){let{children:e,location:n}=t;return zx(Mc(e),n)}new Promise(()=>{});function Mc(t,e){e===void 0&&(e=[]);let n=[];return C.Children.forEach(t,(r,i)=>{if(!C.isValidElement(r))return;let s=[...e,i];if(r.type===C.Fragment){n.push.apply(n,Mc(r.props.children,s));return}r.type!==Nc&&ue(!1),!r.props.index||!r.props.children||ue(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Mc(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const nS="6";try{window.__reactRouterVersion=nS}catch{}const rS="startTransition",Xh=Zw[rS];function iS(t){let{basename:e,children:n,future:r,window:i}=t,s=C.useRef();s.current==null&&(s.current=dx({window:i,v5Compat:!0}));let o=s.current,[l,a]=C.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},c=C.useCallback(d=>{u&&Xh?Xh(()=>a(d)):a(d)},[a,u]);return C.useLayoutEffect(()=>o.listen(c),[o,c]),C.useEffect(()=>Xx(r),[r]),C.createElement(eS,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}var Zh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Zh||(Zh={}));var ep;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ep||(ep={}));const sS={},tp=t=>{let e;const n=new Set,r=(c,d)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const h=e;e=d??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(p=>p(e,h))}},i=()=>e,a={setState:r,getState:i,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(sS?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=e=t(r,i,a);return a},oS=t=>t?tp(t):tp;var l0={exports:{}},a0={},u0={exports:{}},c0={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vi=C;function lS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var aS=typeof Object.is=="function"?Object.is:lS,uS=vi.useState,cS=vi.useEffect,dS=vi.useLayoutEffect,fS=vi.useDebugValue;function hS(t,e){var n=e(),r=uS({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return dS(function(){i.value=n,i.getSnapshot=e,ou(i)&&s({inst:i})},[t,n,e]),cS(function(){return ou(i)&&s({inst:i}),t(function(){ou(i)&&s({inst:i})})},[t]),fS(n),n}function ou(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!aS(t,n)}catch{return!0}}function pS(t,e){return e()}var mS=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?pS:hS;c0.useSyncExternalStore=vi.useSyncExternalStore!==void 0?vi.useSyncExternalStore:mS;u0.exports=c0;var gS=u0.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var la=C,yS=gS;function vS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wS=typeof Object.is=="function"?Object.is:vS,kS=yS.useSyncExternalStore,xS=la.useRef,SS=la.useEffect,bS=la.useMemo,CS=la.useDebugValue;a0.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=xS(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=bS(function(){function a(h){if(!u){if(u=!0,c=h,h=r(h),i!==void 0&&o.hasValue){var p=o.value;if(i(p,h))return d=p}return d=h}if(p=d,wS(c,h))return p;var m=r(h);return i!==void 0&&i(p,m)?(c=h,p):(c=h,d=m)}var u=!1,c,d,f=n===void 0?null:n;return[function(){return a(e())},f===null?void 0:function(){return a(f())}]},[e,n,r,i]);var l=kS(t,s[0],s[1]);return SS(function(){o.hasValue=!0,o.value=l},[l]),CS(l),l};l0.exports=a0;var ES=l0.exports;const _S=ld(ES),d0={},{useDebugValue:TS}=me,{useSyncExternalStoreWithSelector:OS}=_S;let np=!1;const NS=t=>t;function MS(t,e=NS,n){(d0?"production":void 0)!=="production"&&n&&!np&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),np=!0);const r=OS(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return TS(r),r}const rp=t=>{(d0?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?oS(t):t,n=(r,i)=>MS(e,r,i);return Object.assign(n,e),n},f0=t=>t?rp(t):rp,PS="modulepreload",AS=function(t){return"/"+t},ip={},to=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(a=>{if(a=AS(a),a in ip)return;ip[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":PS,u||(d.as="script"),d.crossOrigin="",d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},IS=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>to(async()=>{const{default:r}=await Promise.resolve().then(()=>Ni);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class of extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class RS extends of{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class DS extends of{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class jS extends of{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Pc;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Pc||(Pc={}));var LS=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};class $S{constructor(e,{headers:n={},customFetch:r,region:i=Pc.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=IS(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return LS(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=n;let l={},{region:a}=n;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:u}).catch(p=>{throw new RS(p)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new DS(c);if(!c.ok)throw new jS(c);let f=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),h;return f==="application/json"?h=yield c.json():f==="application/octet-stream"?h=yield c.blob():f==="text/event-stream"?h=c:f==="multipart/form-data"?h=yield c.formData():h=yield c.text(),{data:h,error:null}}catch(i){return{data:null,error:i}}})}}var Ke={},lf={},aa={},no={},ua={},ca={},zS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},wi=zS();const BS=wi.fetch,h0=wi.fetch.bind(wi),p0=wi.Headers,FS=wi.Request,US=wi.Response,Ni=Object.freeze(Object.defineProperty({__proto__:null,Headers:p0,Request:FS,Response:US,default:h0,fetch:BS},Symbol.toStringTag,{value:"Module"})),VS=Lw(Ni);var da={};Object.defineProperty(da,"__esModule",{value:!0});let HS=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};da.default=HS;var m0=yt&&yt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ca,"__esModule",{value:!0});const WS=m0(VS),qS=m0(da);let KS=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=WS.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,l,a;let u=null,c=null,d=null,f=s.status,h=s.statusText;if(s.ok){if(this.method!=="HEAD"){const g=await s.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=g:c=JSON.parse(g))}const m=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");m&&y&&y.length>1&&(d=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,f=406,h="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const m=await s.text();try{u=JSON.parse(m),Array.isArray(u)&&s.status===404&&(c=[],u=null,f=200,h="OK")}catch{s.status===404&&m===""?(f=204,h="No Content"):u={message:m}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,f=200,h="OK"),u&&this.shouldThrowOnError)throw new qS.default(u)}return{error:u,data:c,count:d,status:f,statusText:h}});return this.shouldThrowOnError||(i=i.catch(s=>{var o,l,a;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=s==null?void 0:s.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};ca.default=KS;var JS=yt&&yt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ua,"__esModule",{value:!0});const GS=JS(ca);let QS=class extends GS.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ua.default=QS;var YS=yt&&yt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(no,"__esModule",{value:!0});const XS=YS(ua);let ZS=class extends XS.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};no.default=ZS;var eb=yt&&yt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(aa,"__esModule",{value:!0});const Hi=eb(no);let tb=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=n,this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Hi.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Hi.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Hi.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new Hi.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Hi.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};aa.default=tb;var fa={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.version=void 0;ha.version="0.0.0-automated";Object.defineProperty(fa,"__esModule",{value:!0});fa.DEFAULT_HEADERS=void 0;const nb=ha;fa.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${nb.version}`};var g0=yt&&yt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(lf,"__esModule",{value:!0});const rb=g0(aa),ib=g0(no),sb=fa;let ob=class y0{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},sb.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new rb.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new y0(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:s}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;r||i?(o=r?"HEAD":"GET",Object.entries(n).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{l.searchParams.append(c,d)})):(o="POST",a=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new ib.default({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};lf.default=ob;var Mi=yt&&yt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.PostgrestError=Ke.PostgrestBuilder=Ke.PostgrestTransformBuilder=Ke.PostgrestFilterBuilder=Ke.PostgrestQueryBuilder=Ke.PostgrestClient=void 0;const v0=Mi(lf);Ke.PostgrestClient=v0.default;const w0=Mi(aa);Ke.PostgrestQueryBuilder=w0.default;const k0=Mi(no);Ke.PostgrestFilterBuilder=k0.default;const x0=Mi(ua);Ke.PostgrestTransformBuilder=x0.default;const S0=Mi(ca);Ke.PostgrestBuilder=S0.default;const b0=Mi(da);Ke.PostgrestError=b0.default;var lb=Ke.default={PostgrestClient:v0.default,PostgrestQueryBuilder:w0.default,PostgrestFilterBuilder:k0.default,PostgrestTransformBuilder:x0.default,PostgrestBuilder:S0.default,PostgrestError:b0.default};const{PostgrestClient:ab,PostgrestQueryBuilder:CA,PostgrestFilterBuilder:EA,PostgrestTransformBuilder:_A,PostgrestBuilder:TA,PostgrestError:OA}=lb;function ub(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const cb=ub(),db="2.11.13",fb={"X-Client-Info":`realtime-js/${db}`},hb="1.0.0",C0=1e4,pb=1e3;var cs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(cs||(cs={}));var Ne;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Ne||(Ne={}));var Ct;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ct||(Ct={}));var Ac;(function(t){t.websocket="websocket"})(Ac||(Ac={}));var er;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(er||(er={}));class mb{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+i));o=o+i;const a=r.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class E0{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var J;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(J||(J={}));const sp=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,o)=>(s[o]=gb(o,t,e,i),s),{})},gb=(t,e,n,r)=>{const i=e.find(l=>l.name===t),s=i==null?void 0:i.type,o=n[t];return s&&!r.includes(s)?_0(s,o):Ic(o)},_0=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return kb(e,n)}switch(t){case J.bool:return yb(e);case J.float4:case J.float8:case J.int2:case J.int4:case J.int8:case J.numeric:case J.oid:return vb(e);case J.json:case J.jsonb:return wb(e);case J.timestamp:return xb(e);case J.abstime:case J.date:case J.daterange:case J.int4range:case J.int8range:case J.money:case J.reltime:case J.text:case J.time:case J.timestamptz:case J.timetz:case J.tsrange:case J.tstzrange:return Ic(e);default:return Ic(e)}},Ic=t=>t,yb=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},vb=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},wb=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},kb=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const o=t.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>_0(e,l))}return t},xb=t=>typeof t=="string"?t.replace(" ","T"):t,T0=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class lu{constructor(e,n,r={},i=C0){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var op;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(op||(op={}));class ds{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ds.syncState(this.state,i,s,o),this.pendingDiffs.forEach(a=>{this.state=ds.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ds.syncDiff(this.state,i,s,o),l())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const s=this.cloneDeep(e),o=this.transformState(n),l={},a={};return this.map(s,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const d=s[u];if(d){const f=c.map(y=>y.presence_ref),h=d.map(y=>y.presence_ref),p=c.filter(y=>h.indexOf(y.presence_ref)<0),m=d.filter(y=>f.indexOf(y.presence_ref)<0);p.length>0&&(l[u]=p),m.length>0&&(a[u]=m)}else l[u]=c}),this.syncDiff(s,{joins:l,leaves:a},r,i)}static syncDiff(e,n,r,i){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const d=e[l].map(h=>h.presence_ref),f=c.filter(h=>d.indexOf(h.presence_ref)<0);e[l].unshift(...f)}r(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[l]=u,i(l,u,a),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var lp;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(lp||(lp={}));var ap;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ap||(ap={}));var Wt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Wt||(Wt={}));class af{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Ne.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new lu(this,Ct.join,this.params,this.timeout),this.rejoinTimer=new E0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ne.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ne.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ne.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ne.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ct.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new ds(this),this.broadcastEndpointURL=T0(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Ne.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params;this._onError(c=>e==null?void 0:e(Wt.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(Wt.CLOSED));const a={},u={broadcast:s,presence:o,postgres_changes:(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&i!==void 0?i:[],private:l};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},a)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),c===void 0){e==null||e(Wt.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,h=(d=f==null?void 0:f.length)!==null&&d!==void 0?d:0,p=[];for(let m=0;m<h;m++){const y=f[m],{filter:{event:g,schema:v,table:w,filter:x}}=y,b=c&&c[m];if(b&&b.event===g&&b.schema===v&&b.table===w&&b.filter===x)p.push(Object.assign(Object.assign({},y),{id:b.id}));else{this.unsubscribe(),this.state=Ne.errored,e==null||e(Wt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(Wt.SUBSCRIBED);return}}).receive("error",c=>{this.state=Ne.errored,e==null||e(Wt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Wt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,a;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ne.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ct.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new lu(this,Ct.leave,{},e),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new lu(this,e,n,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,s;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=Ct;if(r&&[l,a,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(h=>{var p,m,y;return((p=h.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(m=h.filter)===null||m===void 0?void 0:m.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(h=>h.callback(f,r)):(s=this.bindings[o])===null||s===void 0||s.filter(h=>{var p,m,y,g,v,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const x=h.id,b=(p=h.filter)===null||p===void 0?void 0:p.event;return x&&((m=n.ids)===null||m===void 0?void 0:m.includes(x))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const x=(v=(g=h==null?void 0:h.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return x==="*"||x===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:m,table:y,commit_timestamp:g,type:v,errors:w}=p;f=Object.assign(Object.assign({},{schema:m,table:y,commit_timestamp:g,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(p))}h.callback(f,r)})}_isClosed(){return this.state===Ne.closed}_isJoined(){return this.state===Ne.joined}_isJoining(){return this.state===Ne.joining}_isLeaving(){return this.state===Ne.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&af.isEqual(i.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ct.close,{},e)}_onError(e){this._on(Ct.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ne.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=sp(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=sp(e.columns,e.old_record)),n}}const up=()=>{},Sb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bb{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=fb,this.params={},this.timeout=C0,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=up,this.ref=0,this.logger=up,this.conn=null,this.sendBuffer=[],this.serializer=new mb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>to(async()=>{const{default:a}=await Promise.resolve().then(()=>Ni);return{default:a}},void 0).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${Ac.websocket}`,this.httpEndpoint=T0(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const i=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new E0(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){this.conn||(this.transport||(this.transport=cb),this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection())}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:hb}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case cs.connecting:return er.Connecting;case cs.open:return er.Open;case cs.closing:return er.Closing;default:return er.Closed}}isConnected(){return this.connectionState()===er.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new af(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:i,ref:s}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{n&&r.updateJoinPayload({access_token:n,version:this.headers&&this.headers["X-Client-Info"]}),r.joinedOnce&&r._isJoined()&&r._push(Ct.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(pb,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:i,payload:s,ref:o}=n;r==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${i} ${o&&"("+o+")"||""}`,s),Array.from(this.channels).filter(l=>l._isMember(r)).forEach(l=>l._trigger(i,s,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ct.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([Sb],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class uf extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function he(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Cb extends uf{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Rc extends uf{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Eb=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};const O0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>to(async()=>{const{default:r}=await Promise.resolve().then(()=>Ni);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},_b=()=>Eb(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield to(()=>Promise.resolve().then(()=>Ni),void 0)).Response:Response}),Dc=t=>{if(Array.isArray(t))return t.map(n=>Dc(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Dc(r)}),e};var Pr=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};const au=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Tb=(t,e,n)=>Pr(void 0,void 0,void 0,function*(){const r=yield _b();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{e(new Cb(au(i),t.status||500))}).catch(i=>{e(new Rc(au(i),i))}):e(new Rc(au(t),t))}),Ob=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),n))};function ro(t,e,n,r,i,s){return Pr(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,Ob(e,r,i,s)).then(a=>{if(!a.ok)throw a;return r!=null&&r.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>Tb(a,l,r))})})}function Nl(t,e,n,r){return Pr(this,void 0,void 0,function*(){return ro(t,"GET",e,n,r)})}function fn(t,e,n,r,i){return Pr(this,void 0,void 0,function*(){return ro(t,"POST",e,r,i,n)})}function Nb(t,e,n,r,i){return Pr(this,void 0,void 0,function*(){return ro(t,"PUT",e,r,i,n)})}function Mb(t,e,n,r){return Pr(this,void 0,void 0,function*(){return ro(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function N0(t,e,n,r,i){return Pr(this,void 0,void 0,function*(){return ro(t,"DELETE",e,r,i,n)})}var We=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};const Pb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ab{constructor(e,n={},r,i){this.url=e,this.headers=n,this.bucketId=r,this.fetch=O0(i)}uploadOrUpdate(e,n,r,i){return We(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},cp),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const a=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a))):(s=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,a&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const u=this._removeEmptyFolders(n),c=this._getFinalPath(u),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield d.json();return d.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(s){if(he(s))return{data:null,error:s};throw s}})}upload(e,n,r){return We(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return We(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let a;const u=Object.assign({upsert:cp.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",u.cacheControl)):(a=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),f=yield d.json();return d.ok?{data:{path:s,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(he(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,n){return We(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const s=yield fn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new uf("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}})}update(e,n,r){return We(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return We(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(he(i))return{data:null,error:i};throw i}})}copy(e,n,r){return We(this,void 0,void 0,function*(){try{return{data:{path:(yield fn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(he(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return We(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield fn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(he(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return We(this,void 0,void 0,function*(){try{const i=yield fn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(he(i))return{data:null,error:i};throw i}})}download(e,n){return We(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Nl(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(he(l))return{data:null,error:l};throw l}})}info(e){return We(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Nl(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Dc(r),error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}})}exists(e){return We(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Mb(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(he(r)&&r instanceof Rc){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&i.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});a!==""&&i.push(a);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(e){return We(this,void 0,void 0,function*(){try{return{data:yield N0(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}})}list(e,n,r){return We(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Pb),n),{prefix:e||""});return{data:yield fn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(he(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Ib="2.7.1",Rb={"X-Client-Info":`storage-js/${Ib}`};var Rr=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};class Db{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},Rb),n),this.fetch=O0(r)}listBuckets(){return Rr(this,void 0,void 0,function*(){try{return{data:yield Nl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(he(e))return{data:null,error:e};throw e}})}getBucket(e){return Rr(this,void 0,void 0,function*(){try{return{data:yield Nl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Rr(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Rr(this,void 0,void 0,function*(){try{return{data:yield Nb(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Rr(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Rr(this,void 0,void 0,function*(){try{return{data:yield N0(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(he(n))return{data:null,error:n};throw n}})}}class jb extends Db{constructor(e,n={},r){super(e,n,r)}from(e){return new Ab(this.url,this.headers,e,this.fetch)}}const Lb="2.50.1";let Qi="";typeof Deno<"u"?Qi="deno":typeof document<"u"?Qi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Qi="react-native":Qi="node";const $b={"X-Client-Info":`supabase-js-${Qi}/${Lb}`},zb={headers:$b},Bb={schema:"public"},Fb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ub={};var Vb=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};const Hb=t=>{let e;return t?e=t:typeof fetch>"u"?e=h0:e=fetch,(...n)=>e(...n)},Wb=()=>typeof Headers>"u"?p0:Headers,qb=(t,e,n)=>{const r=Hb(n),i=Wb();return(s,o)=>Vb(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:t;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),r(s,Object.assign(Object.assign({},o),{headers:u}))})};var Kb=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};function Jb(t){return t.endsWith("/")?t:t+"/"}function Gb(t,e){var n,r;const{db:i,auth:s,realtime:o,global:l}=t,{db:a,auth:u,realtime:c,global:d}=e,f={db:Object.assign(Object.assign({},a),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Kb(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}const M0="2.70.0",Br=30*1e3,jc=3,uu=jc*Br,Qb="http://localhost:9999",Yb="supabase.auth.token",Xb={"X-Client-Info":`gotrue-js/${M0}`},Lc="X-Supabase-Api-Version",P0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Zb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,eC=6e5;class cf extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function L(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class tC extends cf{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function nC(t){return L(t)&&t.name==="AuthApiError"}class A0 extends cf{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Hn extends cf{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class an extends Hn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rC(t){return L(t)&&t.name==="AuthSessionMissingError"}class Mo extends Hn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Po extends Hn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ao extends Hn{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function iC(t){return L(t)&&t.name==="AuthImplicitGrantRedirectError"}class dp extends Hn{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $c extends Hn{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function cu(t){return L(t)&&t.name==="AuthRetryableFetchError"}class fp extends Hn{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class fs extends Hn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ml="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),hp=` 	
\r=`.split(""),sC=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<hp.length;e+=1)t[hp[e].charCodeAt(0)]=-2;for(let e=0;e<Ml.length;e+=1)t[Ml[e].charCodeAt(0)]=e;return t})();function pp(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ml[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ml[r]),e.queuedBits-=6}}function I0(t,e,n){const r=sC[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function mp(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{aC(o,r,n)};for(let o=0;o<t.length;o+=1)I0(t.charCodeAt(o),i,s);return e.join("")}function oC(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function lC(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}oC(r,e)}}function aC(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function uC(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)I0(t.charCodeAt(i),n,r);return new Uint8Array(e)}function cC(t){const e=[];return lC(t,n=>e.push(n)),new Uint8Array(e)}function dC(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};return t.forEach(i=>pp(i,n,r)),pp(null,n,r),e.join("")}function fC(t){return Math.round(Date.now()/1e3)+t}function hC(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const xt=()=>typeof window<"u"&&typeof document<"u",Qn={tested:!1,writable:!1},hs=()=>{if(!xt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Qn.tested)return Qn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Qn.tested=!0,Qn.writable=!0}catch{Qn.tested=!0,Qn.writable=!1}return Qn.writable};function pC(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const R0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>to(async()=>{const{default:r}=await Promise.resolve().then(()=>Ni);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},mC=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",D0=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Io=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ro=async(t,e)=>{await t.removeItem(e)};class pa{constructor(){this.promise=new pa.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}pa.promiseConstructor=Promise;function du(t){const e=t.split(".");if(e.length!==3)throw new fs("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Zb.test(e[r]))throw new fs("JWT not in base64url format");return{header:JSON.parse(mp(e[0])),payload:JSON.parse(mp(e[1])),signature:uC(e[2]),raw:{header:e[0],payload:e[1]}}}async function gC(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function yC(t,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){r(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function vC(t){return("0"+t.toString(16)).substr(-2)}function wC(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,vC).join("")}async function kC(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function xC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await kC(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Dr(t,e,n=!1){const r=wC();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await D0(t,`${e}-code-verifier`,i);const s=await xC(r);return[s,r===s?"plain":"s256"]}const SC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function bC(t){const e=t.headers.get(Lc);if(!e||!e.match(SC))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function CC(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function EC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const _C=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function jr(t){if(!_C.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var TC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Zn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),OC=[502,503,504];async function gp(t){var e;if(!mC(t))throw new $c(Zn(t),0);if(OC.includes(t.status))throw new $c(Zn(t),t.status);let n;try{n=await t.json()}catch(s){throw new A0(Zn(s),s)}let r;const i=bC(t);if(i&&i.getTime()>=P0["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new fp(Zn(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new an}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new fp(Zn(n),t.status,n.weak_password.reasons);throw new tC(Zn(n),t.status||500,r)}const NC=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function U(t,e,n,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[Lc]||(s[Lc]=P0["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const o=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await MC(t,e,n+l,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(a):{data:Object.assign({},a),error:null}}async function MC(t,e,n,r,i,s){const o=NC(e,r,i,s);let l;try{l=await t(n,Object.assign({},o))}catch(a){throw console.error(a),new $c(Zn(a),0)}if(l.ok||await gp(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(a){await gp(a)}}function Vt(t){var e;let n=null;RC(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=fC(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function yp(t){const e=Vt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function yn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function PC(t){return{data:t,error:null}}function AC(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=t,o=TC(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function IC(t){return t}function RC(t){return t.access_token&&t.refresh_token&&t.expires_in}const fu=["global","local","others"];var DC=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class jC{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=R0(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=fu[0]){if(fu.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fu.join(", ")}`);try{return await U(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await U(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:yn})}catch(r){if(L(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=DC(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await U(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:AC,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(L(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await U(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yn})}catch(n){if(L(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await U(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:IC});if(c.error)throw c.error;const d=await c.json(),f=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return h.length>0&&(h.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);u[`${y}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(L(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){jr(e);try{return await U(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yn})}catch(n){if(L(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){jr(e);try{return await U(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:yn})}catch(r){if(L(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){jr(e);try{return await U(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:yn})}catch(r){if(L(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){jr(e.userId);try{const{data:n,error:r}=await U(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(L(n))return{data:null,error:n};throw n}}async _deleteFactor(e){jr(e.userId),jr(e.id);try{return{data:await U(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}}}const LC={getItem:t=>hs()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{hs()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{hs()&&globalThis.localStorage.removeItem(t)}};function vp(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function $C(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Lr={debug:!!(globalThis&&hs()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class j0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class zC extends j0{}async function BC(t,e,n){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Lr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new zC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Lr.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}$C();const FC={url:Qb,storageKey:Yb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Xb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function wp(t,e,n){return await n()}class Ls{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ls.nextInstanceID,Ls.nextInstanceID+=1,this.instanceID>0&&xt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},FC),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new jC({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=R0(i.fetch),this.lock=i.lock||wp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:xt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=BC:this.lock=wp,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:hs()?this.storage=LC:(this.memoryStorage={},this.storage=vp(this.memoryStorage)):(this.memoryStorage={},this.storage=vp(this.memoryStorage)),xt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${M0}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=pC(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),xt()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),iC(s)){const a=(e=s.details)===null||e===void 0?void 0:e.code;if(a==="identity_already_exists"||a==="identity_not_found"||a==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return L(n)?{error:n}:{error:new A0("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const s=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Vt}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(L(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,i;try{let s;if("email"in e){const{email:c,password:d,options:f}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await Dr(this.storage,this.storageKey)),s=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:p},xform:Vt})}else if("phone"in e){const{phone:c,password:d,options:f}=e;s=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Vt})}else throw new Po("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(L(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:o,options:l}=e;n=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:yp})}else if("phone"in e){const{phone:s,password:o,options:l}=e;n=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:yp})}else throw new Po("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Mo}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(L(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,i,s,o,l,a,u,c,d,f,h;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:y,wallet:g,statement:v,options:w}=e;let x;if(xt())if(typeof g=="object")x=g;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))x=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=g}const b=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in x&&x.signIn){const S=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),v?{statement:v}:null));let E;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")E=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)E=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)p=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),m=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${b.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(i=(r=w==null?void 0:w.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((d=(c=w==null?void 0:w.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||d===void 0)&&d.length?["Resources",...w.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const S=await x.signMessage(new TextEncoder().encode(p),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=S}}try{const{data:y,error:g}=await U(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:dC(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Vt});if(g)throw g;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Mo}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:g})}catch(y){if(L(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const n=await Io(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:s,error:o}=await U(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Vt});if(await Ro(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Mo}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(L(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:s,nonce:o}=e,l=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Vt}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Mo}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(n){if(L(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,s,o;try{if("email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Dr(this.storage,this.storageKey));const{error:d}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=a==null?void 0:a.data)!==null&&n!==void 0?n:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=a==null?void 0:a.data)!==null&&i!==void 0?i:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Po("You must provide either an email or phone number.")}catch(l){if(L(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let i,s;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await U(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Vt});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(i){if(L(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Dr(this.storage,this.storageKey)),await U(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:PC})}catch(s){if(L(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new an;const{error:i}=await U(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(L(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:o}=await U(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:o,error:l}=await U(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Po("You must provide either an email or phone number and a type")}catch(n){if(L(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Io(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<uu:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(a,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(a,u,c))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yn}):await this._useSession(async n=>{var r,i,s;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new an}:await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:yn})})}catch(n){if(L(n))return rC(n)&&(await this._removeSession(),await Ro(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new an;const o=i.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Dr(this.storage,this.storageKey));const{data:u,error:c}=await U(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:yn});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(L(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new an;const n=Date.now()/1e3;let r=n,i=!0,s=null;const{payload:o}=du(e.access_token);if(o.exp&&(r=o.exp,i=r<=n),i){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(L(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new an;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(L(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!xt())throw new Ao("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ao(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new dp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ao("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new dp("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=e;if(!s||!l||!o||!u)throw new Ao("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(l);let f=c+d;a&&(f=parseInt(a));const h=f-c;h*1e3<=Br&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const p=f-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,c);const{data:m,error:y}=await this._getUser(s);if(y)throw y;const g={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:f,refresh_token:o,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(r){if(L(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Io(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{error:s};const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(nC(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Ro(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=hC(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Dr(this.storage,this.storageKey,!0));try{return await U(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(L(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(L(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var o,l,a,u,c;const{data:d,error:f}=s;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await U(this.fetch,"GET",h,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return xt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(L(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)throw o;return await U(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(L(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await yC(async i=>(i>0&&await gC(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await U(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Vt})),(i,s)=>{const o=200*Math.pow(2,i);return s&&cu(s)&&Date.now()+o-r<Br})}catch(r){if(this._debug(n,"error",r),L(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),xt()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Io(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<uu;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${uu}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:s}=await this._callRefreshToken(r.refresh_token);s&&(console.error(s),cu(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new an;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new pa;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new an;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),L(s)){const o={session:null,error:s};return cu(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(a){s.push(a)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await D0(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Ro(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Br);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/Br);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Br}ms, refresh threshold is ${jc} ticks`),i<=jc&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof j0)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,o]=await Dr(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await U(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(L(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:u}=await U(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((i=a==null?void 0:a.totp)===null||i===void 0)&&i.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(n){if(L(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:l}=await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(L(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(L(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=du(i.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+eC>Date.now()))return r;const{data:i,error:s}=await U(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new fs("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),r=i.keys.find(o=>o.kid===e),!r)throw new fs("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:h,error:p}=await this.getSession();if(p||!h.session)return{data:null,error:p};r=h.session.access_token}const{header:i,payload:s,signature:o,raw:{header:l,payload:a}}=du(r);if(CC(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(r);if(h)throw h;return{data:{claims:s,header:i,signature:o},error:null}}const u=EC(i.alg),c=await this.fetchJwk(i.kid,n),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,o,cC(`${l}.${a}`)))throw new fs("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(r){if(L(r))return{data:null,error:r};throw r}}}Ls.nextInstanceID=0;const UC=Ls;class VC extends UC{constructor(e){super(e)}}var HC=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(r.next(c))}catch(d){o(d)}}function a(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):i(c.value).then(l,a)}u((r=r.apply(t,e||[])).next())})};class WC{constructor(e,n,r){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=Jb(e),a=new URL(l);this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const u=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:Bb,realtime:Ub,auth:Object.assign(Object.assign({},Fb),{storageKey:u}),global:zb},d=Gb(r??{},c);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=qb(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new ab(new URL("rest/v1",a).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new $S(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new jb(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return HC(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,storageKey:s,flowType:o,lock:l,debug:a},u,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new VC({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,flowType:o,lock:l,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new bb(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const qC=(t,e,n)=>new WC(t,e,n),KC="https://rjkunveqbiltuhetakmm.supabase.co",JC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJqa3VudmVxYmlsdHVoZXRha21tIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAyNzA1NDQsImV4cCI6MjA2NTg0NjU0NH0.LHRYrKw7d8OnW3C9USgNuz5Chq7i9A6r8F8Ae4pDgCY",Ft=qC(KC,JC);async function GC(t,e){const{data:n,error:r}=await Ft.auth.signUp({email:t,password:e});if(r)throw r;return n}async function QC(t,e){const{data:n,error:r}=await Ft.auth.signInWithPassword({email:t,password:e});if(r)throw r;return n}async function YC(){const{error:t}=await Ft.auth.signOut();if(t)throw t}async function XC(){const{data:{user:t}}=await Ft.auth.getUser();return t}async function ZC(t){return Ft.auth.onAuthStateChange((e,n)=>{t((n==null?void 0:n.user)||null)})}const L0=f0(t=>({user:null,loading:!0,initialized:!1,setUser:e=>t({user:e}),initialize:async()=>{try{const e=await XC();t({user:e,initialized:!0,loading:!1}),ZC(n=>{t({user:n,loading:!1})})}catch(e){console.error("Failed to initialize auth:",e),t({initialized:!0,loading:!1})}}})),ma=f0((t,e)=>({currentDoc:null,onDocumentListRefresh:void 0,setDoc:n=>t({currentDoc:n}),updateContent:n=>t(r=>r.currentDoc?{currentDoc:{...r.currentDoc,content:n}}:{}),updateTitle:n=>t(r=>r.currentDoc?{currentDoc:{...r.currentDoc,title:n}}:{}),refreshDocuments:()=>{const{onDocumentListRefresh:n}=e();n&&n()},setDocumentListRefreshCallback:n=>t({onDocumentListRefresh:n})})),io="documents";async function zc(t="Untitled Document"){const{data:e,error:n}=await Ft.from(io).insert([{title:t,content:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(n)throw n;return e}async function kp(t,e){const{error:n}=await Ft.from(io).update({content:e,updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n}async function eE(){const{data:t,error:e}=await Ft.from(io).select("*").order("updated_at",{ascending:!1});if(e)throw e;return t||[]}async function tE(t,e){const{error:n}=await Ft.from(io).update({title:e,updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n}async function nE(t){const{error:e}=await Ft.from(io).delete().eq("id",t);if(e)throw e}function Se(t){this.content=t}Se.prototype={constructor:Se,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),s=r.content.slice();return i==-1?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new Se(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new Se(n)},addToStart:function(t,e){return new Se([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new Se(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),s=r.find(t);return i.splice(s==-1?i.length:s,0,e,n),new Se(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Se.from(t),t.size?new Se(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Se.from(t),t.size?new Se(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Se.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};Se.from=function(t){if(t instanceof Se)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new Se(e)};function $0(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),s=e.child(r);if(i==s){n+=i.nodeSize;continue}if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)n++;return n}if(i.content.size||s.content.size){let o=$0(i.content,s.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function z0(t,e,n,r){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:n,b:r};let o=t.child(--i),l=e.child(--s),a=o.nodeSize;if(o==l){n-=a,r-=a;continue}if(!o.sameMarkup(l))return{a:n,b:r};if(o.isText&&o.text!=l.text){let u=0,c=Math.min(o.text.length,l.text.length);for(;u<c&&o.text[o.text.length-u-1]==l.text[l.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(o.content.size||l.content.size){let u=z0(o.content,l.content,n-1,r-1);if(u)return u}n-=a,r-=a}}class T{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,s){for(let o=0,l=0;l<n;o++){let a=this.content[o],u=l+a.nodeSize;if(u>e&&r(a,i+l,s||null,o)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,n-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let s="",o=!0;return this.nodesBetween(e,n,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,n-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(o?o=!1:s+=r),s+=u},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new T(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let s=0,o=0;o<n;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>n)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,n-o-1))),r.push(l),i+=l.nodeSize),o=a}return new T(r,i)}cutByIndex(e,n){return e==n?T.empty:e==0&&n==this.content.length?this:new T(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new T(i,s)}addToStart(e){return new T([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new T(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return $0(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return z0(this,e,n,r)}findIndex(e,n=-1){if(e==0)return Do(0,e);if(e==this.size)return Do(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||n>0?Do(r+1,o):Do(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return T.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new T(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return T.empty;let n,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(n||(n=e.slice(0,i)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new T(n||e,r)}static from(e){if(!e)return T.empty;if(e instanceof T)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new T([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}T.empty=new T([],0);const hu={index:0,offset:0};function Do(t,e){return hu.index=t,hu.offset=e,hu}function Pl(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Pl(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Pl(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let K=class Bc{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Pl(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Bc.none;if(e instanceof Bc)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};K.none=[];class Al extends Error{}class N{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=F0(this.content,e+this.openStart,n);return r&&new N(r,this.openStart,this.openEnd)}removeBetween(e,n){return new N(B0(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return N.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new N(T.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new N(e,r,i)}}N.empty=new N(T.empty,0,0);function B0(t,e,n){let{index:r,offset:i}=t.findIndex(e),s=t.maybeChild(r),{index:o,offset:l}=t.findIndex(n);if(i==e||s.isText){if(l!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(B0(s.content,e-i-1,n-i-1)))}function F0(t,e,n,r){let{index:i,offset:s}=t.findIndex(e),o=t.maybeChild(i);if(s==e||o.isText)return t.cut(0,e).append(n).append(t.cut(e));let l=F0(o.content,e-s-1,n);return l&&t.replaceChild(i,o.copy(l))}function rE(t,e,n){if(n.openStart>t.depth)throw new Al("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Al("Inconsistent open depths");return U0(t,e,n,0)}function U0(t,e,n,r){let i=t.index(r),s=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let o=U0(t,e,n,r+1);return s.copy(s.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,l=o.content;return hr(o,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=iE(n,t);return hr(s,H0(t,o,l,e,r))}else return hr(s,Il(t,e,r))}function V0(t,e){if(!e.type.compatibleContent(t.type))throw new Al("Cannot join "+e.type.name+" onto "+t.type.name)}function Fc(t,e,n){let r=t.node(n);return V0(r,e.node(n)),r}function fr(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function ps(t,e,n,r){let i=(e||t).node(n),s=0,o=e?e.index(n):i.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(fr(t.nodeAfter,r),s++));for(let l=s;l<o;l++)fr(i.child(l),r);e&&e.depth==n&&e.textOffset&&fr(e.nodeBefore,r)}function hr(t,e){return t.type.checkContent(e),t.copy(e)}function H0(t,e,n,r,i){let s=t.depth>i&&Fc(t,e,i+1),o=r.depth>i&&Fc(n,r,i+1),l=[];return ps(null,t,i,l),s&&o&&e.index(i)==n.index(i)?(V0(s,o),fr(hr(s,H0(t,e,n,r,i+1)),l)):(s&&fr(hr(s,Il(t,e,i+1)),l),ps(e,n,i,l),o&&fr(hr(o,Il(n,r,i+1)),l)),ps(r,null,i,l),new T(l)}function Il(t,e,n){let r=[];if(ps(null,t,n,r),t.depth>n){let i=Fc(t,e,n+1);fr(hr(i,Il(t,e,n+1)),r)}return ps(e,null,n,r),new T(r)}function iE(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)i=e.node(s).copy(T.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class $s{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return K.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Rl(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,s=n;for(let o=e;;){let{index:l,offset:a}=o.content.findIndex(s),u=s-a;if(r.push(o,l,i+a),!u||(o=o.child(l),o.isText))break;s=u-1,i+=a+1}return new $s(n,r,s)}static resolveCached(e,n){let r=xp.get(e);if(r)for(let s=0;s<r.elts.length;s++){let o=r.elts[s];if(o.pos==n)return o}else xp.set(e,r=new sE);let i=r.elts[r.i]=$s.resolve(e,n);return r.i=(r.i+1)%oE,i}}class sE{constructor(){this.elts=[],this.i=0}}const oE=12,xp=new WeakMap;class Rl{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const lE=Object.create(null);let In=class Uc{constructor(e,n,r,i=K.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||T.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Pl(this.attrs,n||e.defaultAttrs||lE)&&K.sameSet(this.marks,r||K.none)}copy(e=null){return e==this.content?this:new Uc(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Uc(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return N.empty;let i=this.resolve(e),s=this.resolve(n),o=r?0:i.sharedDepth(n),l=i.start(o),u=i.node(o).content.cut(i.pos-l,s.pos-l);return new N(u,i.depth-o,s.depth-o)}replace(e,n,r){return rE(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return $s.resolveCached(this,e)}resolveNoCache(e){return $s.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),W0(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=T.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let a=i;a<s;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=K.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!K.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=T.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,i,r);return s.type.checkAttrs(s.attrs),s}};In.prototype.text=void 0;class Dl extends In{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):W0(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Dl(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Dl(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function W0(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Sr{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new aE(e,n);if(r.next==null)return Sr.empty;let i=q0(r);r.next&&r.err("Unexpected trailing text");let s=mE(pE(i));return gE(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let s=n;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function s(o,l){let a=o.matchFragment(e,r);if(a&&(!n||a.validEnd))return T.from(l.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:c,next:d}=o.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let f=s(d,l.concat(c));if(f)return f}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:a}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}Sr.empty=new Sr(!0);class aE{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function q0(t){let e=[];do e.push(uE(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function uE(t){let e=[];do e.push(cE(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function cE(t){let e=hE(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=dE(t,e);else break;return e}function Sp(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function dE(t,e){let n=Sp(t),r=n;return t.eat(",")&&(t.next!="}"?r=Sp(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function fE(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let s in n){let o=n[s];o.isInGroup(e)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function hE(t){if(t.eat("(")){let e=q0(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=fE(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function pE(t){let e=[[]];return i(s(t,0),n()),e;function n(){return e.push([])-1}function r(o,l,a){let u={term:a,to:l};return e[o].push(u),u}function i(o,l){o.forEach(a=>a.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((a,u)=>a.concat(s(u,l)),[]);if(o.type=="seq")for(let a=0;;a++){let u=s(o.exprs[a],l);if(a==o.exprs.length-1)return u;i(u,l=n())}else if(o.type=="star"){let a=n();return r(l,a),i(s(o.expr,a),a),[r(a)]}else if(o.type=="plus"){let a=n();return i(s(o.expr,l),a),i(s(o.expr,a),a),[r(a)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let a=l;for(let u=0;u<o.min;u++){let c=n();i(s(o.expr,a),c),a=c}if(o.max==-1)i(s(o.expr,a),a);else for(let u=o.min;u<o.max;u++){let c=n();r(a,c),i(s(o.expr,a),c),a=c}return[r(a)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function K0(t,e){return e-t}function bp(t,e){let n=[];return r(e),n.sort(K0);function r(i){let s=t[i];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(i);for(let o=0;o<s.length;o++){let{term:l,to:a}=s[o];!l&&n.indexOf(a)==-1&&r(a)}}}function mE(t){let e=Object.create(null);return n(bp(t,0));function n(r){let i=[];r.forEach(o=>{t[o].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);bp(t,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let s=e[r.join(",")]=new Sr(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(K0);s.next.push({type:i[o][0],next:e[l.join(",")]||n(l)})}return s}}function gE(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];o.push(a.name),s&&!(a.isText||a.hasRequiredAttrs())&&(s=!1),r.indexOf(u)==-1&&r.push(u)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function J0(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function G0(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let s=t[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function Q0(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let s=t[i];s.validate&&s.validate(e[i])}}function Y0(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new vE(t,r,e[r]);return n}let Cp=class X0{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Y0(e,r.attrs),this.defaultAttrs=J0(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Sr.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:G0(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new In(this,this.computeAttrs(e),T.from(n),K.setFrom(r))}createChecked(e=null,n,r){return n=T.from(n),this.checkContent(n),new In(this,this.computeAttrs(e),n,K.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=T.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),s=i&&i.fillBefore(T.empty,!0);return s?new In(this,e,n.append(s),K.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Q0(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:K.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,o)=>r[s]=new X0(s,n,o));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function yE(t,e,n){let r=n.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${s}`)}}class vE{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?yE(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class ga{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=Y0(e,i.attrs),this.excluded=null;let s=J0(this.attrs);this.instance=s?new K(this,s):null}create(e=null){return!e&&this.instance?this.instance:new K(this,G0(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new ga(s,i++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){Q0(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Z0{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=Se.from(e.nodes),n.marks=Se.from(e.marks||{}),this.nodes=Cp.compile(this.spec.nodes,this),this.marks=ga.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=Sr.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?Ep(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:Ep(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Cp){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Dl(r,r.defaultAttrs,e,K.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return In.fromJSON(this,e)}markFromJSON(e){return K.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Ep(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],s=t.marks[i],o=s;if(s)n.push(s);else for(let l in t.marks){let a=t.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=a)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function wE(t){return t.tag!=null}function kE(t){return t.style!=null}class Rn{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(wE(i))this.tags.push(i);else if(kE(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let r=new Tp(this,n,!1);return r.addAll(e,K.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new Tp(this,n,!0);return r.addAll(e,K.none,n.from,n.to),N.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(bE(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,n,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(o.getAttrs){let a=o.getAttrs(n);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let n=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let l=n[o];if((l.priority==null?50:l.priority)<s)break}n.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Op(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Op(o)),o.node||o.ignore||o.mark||(o.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Rn(e,Rn.schemaRules(e)))}}const ev={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},xE={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},tv={ol:!0,ul:!0},zs=1,Vc=2,ms=4;function _p(t,e,n){return e!=null?(e?zs:0)|(e==="full"?Vc:0):t&&t.whitespace=="pre"?zs|Vc:n&~ms}class jo{constructor(e,n,r,i,s,o){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=K.none,this.match=s||(o&ms?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(T.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&zs)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let n=T.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(T.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!ev.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Tp{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,s,o=_p(null,n.preserveWhitespace,0)|(r?ms:0);i?s=new jo(i.type,i.attrs,K.none,!0,n.topMatch||i.type.contentMatch,o):r?s=new jo(null,null,K.none,!0,null,o):s=new jo(e.schema.topNodeType,null,K.none,!0,null,o),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,s=i.options&Vc?"full":this.localPreserveWS||(i.options&zs)>0;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(s)s!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;tv.hasOwnProperty(o)&&this.parser.normalizeLists&&SE(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(a?a.ignore:xE.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let u,c=this.needsBlock;if(ev.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),u=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let d=a&&a.skip?n:this.readStyles(e,n);d&&this.addAll(e,d),u&&this.sync(s),this.needsBlock=c}else{let u=this.readStyles(e,n);u&&this.addElementByRule(e,a,u,a.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=r.getPropertyValue(s);if(o)for(let l=void 0;;){let a=this.parser.matchStyle(s,o,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?n=n.filter(u=>!a.clearMark(u)):n=n.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return n}addElementByRule(e,n,r,i){let s,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let a=this.enter(o,n.attrs||null,r,n.preserveWhitespace);a&&(s=!0,r=a)}else{let a=this.parser.schema.marks[n.mark];r=r.concat(a.create(n.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r,!1));else{let a=e;typeof n.contentElement=="string"?a=e.querySelector(n.contentElement):typeof n.contentElement=="function"?a=n.contentElement(e):n.contentElement&&(a=n.contentElement),this.findAround(e,a,!0),this.addAll(a,r),this.findAround(e,a,!1)}s&&this.sync(l)&&this.open--}addAll(e,n,r,i){let s=r||0;for(let o=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];o!=l;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,n);this.findAtPoint(e,s)}findPlace(e,n,r){let i,s;for(let o=this.open,l=0;o>=0;o--){let a=this.nodes[o],u=a.findWrapping(e);if(u&&(!i||i.length>u.length+l)&&(i=u,s=a,!u.length))break;if(a.solid){if(r)break;l+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)n=this.enterInner(i[o],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let o=K.none;for(let l of i.concat(e.marks))(s.type?s.type.allowsMarkType(l.type):Np(l.type,e.type))&&(o=l.addToSet(o));return s.content.push(e.mark(o)),!0}return!1}enter(e,n,r,i){let s=this.findPlace(e.create(n),r,!1);return s&&(s=this.enterInner(e,n,r,!0,i)),s}enterInner(e,n,r,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=_p(e,s,o.options);o.options&ms&&o.content.length==0&&(l|=ms);let a=K.none;return r=r.filter(u=>(o.type?o.type.allowsMarkType(u.type):Np(u.type,e))?(a=u.addToSet(a),!1):!0),this.nodes.push(new jo(e,n,a,i,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=zs)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,a)=>{for(;l>=0;l--){let u=n[l];if(u==""){if(l==n.length-1||l==0)continue;for(;a>=s;a--)if(o(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=s?r.node(a-s).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;a--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function SE(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&tv.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function bE(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Op(t){let e={};for(let n in t)e[n]=t[n];return e}function Np(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let s=[],o=l=>{s.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||s.indexOf(c)<0&&o(c))return!0}};if(o(i.contentMatch))return!0}}class Ar{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=pu(n).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,a=0;for(;l<s.length&&a<o.marks.length;){let u=o.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(s[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<s.length;)i=s.pop()[1];for(;a<o.marks.length;){let u=o.marks[a++],c=this.serializeMark(u,o.isInline,n);c&&(s.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=tl(pu(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&tl(pu(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return tl(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ar(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=Mp(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return Mp(e.marks)}}function Mp(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function pu(t){return t.document||window.document}const Pp=new WeakMap;function CE(t){let e=Pp.get(t);return e===void 0&&Pp.set(t,e=EE(t)),e}function EE(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function tl(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=CE(r))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(n=i.slice(0,o),i=i.slice(o+1));let l,a=n?t.createElementNS(n,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let d in u)if(u[d]!=null){let f=d.indexOf(" ");f>0?a.setAttributeNS(d.slice(0,f),d.slice(f+1),u[d]):a.setAttribute(d,u[d])}}for(let d=c;d<e.length;d++){let f=e[d];if(f===0){if(d<e.length-1||d>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:h,contentDOM:p}=tl(t,f,n,r);if(a.appendChild(h),p){if(l)throw new RangeError("Multiple content holes");l=p}}}return{dom:a,contentDOM:l}}const nv=65535,rv=Math.pow(2,16);function _E(t,e){return t+e*rv}function Ap(t){return t&nv}function TE(t){return(t-(t&nv))/rv}const iv=1,sv=2,nl=4,ov=8;class Hc{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&ov)>0}get deletedBefore(){return(this.delInfo&(iv|nl))>0}get deletedAfter(){return(this.delInfo&(sv|nl))>0}get deletedAcross(){return(this.delInfo&nl)>0}}class nt{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&nt.empty)return nt.empty}recover(e){let n=0,r=Ap(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+TE(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+s],c=this.ranges[l+o],d=a+u;if(e<=d){let f=u?e==a?-1:e==d?1:n:n,h=a+i+(f<0?0:c);if(r)return h;let p=e==(n<0?a:d)?null:_E(l/3,e-a),m=e==a?sv:e==d?iv:nl;return(n<0?e!=a:e!=d)&&(m|=ov),new Hc(h,m,p)}i+=c-u}return r?e+i:new Hc(e+i,0,null)}touches(e,n){let r=0,i=Ap(n),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+s],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+o]-u}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),u=this.ranges[i+n],c=this.ranges[i+r];e(l,l+u,a,a+c),s+=c-u}}invert(){return new nt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?nt.empty:new nt(e<0?[0,-e,0]:[0,0,e])}}nt.empty=new nt([]);class Bs{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Bs(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Bs;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(e,n);if(l.recover!=null){let a=this.getMirror(s);if(a!=null&&a>s&&a<this.to){s=a,e=this._maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new Hc(e,i,null)}}const mu=Object.create(null);class je{getMap(){return nt.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=mu[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in mu)throw new RangeError("Duplicate use of step JSON ID "+e);return mu[e]=n,n.prototype.jsonID=e,n}}class ae{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new ae(e,null)}static fail(e){return new ae(null,e)}static fromReplace(e,n,r,i){try{return ae.ok(e.replace(n,r,i))}catch(s){if(s instanceof Al)return ae.fail(s.message);throw s}}}function df(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(df(s.content,e,s))),s.isInline&&(s=e(s,n,i)),r.push(s)}return T.fromArray(r)}class Sn extends je{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new N(df(n.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return ae.fromReplace(e,this.from,this.to,s)}invert(){return new jt(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Sn(n.pos,r.pos,this.mark)}merge(e){return e instanceof Sn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Sn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Sn(n.from,n.to,e.markFromJSON(n.mark))}}je.jsonID("addMark",Sn);class jt extends je{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new N(df(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return ae.fromReplace(e,this.from,this.to,r)}invert(){return new Sn(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new jt(n.pos,r.pos,this.mark)}merge(e){return e instanceof jt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new jt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new jt(n.from,n.to,e.markFromJSON(n.mark))}}je.jsonID("removeMark",jt);class bn extends je{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ae.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return ae.fromReplace(e,this.pos,this.pos+1,new N(T.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new bn(this.pos,n.marks[i]);return new bn(this.pos,this.mark)}}return new br(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new bn(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new bn(n.pos,e.markFromJSON(n.mark))}}je.jsonID("addNodeMark",bn);class br extends je{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return ae.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return ae.fromReplace(e,this.pos,this.pos+1,new N(T.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new bn(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new br(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new br(n.pos,e.markFromJSON(n.mark))}}je.jsonID("removeNodeMark",br);class ge extends je{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Wc(e,this.from,this.to)?ae.fail("Structure replace would overwrite content"):ae.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new nt([this.from,this.to-this.from,this.slice.size])}invert(e){return new ge(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new ge(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof ge)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?N.empty:new N(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ge(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?N.empty:new N(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ge(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ge(n.from,n.to,N.fromJSON(e,n.slice),!!n.structure)}}je.jsonID("replace",ge);class ve extends je{constructor(e,n,r,i,s,o,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(Wc(e,this.from,this.gapFrom)||Wc(e,this.gapTo,this.to)))return ae.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return ae.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?ae.fromReplace(e,this.from,this.to,r):ae.fail("Content does not fit in gap")}getMap(){return new nt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new ve(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||s>r.pos?null:new ve(n.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ve(n.from,n.to,n.gapFrom,n.gapTo,N.fromJSON(e,n.slice),n.insert,!!n.structure)}}je.jsonID("replaceAround",ve);function Wc(t,e,n){let r=t.resolve(e),i=n-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function OE(t,e,n,r){let i=[],s=[],o,l;t.doc.nodesBetween(e,n,(a,u,c)=>{if(!a.isInline)return;let d=a.marks;if(!r.isInSet(d)&&c.type.allowsMarkType(r.type)){let f=Math.max(u,e),h=Math.min(u+a.nodeSize,n),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(o&&o.to==f&&o.mark.eq(d[m])?o.to=h:i.push(o=new jt(f,h,d[m])));l&&l.to==f?l.to=h:s.push(l=new Sn(f,h,r))}}),i.forEach(a=>t.step(a)),s.forEach(a=>t.step(a))}function NE(t,e,n,r){let i=[],s=0;t.doc.nodesBetween(e,n,(o,l)=>{if(!o.isInline)return;s++;let a=null;if(r instanceof ga){let u=o.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(o.marks)&&(a=[r]):a=o.marks;if(a&&a.length){let u=Math.min(l+o.nodeSize,n);for(let c=0;c<a.length;c++){let d=a[c],f;for(let h=0;h<i.length;h++){let p=i[h];p.step==s-1&&d.eq(i[h].style)&&(f=p)}f?(f.to=u,f.step=s):i.push({style:d,from:Math.max(l,e),to:u,step:s})}}}),i.forEach(o=>t.step(new jt(o.from,o.to,o.style)))}function ff(t,e,n,r=n.contentMatch,i=!0){let s=t.doc.nodeAt(e),o=[],l=e+1;for(let a=0;a<s.childCount;a++){let u=s.child(a),c=l+u.nodeSize,d=r.matchType(u.type);if(!d)o.push(new ge(l,c,N.empty));else{r=d;for(let f=0;f<u.marks.length;f++)n.allowsMarkType(u.marks[f].type)||t.step(new jt(l,c,u.marks[f]));if(i&&u.isText&&n.whitespace!="pre"){let f,h=/\r?\n|\r/g,p;for(;f=h.exec(u.text);)p||(p=new N(T.from(n.schema.text(" ",n.allowedMarks(u.marks))),0,0)),o.push(new ge(l+f.index,l+f.index+f[0].length,p))}}l=c}if(!r.validEnd){let a=r.fillBefore(T.empty,!0);t.replace(l,l,new N(a,0,0))}for(let a=o.length-1;a>=0;a--)t.step(o[a])}function ME(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Pi(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),s=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(s,o,n))return r;if(r==0||i.type.spec.isolating||!ME(i,s,o))break}return null}function PE(t,e,n){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),l=i.after(s+1),a=o,u=l,c=T.empty,d=0;for(let p=s,m=!1;p>n;p--)m||r.index(p)>0?(m=!0,c=T.from(r.node(p).copy(c)),d++):a--;let f=T.empty,h=0;for(let p=s,m=!1;p>n;p--)m||i.after(p+1)<i.end(p)?(m=!0,f=T.from(i.node(p).copy(f)),h++):u++;t.step(new ve(a,u,o,l,new N(c.append(f),d,h),c.size-d,!0))}function hf(t,e,n=null,r=t){let i=AE(t,e),s=i&&IE(r,e);return s?i.map(Ip).concat({type:e,attrs:n}).concat(s.map(Ip)):null}function Ip(t){return{type:t,attrs:null}}function AE(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return n.canReplaceWith(r,i,o)?s:null}function IE(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(n.child(u).type);return!a||!a.validEnd?null:o}function RE(t,e,n){let r=T.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let l=n[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=T.from(n[o].type.create(n[o].attrs,r))}let i=e.start,s=e.end;t.step(new ve(i,s,i,s,new N(r,0,0),n.length,!0))}function DE(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(o,l)=>{let a=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,a)&&jE(t.doc,t.mapping.slice(s).map(l),r)){let u=null;if(r.schema.linebreakReplacement){let h=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);h&&!p?u=!1:!h&&p&&(u=!0)}u===!1&&av(t,o,l,s),ff(t,t.mapping.slice(s).map(l,1),r,void 0,u===null);let c=t.mapping.slice(s),d=c.map(l,1),f=c.map(l+o.nodeSize,1);return t.step(new ve(d,f,d+1,f-1,new N(T.from(r.create(a,null,o.marks)),0,0),1,!0)),u===!0&&lv(t,o,l,s),!1}})}function lv(t,e,n,r){e.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(i.text);){let a=t.mapping.slice(r).map(n+1+s+o.index);t.replaceWith(a,a+1,e.type.schema.linebreakReplacement.create())}}})}function av(t,e,n,r){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+s);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function jE(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function LE(t,e,n,r,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new ve(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new N(T.from(o),0,0),1,!0))}function Xt(t,e,n=1,r){let i=t.resolve(e),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=n-2;u>s;u--,c--){let d=i.node(u),f=i.index(u);if(d.type.spec.isolating)return!1;let h=d.content.cutByIndex(f,d.childCount),p=r&&r[c+1];p&&(h=h.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[c]||d;if(!d.canReplace(f+1,d.childCount)||!m.type.validContent(h))return!1}let l=i.indexAfter(s),a=r&&r[0];return i.node(s).canReplaceWith(l,l,a?a.type:i.node(s+1).type)}function $E(t,e,n=1,r){let i=t.doc.resolve(e),s=T.empty,o=T.empty;for(let l=i.depth,a=i.depth-n,u=n-1;l>a;l--,u--){s=T.from(i.node(l).copy(s));let c=r&&r[u];o=T.from(c?c.type.create(c.attrs,o):i.node(l).copy(o))}t.step(new ge(e,e,new N(s.append(o),n,n),!0))}function Wn(t,e){let n=t.resolve(e),r=n.index();return uv(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function zE(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),o=s.type==r?t.type.schema.nodes.text:s.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function uv(t,e){return!!(t&&e&&!t.isLeaf&&zE(t,e))}function ya(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let s,o,l=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):n>0?(s=r.node(i+1),l++,o=r.node(i).maybeChild(l)):(s=r.node(i).maybeChild(l-1),o=r.node(i+1)),s&&!s.isTextblock&&uv(s,o)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function BE(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,s=t.doc.resolve(e-n),o=s.node().type;if(i&&o.inlineContent){let c=o.whitespace=="pre",d=!!o.contentMatch.matchType(i);c&&!d?r=!1:!c&&d&&(r=!0)}let l=t.steps.length;if(r===!1){let c=t.doc.resolve(e+n);av(t,c.node(),c.before(),l)}o.inlineContent&&ff(t,e+n-1,o,s.node().contentMatchAt(s.index()),r==null);let a=t.mapping.slice(l),u=a.map(e-n);if(t.step(new ge(u,a.map(e+n,-1),N.empty,!0)),r===!0){let c=t.doc.resolve(u);lv(t,c.node(),c.before(),t.steps.length)}return t}function FE(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,n))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,n))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function cv(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,a=r.index(o)+(l>0?1:0),u=r.node(o),c=!1;if(s==1)c=u.canReplace(a,a,i);else{let d=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=d&&u.canReplaceWith(a,a,d[0])}if(c)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function va(t,e,n=e,r=N.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),s=t.resolve(n);return dv(i,s,r)?new ge(e,n,r):new UE(i,s,r).fit()}function dv(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class UE{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=T.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=T.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let a=new N(s,o,l);return e>-1?new ve(r.pos,e,this.$to.pos,this.$to.end(),a,n):a.size||r.pos!=this.$to.pos?new ge(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=n.firstChild;if(n.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}n=s.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=gu(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,d=null;if(n==1&&(o?u.matchType(o.type)||(d=u.fillBefore(T.from(o),!1)):s&&a.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:d};if(n==2&&o&&(c=u.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:c};if(s&&u.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=gu(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new N(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=gu(e,n);if(i.childCount<=1&&n>0){let s=e.size-n<=n+i.size;this.unplaced=new N(Yi(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new N(Yi(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,l=r?r.content:o.content,a=o.openStart-e,u=0,c=[],{match:d,type:f}=this.frontier[n];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));d=d.matchFragment(i)}let h=l.size+e-(o.content.size-o.openEnd);for(;u<l.childCount;){let m=l.child(u),y=d.matchType(m.type);if(!y)break;u++,(u>1||a==0||m.content.size)&&(d=y,c.push(fv(m.mark(f.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?h:-1)))}let p=u==l.childCount;p||(h=-1),this.placed=Xi(this.placed,n,T.from(c)),this.frontier[n].match=d,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,y=l;m<h;m++){let g=y.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),y=g.content}this.unplaced=p?e==0?N.empty:new N(Yi(o.content,e-1,1),e-1,h<0?o.openEnd:e-1):new N(Yi(o.content,e,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!yu(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=yu(e,n,i,r,s);if(o){for(let l=n-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=yu(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:n,fit:o,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Xi(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Xi(this.placed,this.depth,T.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(T.empty,!0);n.childCount&&(this.placed=Xi(this.placed,this.frontier.length,n))}}function Yi(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Yi(t.firstChild.content,e-1,n)))}function Xi(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Xi(t.lastChild.content,e-1,n)))}function gu(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function fv(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,fv(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(T.empty,!0)))),t.copy(r)}function yu(t,e,n,r,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!VE(n,s.content,o)?l:null}function VE(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function HE(t){return t.spec.defining||t.spec.definingForContent}function WE(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),s=t.doc.resolve(n);if(dv(i,s,r))return t.step(new ge(e,n,r));let o=pv(i,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let f=i.depth,h=i.pos-1;f>0;f--,h--){let p=i.node(f).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(f)>-1?l=f:i.before(f)==h&&o.splice(1,0,-f)}let a=o.indexOf(l),u=[],c=r.openStart;for(let f=r.content,h=0;;h++){let p=f.firstChild;if(u.push(p),h==r.openStart)break;f=p.content}for(let f=c-1;f>=0;f--){let h=u[f],p=HE(h.type);if(p&&!h.sameMarkup(i.node(Math.abs(l)-1)))c=f;else if(p||!h.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let h=(f+c+1)%(r.openStart+1),p=u[h];if(p)for(let m=0;m<o.length;m++){let y=o[(m+a)%o.length],g=!0;y<0&&(g=!1,y=-y);let v=i.node(y-1),w=i.index(y-1);if(v.canReplaceWith(w,w,p.type,p.marks))return t.replace(i.before(y),g?s.after(y):n,new N(hv(r.content,0,r.openStart,h),h,r.openEnd))}}let d=t.steps.length;for(let f=o.length-1;f>=0&&(t.replace(e,n,r),!(t.steps.length>d));f--){let h=o[f];h<0||(e=i.before(h),n=s.after(h))}}function hv(t,e,n,r,i){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(hv(s.content,e+1,n,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(t).append(t);t=o.append(s.matchFragment(o).fillBefore(T.empty,!0))}return t}function qE(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=FE(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new N(T.from(r),0,0))}function KE(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),s=pv(r,i);for(let o=0;o<s.length;o++){let l=s[o],a=o==s.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return t.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function pv(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&n.push(i)}return n}class ui extends je{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return ae.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return ae.fromReplace(e,this.pos,this.pos+1,new N(T.from(i),0,n.isLeaf?0:1))}getMap(){return nt.empty}invert(e){return new ui(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new ui(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ui(n.pos,n.attr,n.value)}}je.jsonID("attr",ui);class Fs extends je{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return ae.ok(r)}getMap(){return nt.empty}invert(e){return new Fs(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Fs(n.attr,n.value)}}je.jsonID("docAttr",Fs);let ki=class extends Error{};ki=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};ki.prototype=Object.create(Error.prototype);ki.prototype.constructor=ki;ki.prototype.name="TransformError";class JE{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Bs}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new ki(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=N.empty){let i=va(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new N(T.from(r),0,0))}delete(e,n){return this.replace(e,n,N.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return WE(this,e,n,r),this}replaceRangeWith(e,n,r){return qE(this,e,n,r),this}deleteRange(e,n){return KE(this,e,n),this}lift(e,n){return PE(this,e,n),this}join(e,n=1){return BE(this,e,n),this}wrap(e,n){return RE(this,e,n),this}setBlockType(e,n=e,r,i=null){return DE(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return LE(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new ui(e,n,r)),this}setDocAttribute(e,n){return this.step(new Fs(e,n)),this}addNodeMark(e,n){return this.step(new bn(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof K)n.isInSet(r.marks)&&this.step(new br(e,n));else{let i=r.marks,s,o=[];for(;s=n.isInSet(i);)o.push(new br(e,s)),i=s.removeFromSet(i);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,n=1,r){return $E(this,e,n,r),this}addMark(e,n,r){return OE(this,e,n,r),this}removeMark(e,n,r){return NE(this,e,n,r),this}clearIncompatible(e,n,r){return ff(this,e,n,r),this}}const vu=Object.create(null);class z{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new GE(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=N.empty){let r=n.content.lastChild,i=null;for(let l=0;l<n.openEnd;l++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:u}=o[l],c=e.mapping.slice(s);e.replaceRange(c.map(a.pos),c.map(u.pos),l?N.empty:n),l==0&&jp(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],a=e.mapping.slice(r),u=a.map(o.pos),c=a.map(l.pos);s?e.deleteRange(u,c):(e.replaceRangeWith(u,c,n),jp(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new j(e):Fr(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=n<0?Fr(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):Fr(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new ot(e.node(0))}static atStart(e){return Fr(e,e,0,0,1)||new ot(e)}static atEnd(e){return Fr(e,e,e.content.size,e.childCount,-1)||new ot(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=vu[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in vu)throw new RangeError("Duplicate use of selection JSON ID "+e);return vu[e]=n,n.prototype.jsonID=e,n}getBookmark(){return j.between(this.$anchor,this.$head).getBookmark()}}z.prototype.visible=!0;class GE{constructor(e,n){this.$from=e,this.$to=n}}let Rp=!1;function Dp(t){!Rp&&!t.parent.inlineContent&&(Rp=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class j extends z{constructor(e,n=e){Dp(e),Dp(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return z.near(r);let i=e.resolve(n.map(this.anchor));return new j(i.parent.inlineContent?i:r,r)}replace(e,n=N.empty){if(super.replace(e,n),n==N.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof j&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new wa(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new j(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let s=z.findFrom(n,r,!0)||z.findFrom(n,-r,!0);if(s)n=s.$head;else return z.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(z.findFrom(e,-r,!0)||z.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new j(e,n)}}z.jsonID("text",j);class wa{constructor(e,n){this.anchor=e,this.head=n}map(e){return new wa(e.map(this.anchor),e.map(this.head))}resolve(e){return j.between(e.resolve(this.anchor),e.resolve(this.head))}}class I extends z{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),s=e.resolve(i);return r?z.near(s):new I(s)}content(){return new N(T.from(this.node),0,0)}eq(e){return e instanceof I&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new pf(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new I(e.resolve(n.anchor))}static create(e,n){return new I(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}I.prototype.visible=!1;z.jsonID("node",I);class pf{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new wa(r,r):new pf(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&I.isSelectable(r)?new I(n):z.near(n)}}class ot extends z{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=N.empty){if(n==N.empty){e.delete(0,e.doc.content.size);let r=z.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new ot(e)}map(e){return new ot(e)}eq(e){return e instanceof ot}getBookmark(){return QE}}z.jsonID("all",ot);const QE={map(){return this},resolve(t){return new ot(t)}};function Fr(t,e,n,r,i,s=!1){if(e.inlineContent)return j.create(t,n);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&I.isSelectable(l))return I.create(t,n-(i<0?l.nodeSize:0))}else{let a=Fr(t,l,n+i,i<0?l.childCount:0,i,s);if(a)return a}n+=l.nodeSize*i}return null}function jp(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof ge||i instanceof ve))return;let s=t.mapping.maps[r],o;s.forEach((l,a,u,c)=>{o==null&&(o=c)}),t.setSelection(z.near(t.doc.resolve(o),n))}const Lp=1,Lo=2,$p=4;class YE extends JE{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Lp)&~Lo,this.storedMarks=null,this}get selectionSet(){return(this.updated&Lp)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Lo,this}ensureMarks(e){return K.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Lo)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Lo,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||K.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(n);s=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,s)),this.selection.empty||this.setSelection(z.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=$p,this}get scrolledIntoView(){return(this.updated&$p)>0}}function zp(t,e){return!e||!t?t:t.bind(e)}class Zi{constructor(e,n,r){this.name=e,this.init=zp(n.init,r),this.apply=zp(n.apply,r)}}const XE=[new Zi("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Zi("selection",{init(t,e){return t.selection||z.atStart(e.doc)},apply(t){return t.selection}}),new Zi("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Zi("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class wu{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=XE.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Zi(r.key,r.spec.state,r))})}}class ti{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let a=i?i[o].n:0,u=i?i[o].state:this,c=a<n.length&&l.spec.appendTransaction.call(l,a?n.slice(a):n,u,r);if(c&&r.filterTransaction(c,o)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),s=!0}i&&(i[o]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new ti(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new YE(this)}static create(e){let n=new wu(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ti(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new wu(this.schema,e.plugins),r=n.fields,i=new ti(n);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new wu(e.schema,e.plugins),s=new ti(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=In.fromJSON(e.schema,n.doc);else if(o.name=="selection")s.selection=z.fromJSON(s.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==o.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){s[o.name]=u.fromJSON.call(a,e,n[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function mv(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=mv(i,e,{})),n[r]=i}return n}class He{constructor(e){this.spec=e,this.props={},e.props&&mv(e.props,this,this.props),this.key=e.key?e.key.key:gv("plugin")}getState(e){return e[this.key]}}const ku=Object.create(null);function gv(t){return t in ku?t+"$"+ ++ku[t]:(ku[t]=0,t+"$")}class Pt{constructor(e="key"){this.key=gv(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const be=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},xi=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let qc=null;const qt=function(t,e,n){let r=qc||(qc=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},ZE=function(){qc=null},Cr=function(t,e,n,r){return n&&(Bp(t,e,n,r,-1)||Bp(t,e,n,r,1))},e_=/^(img|br|input|textarea|hr)$/i;function Bp(t,e,n,r,i){for(var s;;){if(t==n&&e==r)return!0;if(e==(i<0?0:ht(t))){let o=t.parentNode;if(!o||o.nodeType!=1||so(t)||e_.test(t.nodeName)||t.contentEditable=="false")return!1;e=be(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=i;else return!1;else t=o,e=i<0?ht(t):0}else return!1}}function ht(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function t_(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=ht(t)}else if(t.parentNode&&!so(t))e=be(t),t=t.parentNode;else return null}}function n_(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!so(t))e=be(t)+1,t=t.parentNode;else return null}}function r_(t,e,n){for(let r=e==0,i=e==ht(t);r||i;){if(t==n)return!0;let s=be(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,i=i&&s==ht(t)}}function so(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const ka=function(t){return t.focusNode&&Cr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function tr(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function i_(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function s_(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(ht(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(ht(r.startContainer),r.startOffset)}}}const zt=typeof navigator<"u"?navigator:null,Fp=typeof document<"u"?document:null,qn=zt&&zt.userAgent||"",Kc=/Edge\/(\d+)/.exec(qn),yv=/MSIE \d/.exec(qn),Jc=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(qn),Xe=!!(yv||Jc||Kc),Dn=yv?document.documentMode:Jc?+Jc[1]:Kc?+Kc[1]:0,Mt=!Xe&&/gecko\/(\d+)/i.test(qn);Mt&&+(/Firefox\/(\d+)/.exec(qn)||[0,0])[1];const Gc=!Xe&&/Chrome\/(\d+)/.exec(qn),Ae=!!Gc,vv=Gc?+Gc[1]:0,ze=!Xe&&!!zt&&/Apple Computer/.test(zt.vendor),Si=ze&&(/Mobile\/\w+/.test(qn)||!!zt&&zt.maxTouchPoints>2),ct=Si||(zt?/Mac/.test(zt.platform):!1),o_=zt?/Win/.test(zt.platform):!1,Qt=/Android \d/.test(qn),oo=!!Fp&&"webkitFontSmoothing"in Fp.documentElement.style,l_=oo?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function a_(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Ut(t,e){return typeof t=="number"?t:t[e]}function u_(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function Up(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=n||t.dom;o;){if(o.nodeType!=1){o=xi(o);continue}let l=o,a=l==s.body,u=a?a_(s):u_(l),c=0,d=0;if(e.top<u.top+Ut(r,"top")?d=-(u.top-e.top+Ut(i,"top")):e.bottom>u.bottom-Ut(r,"bottom")&&(d=e.bottom-e.top>u.bottom-u.top?e.top+Ut(i,"top")-u.top:e.bottom-u.bottom+Ut(i,"bottom")),e.left<u.left+Ut(r,"left")?c=-(u.left-e.left+Ut(i,"left")):e.right>u.right-Ut(r,"right")&&(c=e.right-u.right+Ut(i,"right")),c||d)if(a)s.defaultView.scrollBy(c,d);else{let h=l.scrollLeft,p=l.scrollTop;d&&(l.scrollTop+=d),c&&(l.scrollLeft+=c);let m=l.scrollLeft-h,y=l.scrollTop-p;e={left:e.left-m,top:e.top-y,right:e.right-m,bottom:e.bottom-y}}let f=a?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(f))break;o=f=="absolute"?o.offsetParent:xi(o)}}function c_(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=t.root.elementFromPoint(s,o);if(!l||l==t.dom||!t.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=n-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:wv(t.dom)}}function wv(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=xi(r));return e}function d_({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;kv(n,r==0?0:r-e)}function kv(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:s}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let $r=null;function f_(t){if(t.setActive)return t.setActive();if($r)return t.focus($r);let e=wv(t);t.focus($r==null?{get preventScroll(){return $r={preventScroll:!0},!0}}:void 0),$r||($r=!1,kv(e,0))}function xv(t,e){let n,r=2e8,i,s=0,o=e.top,l=e.top,a,u;for(let c=t.firstChild,d=0;c;c=c.nextSibling,d++){let f;if(c.nodeType==1)f=c.getClientRects();else if(c.nodeType==3)f=qt(c).getClientRects();else continue;for(let h=0;h<f.length;h++){let p=f[h];if(p.top<=o&&p.bottom>=l){o=Math.max(p.bottom,o),l=Math.min(p.top,l);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){n=c,r=m,i=m&&n.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,c.nodeType==1&&m&&(s=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!a&&p.left<=e.left&&p.right>=e.left&&(a=c,u={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(s=d+1)}}return!n&&a&&(n=a,i=u,r=0),n&&n.nodeType==3?h_(n,i):!n||r&&n.nodeType==1?{node:t,offset:s}:xv(n,i)}function h_(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let s=un(r,1);if(s.top!=s.bottom&&mf(e,s))return{node:t,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function mf(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function p_(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function m_(t,e,n){let{node:r,offset:i}=xv(e,n),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,i,s)}function g_(t,e,n,r){let i=-1;for(let s=e,o=!1;s!=t.dom;){let l=t.docView.nearestDesc(s,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&(!o&&a.left>r.left||a.top>r.top?i=l.posBefore:(!o&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),o=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function Sv(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=i;;){let o=t.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(mf(e,u))return Sv(o,e,u)}}if((s=(s+1)%r)==i)break}return t}function y_(t,e){let n=t.dom.ownerDocument,r,i=0,s=s_(n,e.left,e.top);s&&({node:r,offset:i}=s);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let u=t.dom.getBoundingClientRect();if(!mf(e,u)||(o=Sv(t.dom,e,u),!o))return null}if(ze)for(let u=o;r&&u;u=xi(u))u.draggable&&(r=void 0);if(o=p_(o,e),r){if(Mt&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],d;c.nodeName=="IMG"&&(d=c.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let u;oo&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=g_(t,r,i,e))}l==null&&(l=m_(t,o,e));let a=t.docView.nearestDesc(o,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function Vp(t){return t.top<t.bottom||t.left<t.right}function un(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(Vp(r))return r}return Array.prototype.find.call(n,Vp)||t.getBoundingClientRect()}const v_=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function bv(t,e,n){let{node:r,offset:i,atom:s}=t.docView.domFromPos(e,n<0?-1:1),o=oo||Mt;if(r.nodeType==3)if(o&&(v_.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let a=un(qt(r,i,i),n);if(Mt&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=un(qt(r,i-1,i-1),-1);if(u.top==a.top){let c=un(qt(r,i,i+1),-1);if(c.top!=a.top)return Wi(c,c.left<u.left)}}return a}else{let a=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==r.nodeValue.length?(a--,c=1):n<0?a--:u++,Wi(un(qt(r,a,u),c),c<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(n<0||i==ht(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return xu(a.getBoundingClientRect(),!1)}if(s==null&&i<ht(r)){let a=r.childNodes[i];if(a.nodeType==1)return xu(a.getBoundingClientRect(),!0)}return xu(r.getBoundingClientRect(),n>=0)}if(s==null&&i&&(n<0||i==ht(r))){let a=r.childNodes[i-1],u=a.nodeType==3?qt(a,ht(a)-(o?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return Wi(un(u,1),!1)}if(s==null&&i<ht(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?qt(a,0,o?0:1):a.nodeType==1?a:null:null;if(u)return Wi(un(u,-1),!0)}return Wi(un(r.nodeType==3?qt(r):r,-n),n>=0)}function Wi(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function xu(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Cv(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function w_(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return Cv(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=bv(t,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=qt(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(n=="up"?o.top-c.top>(c.bottom-o.top)*2:c.bottom-o.bottom>(o.bottom-c.top)*2))return!1}}return!0})}const k_=/[\u0590-\u08ac]/;function x_(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=t.domSelection();return l?!k_.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?s:o:Cv(t,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:d}=t.domSelectionRange(),f=l.caretBidiLevel;l.modify("move",n,"character");let h=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:p,focusOffset:m}=t.domSelectionRange(),y=p&&!h.contains(p.nodeType==1?p:p.parentNode)||a==p&&u==m;try{l.collapse(c,d),a&&(a!=c||u!=d)&&l.extend&&l.extend(a,u)}catch{}return f!=null&&(l.caretBidiLevel=f),y}):r.pos==r.start()||r.pos==r.end()}let Hp=null,Wp=null,qp=!1;function S_(t,e,n){return Hp==e&&Wp==n?qp:(Hp=e,Wp=n,qp=n=="up"||n=="down"?w_(t,e,n):x_(t,e,n))}const gt=0,Kp=1,or=2,Bt=3;class lo{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=gt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>be(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!n||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let l=i.children[o];if(l.size){i=l;break}}return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>e||o instanceof _v){i=e-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof Ev&&s.side>=0;r--);if(n<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&n&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?be(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?be(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let a=this.children[l],u=o+a.size;if(i==-1&&e<=u){let c=o+a.border;if(e>=c&&n<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,n,c);e=o;for(let d=l;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){i=be(f.dom)+1;break}e-=f.size}i==-1&&(i=0)}if(i>-1&&(u>n||l==this.children.length-1)){n=u;for(let c=l+1;c<this.children.length;c++){let d=this.children[c];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=be(d.dom);break}n+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=u}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let s=Math.min(e,n),o=Math.max(e,n);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],y=p+m.size;if(s>p&&o<y)return m.setSelection(e-p-m.border,n-p-m.border,r,i);p=y}let l=this.domFromPos(e,e?-1:1),a=n==e?l:this.domFromPos(n,n?-1:1),u=r.root.getSelection(),c=r.domSelectionRange(),d=!1;if((Mt||ze)&&e==n){let{node:h,offset:p}=l;if(h.nodeType==3){if(d=!!(p&&h.nodeValue[p-1]==`
`),d&&p==h.nodeValue.length)for(let m=h,y;m;m=m.parentNode){if(y=m.nextSibling){y.nodeName=="BR"&&(l=a={node:y.parentNode,offset:be(y)+1});break}let g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let m=h.childNodes[p-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Mt&&c.focusNode&&c.focusNode!=a.node&&c.focusNode.nodeType==1){let h=c.focusNode.childNodes[c.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||d&&ze)&&Cr(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Cr(a.node,a.offset,c.focusNode,c.focusOffset))return;let f=!1;if((u.extend||e==n)&&!d){u.collapse(l.node,l.offset);try{e!=n&&u.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>n){let p=l;l=a,a=p}let h=document.createRange();h.setEnd(a.node,a.offset),h.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let l=r+s.border,a=o-s.border;if(e>=l&&n<=a){this.dirty=e==r||n==o?or:Kp,e==l&&n==a&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Bt:s.markDirty(e-l,n-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?or:Bt}r=o}this.dirty=or}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?or:Kp;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Ev extends lo{constructor(e,n,r,i){let s,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==gt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class b_ extends lo{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Er extends lo{constructor(e,n,r,i,s){super(e,[],r,i),this.mark=n,this.spec=s}static create(e,n,r,i){let s=i.nodeViews[n.type.name],o=s&&s(n,i,r);return(!o||!o.dom)&&(o=Ar.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Er(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Bt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Bt&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=gt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=gt}}slice(e,n,r){let i=Er.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;n<o&&(s=Yc(s,n,o,r)),e>0&&(s=Yc(s,0,e,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class jn extends lo{constructor(e,n,r,i,s,o,l,a,u){super(e,[],s,o),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,n,r,i,s,o){let l=s.nodeViews[n.type.name],a,u=l&&l(n,s,()=>{if(!a)return o;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,d=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:d}=Ar.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!d&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let f=c;return c=Nv(c,r,n),u?a=new C_(e,n,r,i,c,d||null,f,u,s,o+1):n.isText?new xa(e,n,r,i,c,f,s):new jn(e,n,r,i,c,d||null,f,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>T.empty)}return e}matchesNode(e,n,r){return this.dirty==gt&&e.eq(this.node)&&jl(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,s=e.composing?this.localCompositionInfo(e,n):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,a=new __(this,o&&o.node,e);N_(this.node,this.innerDeco,(u,c,d)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!d&&a.syncToMarks(c==this.node.childCount?K.none:this.node.child(c).marks,r,e),a.placeWidget(u,e,i)},(u,c,d,f)=>{a.syncToMarks(u.marks,r,e);let h;a.findNodeMatch(u,c,d,f)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(h=a.findIndexWithChild(s.node))>-1&&a.updateNodeAt(u,c,d,h,e)||a.updateNextNode(u,c,d,e,f,i)||a.addNode(u,c,d,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==or)&&(o&&this.protectLocalComposition(e,o),Tv(this.contentDOM,this.children,e),Si&&M_(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof j)||r<n||i>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=P_(this.node.content,o,r-n,i-n);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new b_(this,s,n,i);e.input.compositionNodes.push(o),this.children=Yc(this.children,r,r+i.length,e,o)}update(e,n,r,i){return this.dirty==Bt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=gt}updateOuterDeco(e){if(jl(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Ov(this.dom,this.nodeDOM,Qc(this.outerDeco,this.node,n),Qc(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Jp(t,e,n,r,i){Nv(r,e,t);let s=new jn(void 0,t,e,n,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class xa extends jn{constructor(e,n,r,i,s,o,l){super(e,n,r,i,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Bt||this.dirty!=gt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=gt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=gt,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),s=document.createTextNode(i.text);return new xa(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Bt)}get domAtom(){return!1}isText(e){return this.node.text==e}}class _v extends lo{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==gt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class C_ extends jn{constructor(e,n,r,i,s,o,l,a,u,c){super(e,n,r,i,s,o,l,u,c),this.spec=a}update(e,n,r,i){if(this.dirty==Bt)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Tv(t,e,n){let r=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==t){for(;l!=r;)r=Gp(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(l,r);if(o instanceof Er){let a=r?r.previousSibling:t.lastChild;Tv(o.contentDOM,o.children,n),r=a?a.nextSibling:t.firstChild}}for(;r;)r=Gp(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const gs=function(t){t&&(this.nodeName=t)};gs.prototype=Object.create(null);const lr=[new gs];function Qc(t,e,n){if(t.length==0)return lr;let r=n?lr[0]:new gs,i=[r];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(o){o.nodeName&&i.push(r=new gs(o.nodeName));for(let l in o){let a=o[l];a!=null&&(n&&i.length==1&&i.push(r=new gs(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function Ov(t,e,n,r){if(n==lr&&r==lr)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],l=n[s];if(s){let a;l&&l.nodeName==o.nodeName&&i!=t&&(a=i.parentNode)&&a.nodeName.toLowerCase()==o.nodeName||(a=document.createElement(o.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=lr[0]),i=a}E_(i,l||lr[0],o)}return i}function E_(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&t.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&t.classList.add(i[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function Nv(t,e,n){return Ov(t,t,lr,Qc(e,n,t.nodeType!=1))}function jl(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Gp(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class __{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=T_(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=gt,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let u=this.top.children[a];if(u.matchesMark(e[s])&&!this.isLocked(u.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=Er.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,n,r)&&!this.preMatch.matched.has(u)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,r,i,s){let o=this.top.children[i];return o.dirty==Bt&&o.dom==o.contentDOM&&(o.dirty=or),o.update(e,n,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof jn){let u=this.preMatch.matched.get(a);if(u!=null&&u!=s)return!1;let c=a.dom,d,f=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Bt&&jl(n,a.outerDeco));if(!f&&a.update(e,n,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(a,e,n,r,i,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=or,d.updateChildren(i,o+1),d.dirty=gt),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,s,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!jl(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=jn.create(this.top,n,r,i,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,n,r,i,s){let o=jn.create(this.top,e,n,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new Ev(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Er;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof xa)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((ze||Ae)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new _v(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function T_(t,e){let n=e,r=n.children.length,i=t.childCount,s=new Map,o=[];e:for(;i>0;){let l;for(;;)if(r){let u=n.children[r-1];if(u instanceof Er)n=u,r=u.children.length;else{l=u,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let a=l.node;if(a){if(a!=t.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function O_(t,e){return t.type.side-e.type.side}function N_(t,e,n,r){let i=e.locals(t),s=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);r(c,i,e.forChild(s,c),u),s+=c.nodeSize}return}let o=0,l=[],a=null;for(let u=0;;){let c,d;for(;o<i.length&&i[o].to==s;){let y=i[o++];y.widget&&(c?(d||(d=[c])).push(y):c=y)}if(c)if(d){d.sort(O_);for(let y=0;y<d.length;y++)n(d[y],u,!!a)}else n(c,u,!!a);let f,h;if(a)h=-1,f=a,a=null;else if(u<t.childCount)h=u,f=t.child(u++);else break;for(let y=0;y<l.length;y++)l[y].to<=s&&l.splice(y--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let p=s+f.nodeSize;if(f.isText){let y=p;o<i.length&&i[o].from<y&&(y=i[o].from);for(let g=0;g<l.length;g++)l[g].to<y&&(y=l[g].to);y<p&&(a=f.cut(y-s),f=f.cut(0,y-s),p=y,h=-1)}else for(;o<i.length&&i[o].to<p;)o++;let m=f.isInline&&!f.isLeaf?l.filter(y=>!y.inline):l.slice();r(f,m,e.forChild(s,f),h),s=p}}function M_(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function P_(t,e,n,r){for(let i=0,s=0;i<t.childCount&&s<=r;){let o=t.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let a=o.text;for(;i<t.childCount;){let u=t.child(i++);if(s+=u.nodeSize,!u.isText)break;a+=u.text}if(s>=n){if(s>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=n)return l+u;if(n==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function Yc(t,e,n,r,i){let s=[];for(let o=0,l=0;o<t.length;o++){let a=t[o],u=l,c=l+=a.size;u>=n||c<=e?s.push(a):(u<e&&s.push(a.slice(0,e-u,r)),i&&(s.push(i),i=void 0),c>n&&s.push(a.slice(n-u,a.size,r)))}return s}function gf(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),s=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l=r.resolve(o),a,u;if(ka(n)){for(a=o;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&I.isSelectable(d)&&i.parent&&!(d.isInline&&r_(n.focusNode,n.focusOffset,i.dom))){let f=i.posBefore;u=new I(o==f?l:r.resolve(f))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let d=o,f=o;for(let h=0;h<n.rangeCount;h++){let p=n.getRangeAt(h);d=Math.min(d,t.docView.posFromDOM(p.startContainer,p.startOffset,1)),f=Math.max(f,t.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[a,o]=f==t.state.selection.anchor?[f,d]:[d,f],l=r.resolve(o)}else a=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let c=r.resolve(a);if(!u){let d=e=="pointer"||t.state.selection.head<l.pos&&!s?1:-1;u=yf(t,c,l,d)}return u}function Mv(t){return t.editable?t.hasFocus():Av(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Zt(t,e=!1){let n=t.state.selection;if(Pv(t,n),!!Mv(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Ae){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Cr(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)I_(t);else{let{anchor:r,head:i}=n,s,o;Qp&&!(n instanceof j)&&(n.$from.parent.inlineContent||(s=Yp(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=Yp(t,n.to))),t.docView.setSelection(r,i,t,e),Qp&&(s&&Xp(s),o&&Xp(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&A_(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Qp=ze||Ae&&vv<63;function Yp(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(ze&&i&&i.contentEditable=="false")return Su(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Su(i);if(s)return Su(s)}}function Su(t){return t.contentEditable="true",ze&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Xp(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function A_(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!Mv(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function I_(t){let e=t.domSelection(),n=document.createRange();if(!e)return;let r=t.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setStart(r.parentNode,be(r)+1):n.setStart(r,0),n.collapse(!0),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&Xe&&Dn<=11&&(r.disabled=!0,r.disabled=!1)}function Pv(t,e){if(e instanceof I){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Zp(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Zp(t)}function Zp(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function yf(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||j.between(e,n,r)}function em(t){return t.editable&&!t.hasFocus()?!1:Av(t)}function Av(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function R_(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Cr(e.node,e.offset,n.anchorNode,n.anchorOffset)}function Xc(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&z.findFrom(s,e)}function hn(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function tm(t,e,n){let r=t.state.selection;if(r instanceof j)if(n.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return hn(t,new j(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=Xc(t.state,e);return i&&i instanceof I?hn(t,i):!1}else if(!(ct&&n.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=t.docView.descAt(l))&&!o.contentDOM?I.isSelectable(s)?hn(t,new I(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):oo?hn(t,new j(t.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof I&&r.node.isInline)return hn(t,new j(e>0?r.$to:r.$from));{let i=Xc(t.state,e);return i?hn(t,i):!1}}}function Ll(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ys(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function zr(t,e){return e<0?D_(t):j_(t)}function D_(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,s,o=!1;for(Mt&&n.nodeType==1&&r<Ll(n)&&ys(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(ys(l,-1))i=n,s=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(Iv(n))break;{let l=n.previousSibling;for(;l&&ys(l,-1);)i=n.parentNode,s=be(l),l=l.previousSibling;if(l)n=l,r=Ll(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?Zc(t,n,r):i&&Zc(t,i,s)}function j_(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Ll(n),s,o;for(;;)if(r<i){if(n.nodeType!=1)break;let l=n.childNodes[r];if(ys(l,1))s=n,o=++r;else break}else{if(Iv(n))break;{let l=n.nextSibling;for(;l&&ys(l,1);)s=l.parentNode,o=be(l)+1,l=l.nextSibling;if(l)n=l,r=0,i=Ll(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}s&&Zc(t,s,o)}function Iv(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function L_(t,e){for(;t&&e==t.childNodes.length&&!so(t);)e=be(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function $_(t,e){for(;t&&!e&&!so(t);)e=be(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function Zc(t,e,n){if(e.nodeType!=3){let s,o;(o=L_(e,n))?(e=o,n=0):(s=$_(e,n))&&(e=s,n=s.nodeValue.length)}let r=t.domSelection();if(!r)return;if(ka(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Zt(t)},50)}function nm(t,e){let n=t.state.doc.resolve(e);if(!(Ae||o_)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function rm(t,e,n){let r=t.state.selection;if(r instanceof j&&!r.empty||n.indexOf("s")>-1||ct&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=Xc(t.state,e);if(o&&o instanceof I)return hn(t,o)}if(!i.parent.inlineContent){let o=e<0?i:s,l=r instanceof ot?z.near(o,e):z.findFrom(o,e);return l?hn(t,l):!1}return!1}function im(t,e){if(!(t.state.selection instanceof j))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let o=t.state.tr;return e<0?o.delete(n.pos-s.nodeSize,n.pos):o.delete(n.pos,n.pos+s.nodeSize),t.dispatch(o),!0}return!1}function sm(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function z_(t){if(!ze||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;sm(t,r,"true"),setTimeout(()=>sm(t,r,"false"),20)}return!1}function B_(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function F_(t,e){let n=e.keyCode,r=B_(e);if(n==8||ct&&n==72&&r=="c")return im(t,-1)||zr(t,-1);if(n==46&&!e.shiftKey||ct&&n==68&&r=="c")return im(t,1)||zr(t,1);if(n==13||n==27)return!0;if(n==37||ct&&n==66&&r=="c"){let i=n==37?nm(t,t.state.selection.from)=="ltr"?-1:1:-1;return tm(t,i,r)||zr(t,i)}else if(n==39||ct&&n==70&&r=="c"){let i=n==39?nm(t,t.state.selection.from)=="ltr"?1:-1:1;return tm(t,i,r)||zr(t,i)}else{if(n==38||ct&&n==80&&r=="c")return rm(t,-1,r)||zr(t,-1);if(n==40||ct&&n==78&&r=="c")return z_(t)||rm(t,1,r)||zr(t,1);if(r==(ct?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function vf(t,e){t.someProp("transformCopied",h=>{e=h(e,t)});let n=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let h=r.firstChild;n.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let o=t.someProp("clipboardSerializer")||Ar.fromSchema(t.state.schema),l=zv(),a=l.createElement("div");a.appendChild(o.serializeFragment(r,{document:l}));let u=a.firstChild,c,d=0;for(;u&&u.nodeType==1&&(c=$v[u.nodeName.toLowerCase()]);){for(let h=c.length-1;h>=0;h--){let p=l.createElement(c[h]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),d++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(n)}`);let f=t.someProp("clipboardTextSerializer",h=>h(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:f,slice:e}}function Rv(t,e,n,r,i){let s=i.parent.type.spec.code,o,l;if(!n&&!e)return null;let a=e&&(r||s||!n);if(a){if(t.someProp("transformPastedText",f=>{e=f(e,s||r,t)}),s)return e?new N(T.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):N.empty;let d=t.someProp("clipboardTextParser",f=>f(e,i,r,t));if(d)l=d;else{let f=i.marks(),{schema:h}=t.state,p=Ar.fromSchema(h);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let y=o.appendChild(document.createElement("p"));m&&y.appendChild(p.serializeNode(h.text(m,f)))})}}else t.someProp("transformPastedHTML",d=>{n=d(n,t)}),o=W_(n),oo&&q_(o);let u=o&&o.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let d=+c[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||Rn.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!U_.test(f.parentNode.nodeName)?{ignore:!0}:null}})),c)l=K_(om(l,+c[1],+c[2]),c[4]);else if(l=N.maxOpen(V_(l.content,i),!0),l.openStart||l.openEnd){let d=0,f=0;for(let h=l.content.firstChild;d<l.openStart&&!h.type.spec.isolating;d++,h=h.firstChild);for(let h=l.content.lastChild;f<l.openEnd&&!h.type.spec.isolating;f++,h=h.lastChild);l=om(l,d,f)}return t.someProp("transformPasted",d=>{l=d(l,t)}),l}const U_=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function V_(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),s,o=[];if(t.forEach(l=>{if(!o)return;let a=i.findWrapping(l.type),u;if(!a)return o=null;if(u=o.length&&s.length&&jv(a,s,l,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=Lv(o[o.length-1],s.length));let c=Dv(l,a);o.push(c),i=i.matchType(c.type),s=a}}),o)return T.from(o)}return t}function Dv(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,T.from(t));return t}function jv(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=jv(t,e,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(T.from(Dv(n,t,i+1))))}}function Lv(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,Lv(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(T.empty,!0);return t.copy(n.append(r))}function ed(t,e,n,r,i,s){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(s=0),i<r-1&&(l=ed(l,e,n,r,i+1,s)),i>=n&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(T.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function om(t,e,n){return e<t.openStart&&(t=new N(ed(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new N(ed(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const $v={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let lm=null;function zv(){return lm||(lm=document.implementation.createHTMLDocument("title"))}let bu=null;function H_(t){let e=window.trustedTypes;return e?(bu||(bu=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),bu.createHTML(t)):t}function W_(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=zv().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&$v[r[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=H_(t),i)for(let s=0;s<i.length;s++)n=n.querySelector(i[s])||n;return n}function q_(t){let e=t.querySelectorAll(Ae?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function K_(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let l=r.length-2;l>=0;l-=2){let a=n.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=T.from(a.create(r[l+1],i)),s++,o++}return new N(i,s,o)}const Be={},Fe={},J_={touchstart:!0,touchmove:!0};class G_{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Q_(t){for(let e in Be){let n=Be[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{X_(t,r)&&!wf(t,r)&&(t.editable||!(r.type in Fe))&&n(t,r)},J_[e]?{passive:!0}:void 0)}ze&&t.dom.addEventListener("input",()=>null),td(t)}function Cn(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Y_(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function td(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>wf(t,r))})}function wf(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function X_(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Z_(t,e){!wf(t,e)&&Be[e.type]&&(t.editable||!(e.type in Fe))&&Be[e.type](t,e)}Fe.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!Fv(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Qt&&Ae&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Si&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,tr(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||F_(t,n)?n.preventDefault():Cn(t,"key")};Fe.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Fe.keypress=(t,e)=>{let n=e;if(Fv(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||ct&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof j)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),s=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i,s))&&t.dispatch(s()),n.preventDefault()}};function Sa(t){return{left:t.clientX,top:t.clientY}}function eT(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function kf(t,e,n,r,i){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,l=>o>s.depth?l(t,n,s.nodeAfter,s.before(o),i,!0):l(t,n,s.node(o),s.before(o),i,!1)))return!0;return!1}function ci(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function tT(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&I.isSelectable(r)?(ci(t,new I(n)),!0):!1}function nT(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof I&&(r=n.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(I.isSelectable(l)){r&&n.$from.depth>0&&o>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?i=s.before(n.$from.depth):i=s.before(o);break}}return i!=null?(ci(t,I.create(t.state.doc,i)),!0):!1}function rT(t,e,n,r,i){return kf(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(i?nT(t,n):tT(t,n))}function iT(t,e,n,r){return kf(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function sT(t,e,n,r){return kf(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||oT(t,n,r)}function oT(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(ci(t,j.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)ci(t,j.create(r,l+1,l+1+o.content.size));else if(I.isSelectable(o))ci(t,I.create(r,l));else continue;return!0}}function xf(t){return $l(t)}const Bv=ct?"metaKey":"ctrlKey";Be.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=xf(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&eT(n,t.input.lastClick)&&!n[Bv]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s,button:n.button};let o=t.posAtCoords(Sa(n));o&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new lT(t,o,n,!!r)):(s=="doubleClick"?iT:sT)(t,o.pos,o.inside,n)?n.preventDefault():Cn(t,"pointer"))};class lT{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Bv],this.allowDefault=r.shiftKey;let s,o;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),o=n.inside;else{let c=e.state.doc.resolve(n.pos);s=c.parent,o=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:u}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof I&&u.from<=o&&u.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Mt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Cn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Zt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Sa(e))),this.updateAllowDefault(e),this.allowDefault||!n?Cn(this.view,"pointer"):rT(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||ze&&this.mightDrag&&!this.mightDrag.node.isAtom||Ae&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(ci(this.view,z.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):Cn(this.view,"pointer")}move(e){this.updateAllowDefault(e),Cn(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Be.touchstart=t=>{t.input.lastTouch=Date.now(),xf(t),Cn(t,"pointer")};Be.touchmove=t=>{t.input.lastTouch=Date.now(),Cn(t,"pointer")};Be.contextmenu=t=>xf(t);function Fv(t,e){return t.composing?!0:ze&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const aT=Qt?5e3:-1;Fe.compositionstart=Fe.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof j&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),$l(t,!0),t.markCursor=null;else if($l(t,!e.selection.empty),Mt&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=t.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}t.input.composing=!0}Uv(t,aT)};Fe.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Uv(t,20))};function Uv(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>$l(t),e))}function Vv(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=cT());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function uT(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=t_(e.focusNode,e.focusOffset),r=n_(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(n==s||r==s)return s;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function cT(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function $l(t,e=!1){if(!(Qt&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Vv(t),e||t.docView&&t.docView.dirty){let n=gf(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function dT(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Us=Xe&&Dn<15||Si&&l_<604;Be.copy=Fe.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let s=Us?null:n.clipboardData,o=r.content(),{dom:l,text:a}=vf(t,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",a)):dT(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function fT(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function hT(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Vs(t,r.value,null,i,e):Vs(t,r.textContent,r.innerHTML,i,e)},50)}function Vs(t,e,n,r,i){let s=Rv(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,i,s||N.empty)))return!0;if(!s)return!1;let o=fT(s),l=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(s);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Hv(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}Fe.paste=(t,e)=>{let n=e;if(t.composing&&!Qt)return;let r=Us?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Vs(t,Hv(r),r.getData("text/html"),i,n)?n.preventDefault():hT(t,n)};class Wv{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const pT=ct?"altKey":"ctrlKey";function qv(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[pT]}Be.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(Sa(n)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof I?i.to-1:i.to))){if(r&&r.mightDrag)o=I.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let d=t.docView.nearestDesc(n.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(o=I.create(t.state.doc,d.posBefore))}}let l=(o||t.state.selection).content(),{dom:a,text:u,slice:c}=vf(t,l);(!n.dataTransfer.files.length||!Ae||vv>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Us?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",Us||n.dataTransfer.setData("text/plain",u),t.dragging=new Wv(c,qv(t,n),o)};Be.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Fe.dragover=Fe.dragenter=(t,e)=>e.preventDefault();Fe.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(Sa(n));if(!i)return;let s=t.state.doc.resolve(i.pos),o=r&&r.slice;o?t.someProp("transformPasted",p=>{o=p(o,t)}):o=Rv(t,Hv(n.dataTransfer),Us?null:n.dataTransfer.getData("text/html"),!1,s);let l=!!(r&&qv(t,n));if(t.someProp("handleDrop",p=>p(t,n,o||N.empty,l))){n.preventDefault();return}if(!o)return;n.preventDefault();let a=o?cv(t.state.doc,s.pos,o):s.pos;a==null&&(a=s.pos);let u=t.state.tr;if(l){let{node:p}=r;p?p.replace(u):u.deleteSelection()}let c=u.mapping.map(a),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=u.doc;if(d?u.replaceRangeWith(c,c,o.content.firstChild):u.replaceRange(c,c,o),u.doc.eq(f))return;let h=u.doc.resolve(c);if(d&&I.isSelectable(o.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new I(h));else{let p=u.mapping.map(a);u.mapping.maps[u.mapping.maps.length-1].forEach((m,y,g,v)=>p=v),u.setSelection(yf(t,h,u.doc.resolve(p)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};Be.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Zt(t)},20))};Be.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Be.beforeinput=(t,e)=>{if(Ae&&Qt&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,tr(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Fe)Be[t]=Fe[t];function Hs(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class zl{constructor(e,n){this.toDOM=e,this.spec=n||pr,this.side=this.spec.side||0}map(e,n,r,i){let{pos:s,deleted:o}=e.mapResult(n.from+i,this.side<0?-1:1);return o?null:new it(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof zl&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Hs(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ln{constructor(e,n){this.attrs=e,this.spec=n||pr}map(e,n,r,i){let s=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new it(s,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Ln&&Hs(this.attrs,e.attrs)&&Hs(this.spec,e.spec)}static is(e){return e.type instanceof Ln}destroy(){}}class Sf{constructor(e,n){this.attrs=e,this.spec=n||pr}map(e,n,r,i){let s=e.mapResult(n.from+i,1);if(s.deleted)return null;let o=e.mapResult(n.to+i,-1);return o.deleted||o.pos<=s.pos?null:new it(s.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),s;return i==n.from&&!(s=e.child(r)).isText&&i+s.nodeSize==n.to}eq(e){return this==e||e instanceof Sf&&Hs(this.attrs,e.attrs)&&Hs(this.spec,e.spec)}destroy(){}}class it{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new it(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new it(e,e,new zl(n,r))}static inline(e,n,r,i){return new it(e,n,new Ln(r,i))}static node(e,n,r,i){return new it(e,n,new Sf(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ln}get widget(){return this.type instanceof zl}}const Ur=[],pr={};class oe{constructor(e,n){this.local=e.length?e:Ur,this.children=n.length?n:Ur}static create(e,n){return n.length?Bl(n,e,0,pr):Me}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=n&&l.to>=e&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,n-l,r,i+l,s)}}map(e,n,r){return this==Me||e.maps.length==0?this:this.mapInner(e,n,0,0,r||pr)}mapInner(e,n,r,i,s){let o;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(n,a)?(o||(o=[])).push(a):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?mT(this.children,o||[],e,n,r,i,s):o?new oe(o.sort(mr),Ur):Me}add(e,n){return n.length?this==Me?oe.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,s=0;e.forEach((l,a)=>{let u=a+r,c;if(c=Jv(n,l,u)){for(i||(i=this.children.slice());s<i.length&&i[s]<a;)s+=3;i[s]==a?i[s+2]=i[s+2].addInner(l,c,u+1):i.splice(s,0,a,a+l.nodeSize,Bl(c,l,u+1,pr)),s+=3}});let o=Kv(s?Gv(n):n,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new oe(o.length?this.local.concat(o).sort(mr):this.local,i||this.children)}remove(e){return e.length==0||this==Me?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+n,a=r[s+1]+n;for(let c=0,d;c<e.length;c++)(d=e[c])&&d.from>l&&d.to<a&&(e[c]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let u=r[s+2].removeInner(o,l+1);u!=Me?r[s+2]=u:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new oe(i,r):Me}forChild(e,n){if(this==Me)return this;if(n.isLeaf)return oe.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let s=e+1,o=s+n.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<o&&a.to>s&&a.type instanceof Ln){let u=Math.max(s,a.from)-s,c=Math.min(o,a.to)-s;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new oe(i.sort(mr),Ur);return r?new vn([l,r]):l}return r||Me}eq(e){if(this==e)return!0;if(!(e instanceof oe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return bf(this.localsInner(e))}localsInner(e){if(this==Me)return Ur;if(e.inlineContent||!this.local.some(Ln.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ln||n.push(this.local[r]);return n}forEachSet(e){e(this)}}oe.empty=new oe([],[]);oe.removeOverlap=bf;const Me=oe.empty;class vn{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,pr));return vn.from(r)}forChild(e,n){if(n.isLeaf)return oe.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,n);s!=Me&&(s instanceof vn?r=r.concat(s.members):r.push(s))}return vn.from(r)}eq(e){if(!(e instanceof vn)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let o=0;o<s.length;o++)n.push(s[o])}}return n?bf(r?n:n.sort(mr)):Ur}static from(e){switch(e.length){case 0:return Me;case 1:return e[0];default:return new vn(e.every(n=>n instanceof oe)?e:e.reduce((n,r)=>n.concat(r instanceof oe?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function mT(t,e,n,r,i,s,o){let l=t.slice();for(let u=0,c=s;u<n.maps.length;u++){let d=0;n.maps[u].forEach((f,h,p,m)=>{let y=m-p-(h-f);for(let g=0;g<l.length;g+=3){let v=l[g+1];if(v<0||f>v+c-d)continue;let w=l[g]+c-d;h>=w?l[g+1]=f<=w?-2:-1:f>=c&&y&&(l[g]+=y,l[g+1]+=y)}d+=y}),c=n.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=n.map(t[u]+s),d=c-i;if(d<0||d>=r.content.size){a=!0;continue}let f=n.map(t[u+1]+s,-1),h=f-i,{index:p,offset:m}=r.content.findIndex(d),y=r.maybeChild(p);if(y&&m==d&&m+y.nodeSize==h){let g=l[u+2].mapInner(n,y,c+1,t[u]+s+1,o);g!=Me?(l[u]=d,l[u+1]=h,l[u+2]=g):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=gT(l,t,e,n,i,s,o),c=Bl(u,r,0,o);e=c.local;for(let d=0;d<l.length;d+=3)l[d+1]<0&&(l.splice(d,3),d-=3);for(let d=0,f=0;d<c.children.length;d+=3){let h=c.children[d];for(;f<l.length&&l[f]<h;)f+=3;l.splice(f,0,c.children[d],c.children[d+1],c.children[d+2])}}return new oe(e.sort(mr),l)}function Kv(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new it(i.from+e,i.to+e,i.type))}return n}function gT(t,e,n,r,i,s,o){function l(a,u){for(let c=0;c<a.local.length;c++){let d=a.local[c].map(r,i,u);d?n.push(d):o.onRemove&&o.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<t.length;a+=3)t[a+1]==-1&&l(t[a+2],e[a]+s+1);return n}function Jv(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let s=0,o;s<t.length;s++)(o=t[s])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),t[s]=null);return i}function Gv(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Bl(t,e,n,r){let i=[],s=!1;e.forEach((l,a)=>{let u=Jv(t,l,a+n);if(u){s=!0;let c=Bl(u,l,n+a+1,r);c!=Me&&i.push(a,a+l.nodeSize,c)}});let o=Kv(s?Gv(t):t,-n).sort(mr);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new oe(o,i):Me}function mr(t,e){return t.from-e.from||t.to-e.to}function bf(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,r.to),am(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),am(e,i,r.copy(s.from,r.to)));break}}}return e}function am(t,e,n){for(;e<t.length&&mr(n,t[e])>0;)e++;t.splice(e,0,n)}function Cu(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=Me&&e.push(r)}),t.cursorWrapper&&e.push(oe.create(t.state.doc,[t.cursorWrapper.deco])),vn.from(e)}const yT={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},vT=Xe&&Dn<=11;class wT{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class kT{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new wT,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Xe&&Dn<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),vT&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,yT)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(em(this.view)){if(this.suppressingSelectionUpdates)return Zt(this.view);if(Xe&&Dn<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Cr(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let s=e.focusNode;s;s=xi(s))n.add(s);for(let s=e.anchorNode;s;s=xi(s))if(n.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&em(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,a=[];if(e.editable)for(let c=0;c<n.length;c++){let d=this.registerMutation(n[c],a);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(l=!0))}if(Mt&&a.length){let c=a.filter(d=>d.nodeName=="BR");if(c.length==2){let[d,f]=c;d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let f of c){let h=f.parentNode;h&&h.nodeName=="LI"&&(!d||bT(e,d)!=h)&&f.remove()}}}let u=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ka(r)&&(u=gf(e))&&u.eq(z.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Zt(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),xT(e)),this.handleDOMChange(s,o,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Zt(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let d=e.addedNodes[c];n.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Xe&&Dn<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:d,nextSibling:f}=e.addedNodes[c];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f)}let o=i&&i.parentNode==e.target?be(i)+1:0,l=r.localPosFromDOM(e.target,o,-1),a=s&&s.parentNode==e.target?be(s):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let um=new WeakMap,cm=!1;function xT(t){if(!um.has(t)&&(um.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Mt,cm)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),cm=!0}}function dm(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return Cr(o.node,o.offset,i,s)&&([n,r,i,s]=[i,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}}function ST(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return dm(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?dm(t,n):null}function bT(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function CT(t,e,n){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=t.docView.parseRange(e,n),a=t.domSelectionRange(),u,c=a.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],ka(a)||u.push({node:a.focusNode,offset:a.focusOffset})),Ae&&t.input.lastKeyCode===8)for(let y=s;y>i;y--){let g=r.childNodes[y-1],v=g.pmViewDesc;if(g.nodeName=="BR"&&!v){s=y;break}if(!v||v.size)break}let d=t.state.doc,f=t.someProp("domParser")||Rn.fromSchema(t.state.schema),h=d.resolve(o),p=null,m=f.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:s,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:ET,context:h});if(u&&u[0].pos!=null){let y=u[0].pos,g=u[1]&&u[1].pos;g==null&&(g=y),p={anchor:y+o,head:g+o}}return{doc:m,sel:p,from:o,to:l}}function ET(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(ze&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||ze&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const _T=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function TT(t,e,n,r,i){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let _=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,D=gf(t,_);if(D&&!t.state.selection.eq(D)){if(Ae&&Qt&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",et=>et(t,tr(13,"Enter"))))return;let R=t.state.tr.setSelection(D);_=="pointer"?R.setMeta("pointer",!0):_=="key"&&R.scrollIntoView(),s&&R.setMeta("composition",s),t.dispatch(R)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(n);e=o.before(l+1),n=t.state.doc.resolve(n).after(l+1);let a=t.state.selection,u=CT(t,e,n),c=t.state.doc,d=c.slice(u.from,u.to),f,h;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(f=t.state.selection.to,h="end"):(f=t.state.selection.from,h="start"),t.input.lastKeyCode=null;let p=MT(d.content,u.doc.content,u.from,f,h);if(p&&t.input.domChangeCount++,(Si&&t.input.lastIOSEnter>Date.now()-225||Qt)&&i.some(_=>_.nodeType==1&&!_T.test(_.nodeName))&&(!p||p.endA>=p.endB)&&t.someProp("handleKeyDown",_=>_(t,tr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!p)if(r&&a instanceof j&&!a.empty&&a.$head.sameParent(a.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))p={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let _=fm(t,t.state.doc,u.sel);if(_&&!_.eq(t.state.selection)){let D=t.state.tr.setSelection(_);s&&D.setMeta("composition",s),t.dispatch(D)}}return}t.state.selection.from<t.state.selection.to&&p.start==p.endB&&t.state.selection instanceof j&&(p.start>t.state.selection.from&&p.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?p.start=t.state.selection.from:p.endA<t.state.selection.to&&p.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(p.endB+=t.state.selection.to-p.endA,p.endA=t.state.selection.to)),Xe&&Dn<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>u.from&&u.doc.textBetween(p.start-u.from-1,p.start-u.from+1)==" "&&(p.start--,p.endA--,p.endB--);let m=u.doc.resolveNoCache(p.start-u.from),y=u.doc.resolveNoCache(p.endB-u.from),g=c.resolve(p.start),v=m.sameParent(y)&&m.parent.inlineContent&&g.end()>=p.endA,w;if((Si&&t.input.lastIOSEnter>Date.now()-225&&(!v||i.some(_=>_.nodeName=="DIV"||_.nodeName=="P"))||!v&&m.pos<u.doc.content.size&&(!m.sameParent(y)||!m.parent.inlineContent)&&!/\S/.test(u.doc.textBetween(m.pos,y.pos,"",""))&&(w=z.findFrom(u.doc.resolve(m.pos+1),1,!0))&&w.head>m.pos)&&t.someProp("handleKeyDown",_=>_(t,tr(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>p.start&&NT(c,p.start,p.endA,m,y)&&t.someProp("handleKeyDown",_=>_(t,tr(8,"Backspace")))){Qt&&Ae&&t.domObserver.suppressSelectionUpdates();return}Ae&&p.endB==p.start&&(t.input.lastChromeDelete=Date.now()),Qt&&!v&&m.start()!=y.start()&&y.parentOffset==0&&m.depth==y.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==p.endA&&(p.endB-=2,y=u.doc.resolveNoCache(p.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(_){return _(t,tr(13,"Enter"))})},20));let x=p.start,b=p.endA,S=_=>{let D=_||t.state.tr.replace(x,b,u.doc.slice(p.start-u.from,p.endB-u.from));if(u.sel){let R=fm(t,D.doc,u.sel);R&&!(Ae&&t.composing&&R.empty&&(p.start!=p.endB||t.input.lastChromeDelete<Date.now()-100)&&(R.head==x||R.head==D.mapping.map(b)-1)||Xe&&R.empty&&R.head==x)&&D.setSelection(R)}return s&&D.setMeta("composition",s),D.scrollIntoView()},E;if(v){if(m.pos==y.pos){Xe&&Dn<=11&&m.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Zt(t),20));let _=S(t.state.tr.delete(x,b)),D=c.resolve(p.start).marksAcross(c.resolve(p.endA));D&&_.ensureMarks(D),t.dispatch(_)}else if(p.endA==p.endB&&(E=OT(m.parent.content.cut(m.parentOffset,y.parentOffset),g.parent.content.cut(g.parentOffset,p.endA-g.start())))){let _=S(t.state.tr);E.type=="add"?_.addMark(x,b,E.mark):_.removeMark(x,b,E.mark),t.dispatch(_)}else if(m.parent.child(m.index()).isText&&m.index()==y.index()-(y.textOffset?0:1)){let _=m.parent.textBetween(m.parentOffset,y.parentOffset),D=()=>S(t.state.tr.insertText(_,x,b));t.someProp("handleTextInput",R=>R(t,x,b,_,D))||t.dispatch(D())}}else t.dispatch(S())}function fm(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:yf(t,e.resolve(n.anchor),e.resolve(n.head))}function OT(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,s=r,o,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<n.length;c++)s=n[c].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(T.from(u).eq(t))return{mark:l,type:o}}function NT(t,e,n,r,i){if(n-e<=i.pos-r.pos||Eu(r,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(!r.parent.isTextblock){let l=s.nodeAfter;return l!=null&&n==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(Eu(s,!0,!0));return!o.parent.isTextblock||o.pos>n||Eu(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Eu(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function MT(t,e,n,r,i){let s=t.findDiffStart(e,n);if(s==null)return null;let{a:o,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let a=Math.max(0,s-Math.min(o,l));r-=o+a-s}if(o<s&&t.size<e.size){let a=r<=s&&r>=o?s-r:0;s-=a,s&&s<e.size&&hm(e.textBetween(s-1,s+1))&&(s+=a?1:-1),l=s+(l-o),o=s}else if(l<s){let a=r<=s&&r>=l?s-r:0;s-=a,s&&s<t.size&&hm(t.textBetween(s-1,s+1))&&(s+=a?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function hm(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class Qv{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new G_,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(vm),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=gm(this),mm(this),this.nodeViews=ym(this),this.docView=Jp(this.state.doc,pm(this),Cu(this),this.dom,this),this.domObserver=new kT(this,(r,i,s,o)=>TT(this,r,i,s,o)),this.domObserver.start(),Q_(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&td(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(vm),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(Vv(this),o=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let h=ym(this);AT(h,this.nodeViews)&&(this.nodeViews=h,s=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&td(this),this.editable=gm(this),mm(this);let a=Cu(this),u=pm(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=s||!this.docView.matchesNode(e.doc,u,a);(d||!e.selection.eq(i.selection))&&(o=!0);let f=c=="preserve"&&o&&this.dom.style.overflowAnchor==null&&c_(this);if(o){this.domObserver.stop();let h=d&&(Xe||Ae)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&PT(i.selection,e.selection);if(d){let p=Ae?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=uT(this)),(s||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=Jp(e.doc,u,a,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&R_(this))?Zt(this,h):(Pv(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():f&&d_(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof I){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&Up(this,n.getBoundingClientRect(),e)}else Up(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new Wv(e.slice,e.move,i<0?void 0:I.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=n?n(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=n?n(l):l))return i}}hasFocus(){if(Xe){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&f_(this.dom),Zt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return y_(this,e)}coordsAtPos(e,n=1){return bv(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return S_(this,n||this.state,e)}pasteHTML(e,n){return Vs(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Vs(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return vf(this,e)}destroy(){this.docView&&(Y_(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Cu(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,ZE())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return Z_(this,e)}domSelectionRange(){let e=this.domSelection();return e?ze&&this.root.nodeType===11&&i_(this.dom.ownerDocument)==this.dom&&ST(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Qv.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function pm(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[it.node(0,t.state.doc.content.size,e)]}function mm(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:it.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function gm(t){return!t.someProp("editable",e=>e(t.state)===!1)}function PT(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function ym(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function AT(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function vm(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Bn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Fl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},IT=typeof navigator<"u"&&/Mac/.test(navigator.platform),RT=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Ce=0;Ce<10;Ce++)Bn[48+Ce]=Bn[96+Ce]=String(Ce);for(var Ce=1;Ce<=24;Ce++)Bn[Ce+111]="F"+Ce;for(var Ce=65;Ce<=90;Ce++)Bn[Ce]=String.fromCharCode(Ce+32),Fl[Ce]=String.fromCharCode(Ce);for(var _u in Bn)Fl.hasOwnProperty(_u)||(Fl[_u]=Bn[_u]);function DT(t){var e=IT&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||RT&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Fl:Bn)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const jT=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),LT=typeof navigator<"u"&&/Win/.test(navigator.platform);function $T(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,s,o;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))jT?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function zT(t){let e=Object.create(null);for(let n in t)e[$T(n)]=t[n];return e}function Tu(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function BT(t){return new He({props:{handleKeyDown:Yv(t)}})}function Yv(t){let e=zT(t);return function(n,r){let i=DT(r),s,o=e[Tu(i,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Tu(i,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(LT&&r.ctrlKey&&r.altKey)&&(s=Bn[r.keyCode])&&s!=i){let l=e[Tu(s,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}const Cf=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function Xv(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const Zv=(t,e,n)=>{let r=Xv(t,n);if(!r)return!1;let i=Ef(r);if(!i){let o=r.blockRange(),l=o&&Pi(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(aw(t,i,e,-1))return!0;if(r.parent.content.size==0&&(bi(s,"end")||I.isSelectable(s)))for(let o=r.depth;;o--){let l=va(t.doc,r.before(o),r.after(o),N.empty);if(l&&l.slice.size<l.to-l.from){if(e){let a=t.tr.step(l);a.setSelection(bi(s,"end")?z.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):I.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},FT=(t,e,n)=>{let r=Xv(t,n);if(!r)return!1;let i=Ef(r);return i?ew(t,i,e):!1},UT=(t,e,n)=>{let r=nw(t,n);if(!r)return!1;let i=_f(r);return i?ew(t,i,e):!1};function ew(t,e,n){let r=e.nodeBefore,i=r,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let o=e.nodeAfter,l=o,a=e.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let c=l.firstChild;if(!c)return!1;l=c}let u=va(t.doc,s,a,N.empty);if(!u||u.from!=s||u instanceof ge&&u.slice.size>=a-s)return!1;if(n){let c=t.tr.step(u);c.setSelection(j.create(c.doc,s)),n(c.scrollIntoView())}return!0}function bi(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const tw=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=Ef(r)}let o=s&&s.nodeBefore;return!o||!I.isSelectable(o)?!1:(e&&e(t.tr.setSelection(I.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function Ef(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function nw(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const rw=(t,e,n)=>{let r=nw(t,n);if(!r)return!1;let i=_f(r);if(!i)return!1;let s=i.nodeAfter;if(aw(t,i,e,1))return!0;if(r.parent.content.size==0&&(bi(s,"start")||I.isSelectable(s))){let o=va(t.doc,r.before(),r.after(),N.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(bi(s,"start")?z.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):I.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},iw=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=_f(r)}let o=s&&s.nodeAfter;return!o||!I.isSelectable(o)?!1:(e&&e(t.tr.setSelection(I.create(t.doc,s.pos)).scrollIntoView()),!0)};function _f(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const VT=(t,e)=>{let n=t.selection,r=n instanceof I,i;if(r){if(n.node.isTextblock||!Wn(t.doc,n.from))return!1;i=n.from}else if(i=ya(t.doc,n.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);r&&s.setSelection(I.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},HT=(t,e)=>{let n=t.selection,r;if(n instanceof I){if(n.node.isTextblock||!Wn(t.doc,n.to))return!1;r=n.to}else if(r=ya(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},WT=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),s=i&&Pi(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},sw=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function Tf(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const qT=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=Tf(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=n.after(),a=t.tr.replaceWith(l,l,o.createAndFill());a.setSelection(z.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},ow=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof ot||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=Tf(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=t.tr.insert(o,s.createAndFill());l.setSelection(j.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},lw=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(Xt(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),i=r&&Pi(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function KT(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof I&&e.selection.node.isBlock)return!r.parentOffset||!Xt(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],o,l,a=!1,u=!1;for(let h=r.depth;;h--)if(r.node(h).isBlock){a=r.end(h)==r.pos+(r.depth-h),u=r.start(h)==r.pos-(r.depth-h),l=Tf(r.node(h-1).contentMatchAt(r.indexAfter(h-1))),s.unshift(a&&l?{type:l}:null),o=h;break}else{if(h==1)return!1;s.unshift(null)}let c=e.tr;(e.selection instanceof j||e.selection instanceof ot)&&c.deleteSelection();let d=c.mapping.map(r.pos),f=Xt(c.doc,d,s.length,s);if(f||(s[0]=l?{type:l}:null,f=Xt(c.doc,d,s.length,s)),!f)return!1;if(c.split(d,s.length,s),!a&&u&&r.node(o).type!=l){let h=c.mapping.map(r.before(o)),p=c.doc.resolve(h);l&&r.node(o-1).canReplaceWith(p.index(),p.index()+1,l)&&c.setNodeMarkup(c.mapping.map(r.before(o)),l)}return n&&n(c.scrollIntoView()),!0}}const JT=KT(),GT=(t,e)=>{let{$from:n,to:r}=t.selection,i,s=n.sharedDepth(r);return s==0?!1:(i=n.before(s),e&&e(t.tr.setSelection(I.create(t.doc,i))),!0)};function QT(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Wn(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function aw(t,e,n,r){let i=e.nodeBefore,s=e.nodeAfter,o,l,a=i.type.spec.isolating||s.type.spec.isolating;if(!a&&QT(t,e,n))return!0;let u=!a&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(o=(l=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(n){let h=e.pos+s.nodeSize,p=T.empty;for(let g=o.length-1;g>=0;g--)p=T.from(o[g].create(null,p));p=T.from(i.copy(p));let m=t.tr.step(new ve(e.pos-1,h,e.pos,h,new N(p,1,0),o.length,!0)),y=m.doc.resolve(h+2*o.length);y.nodeAfter&&y.nodeAfter.type==i.type&&Wn(m.doc,y.pos)&&m.join(y.pos),n(m.scrollIntoView())}return!0}let c=s.type.spec.isolating||r>0&&a?null:z.findFrom(e,1),d=c&&c.$from.blockRange(c.$to),f=d&&Pi(d);if(f!=null&&f>=e.depth)return n&&n(t.tr.lift(d,f).scrollIntoView()),!0;if(u&&bi(s,"start",!0)&&bi(i,"end")){let h=i,p=[];for(;p.push(h),!h.isTextblock;)h=h.lastChild;let m=s,y=1;for(;!m.isTextblock;m=m.firstChild)y++;if(h.canReplace(h.childCount,h.childCount,m.content)){if(n){let g=T.empty;for(let w=p.length-1;w>=0;w--)g=T.from(p[w].copy(g));let v=t.tr.step(new ve(e.pos-p.length,e.pos+s.nodeSize,e.pos+y,e.pos+s.nodeSize-y,new N(g,p.length,0),0,!0));n(v.scrollIntoView())}return!0}}return!1}function uw(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(n&&n(e.tr.setSelection(j.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const YT=uw(-1),XT=uw(1);function ZT(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),l=o&&hf(o,t,e);return l?(r&&r(n.tr.wrap(o,l).scrollIntoView()),!0):!1}}function wm(t,e=null){return function(n,r){let i=!1;for(let s=0;s<n.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[s];n.doc.nodesBetween(o,l,(a,u)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(t,e)))if(a.type==t)i=!0;else{let c=n.doc.resolve(u),d=c.index();i=c.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(r){let s=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:a}}=n.selection.ranges[o];s.setBlockType(l,a,t,e)}r(s.scrollIntoView())}return!0}}function Of(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}Of(Cf,Zv,tw);Of(Cf,rw,iw);Of(sw,ow,lw,JT);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function eO(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s);if(!o)return!1;let l=r?n.tr:null;return tO(l,o,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function tO(t,e,n,r=null){let i=!1,s=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let a=o.resolve(e.start-2);s=new Rl(a,a,e.depth),e.endIndex<e.parent.childCount&&(e=new Rl(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let l=hf(s,n,r,e);return l?(t&&nO(t,e,l,i,n),!0):!1}function nO(t,e,n,r,i){let s=T.empty;for(let c=n.length-1;c>=0;c--)s=T.from(n[c].type.create(n[c].attrs,s));t.step(new ve(e.start-(r?2:0),e.end,e.start,e.end,new N(s,0,0),n.length,!0));let o=0;for(let c=0;c<n.length;c++)n[c].type==i&&(o=c+1);let l=n.length-o,a=e.start+n.length-(r?2:0),u=e.parent;for(let c=e.startIndex,d=e.endIndex,f=!0;c<d;c++,f=!1)!f&&Xt(t.doc,a,l)&&(t.split(a,l),a+=2*l),a+=u.child(c).nodeSize;return t}function rO(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?iO(e,n,t,s):sO(e,n,s):!0:!1}}function iO(t,e,n,r){let i=t.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new ve(s-1,o,s,o,new N(T.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Rl(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=Pi(r);if(l==null)return!1;i.lift(r,l);let a=i.doc.resolve(i.mapping.map(s,-1)-1);return Wn(i.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&i.join(a.pos),e(i.scrollIntoView()),!0}function sO(t,e,n){let r=t.tr,i=n.parent;for(let h=n.end,p=n.endIndex-1,m=n.startIndex;p>m;p--)h-=i.child(p).nodeSize,r.delete(h-1,h+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,a=n.endIndex==i.childCount,u=s.node(-1),c=s.index(-1);if(!u.canReplace(c+(l?0:1),c+1,o.content.append(a?T.empty:T.from(i))))return!1;let d=s.pos,f=d+o.nodeSize;return r.step(new ve(d-(l?1:0),f+(a?1:0),d+1,f-1,new N((l?T.empty:T.from(i.copy(T.empty))).append(a?T.empty:T.from(i.copy(T.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function oO(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,a=l.child(o-1);if(a.type!=t)return!1;if(n){let u=a.lastChild&&a.lastChild.type==l.type,c=T.from(u?t.create():null),d=new N(T.from(t.create(null,T.from(l.type.create(null,c)))),u?3:1,0),f=s.start,h=s.end;n(e.tr.step(new ve(f-(u?3:1),h,f,h,d,1,!0)).scrollIntoView())}return!0}}function ba(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,s=n.storedMarks,n}}}class Ca{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...c)=>{const d=a(...c)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l=[],a=!!e,u=e||s.tr,c=()=>(!a&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(u),l.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,h])=>[f,(...m)=>{const y=this.buildProps(u,n),g=h(...m)(y);return l.push(g),d}])),run:c};return d}createCan(e){const{rawCommands:n,state:r}=this,i=!1,s=e||r.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(n).map(([a,u])=>[a,(...c)=>u(...c)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l={tr:e,editor:i,view:o,state:ba({state:s,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([a,u])=>[a,(...c)=>u(...c)(l)]))}};return l}}class lO{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function A(t,e,n){return t.config[e]===void 0&&t.parent?A(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?A(t.parent,e,n):null}):t.config[e]}function Ea(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function cw(t){const e=[],{nodeExtensions:n,markExtensions:r}=Ea(t),i=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:i},a=A(o,"addGlobalAttributes",l);if(!a)return;a().forEach(c=>{c.types.forEach(d=>{Object.entries(c.attributes).forEach(([f,h])=>{e.push({type:d,name:f,attribute:{...s,...h}})})})})}),i.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},a=A(o,"addAttributes",l);if(!a)return;const u=a();Object.entries(u).forEach(([c,d])=>{const f={...s,...d};typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,e.push({type:o.name,name:c,attribute:f})})}),e}function ke(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function Re(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const l=s?String(s).split(" "):[],a=r[i]?r[i].split(" "):[],u=l.filter(c=>!a.includes(c));r[i]=[...a,...u].join(" ")}else if(i==="style"){const l=s?s.split(";").map(c=>c.trim()).filter(Boolean):[],a=r[i]?r[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;a.forEach(c=>{const[d,f]=c.split(":").map(h=>h.trim());u.set(d,f)}),l.forEach(c=>{const[d,f]=c.split(":").map(h=>h.trim());u.set(d,f)}),r[i]=Array.from(u.entries()).map(([c,d])=>`${c}: ${d}`).join("; ")}else r[i]=s}),r},{})}function nd(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>Re(n,r),{})}function dw(t){return typeof t=="function"}function B(t,e=void 0,...n){return dw(t)?e?t.bind(e)(...n):t(...n):t}function aO(t={}){return Object.keys(t).length===0&&t.constructor===Object}function uO(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function km(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(n):uO(n.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...r,...i}}}}function xm(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&aO(n)?!1:n!=null))}function cO(t,e){var n;const r=cw(t),{nodeExtensions:i,markExtensions:s}=Ea(t),o=(n=i.find(u=>A(u,"topNode")))===null||n===void 0?void 0:n.name,l=Object.fromEntries(i.map(u=>{const c=r.filter(g=>g.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},f=t.reduce((g,v)=>{const w=A(v,"extendNodeSchema",d);return{...g,...w?w(u):{}}},{}),h=xm({...f,content:B(A(u,"content",d)),marks:B(A(u,"marks",d)),group:B(A(u,"group",d)),inline:B(A(u,"inline",d)),atom:B(A(u,"atom",d)),selectable:B(A(u,"selectable",d)),draggable:B(A(u,"draggable",d)),code:B(A(u,"code",d)),whitespace:B(A(u,"whitespace",d)),linebreakReplacement:B(A(u,"linebreakReplacement",d)),defining:B(A(u,"defining",d)),isolating:B(A(u,"isolating",d)),attrs:Object.fromEntries(c.map(g=>{var v;return[g.name,{default:(v=g==null?void 0:g.attribute)===null||v===void 0?void 0:v.default}]}))}),p=B(A(u,"parseHTML",d));p&&(h.parseDOM=p.map(g=>km(g,c)));const m=A(u,"renderHTML",d);m&&(h.toDOM=g=>m({node:g,HTMLAttributes:nd(g,c)}));const y=A(u,"renderText",d);return y&&(h.toText=y),[u.name,h]})),a=Object.fromEntries(s.map(u=>{const c=r.filter(y=>y.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},f=t.reduce((y,g)=>{const v=A(g,"extendMarkSchema",d);return{...y,...v?v(u):{}}},{}),h=xm({...f,inclusive:B(A(u,"inclusive",d)),excludes:B(A(u,"excludes",d)),group:B(A(u,"group",d)),spanning:B(A(u,"spanning",d)),code:B(A(u,"code",d)),attrs:Object.fromEntries(c.map(y=>{var g;return[y.name,{default:(g=y==null?void 0:y.attribute)===null||g===void 0?void 0:g.default}]}))}),p=B(A(u,"parseHTML",d));p&&(h.parseDOM=p.map(y=>km(y,c)));const m=A(u,"renderHTML",d);return m&&(h.toDOM=y=>m({mark:y,HTMLAttributes:nd(y,c)})),[u.name,h]}));return new Z0({topNode:o,nodes:l,marks:a})}function Ou(t,e){return e.nodes[t]||e.marks[t]||null}function Sm(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function Nf(t,e){const n=Ar.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const dO=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,l)=>{var a,u;const c=((u=(a=i.type.spec).toText)===null||u===void 0?void 0:u.call(a,{node:i,pos:s,parent:o,index:l}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,r-s))}),n};function Mf(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class _a{constructor(e){this.find=e.find,this.handler=e.handler}}const fO=(t,e)=>{if(Mf(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function $o(t){var e;const{editor:n,from:r,to:i,text:s,rules:o,plugin:l}=t,{view:a}=n;if(a.composing)return!1;const u=a.state.doc.resolve(r);if(u.parent.type.spec.code||!((e=u.nodeBefore||u.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let c=!1;const d=dO(u)+s;return o.forEach(f=>{if(c)return;const h=fO(d,f.find);if(!h)return;const p=a.state.tr,m=ba({state:a.state,transaction:p}),y={from:r-(h[0].length-s.length),to:i},{commands:g,chain:v,can:w}=new Ca({editor:n,state:m});f.handler({state:m,range:y,match:h,commands:g,chain:v,can:w})===null||!p.steps.length||(p.setMeta(l,{transform:p,from:r,to:i,text:s}),a.dispatch(p),c=!0)}),c}function hO(t){const{editor:e,rules:n}=t,r=new He({state:{init(){return null},apply(i,s,o){const l=i.getMeta(r);if(l)return l;const a=i.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:c}=a;typeof c=="string"?c=c:c=Nf(T.from(c),o.schema);const{from:d}=a,f=d+c.length;$o({editor:e,from:d,to:f,text:c,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,o,l){return $o({editor:e,from:s,to:o,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&$o({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?$o({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function pO(t){return Object.prototype.toString.call(t).slice(8,-1)}function zo(t){return pO(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Ta(t,e){const n={...t};return zo(t)&&zo(e)&&Object.keys(e).forEach(r=>{zo(e[r])&&zo(t[r])?n[r]=Ta(t[r],e[r]):n[r]=e[r]}),n}class sn{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=B(A(this,"addOptions",{name:this.name}))),this.storage=B(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new sn(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Ta(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new sn(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=B(A(n,"addOptions",{name:n.name})),n.storage=B(A(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(u=>(u==null?void 0:u.type.name)===n.name))return!1;const a=o.find(u=>(u==null?void 0:u.type.name)===n.name);return a&&r.removeStoredMark(a),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function mO(t){return typeof t=="number"}class gO{constructor(e){this.find=e.find,this.handler=e.handler}}const yO=(t,e,n)=>{if(Mf(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const s=[i.text];return s.index=i.index,s.input=t,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function vO(t){const{editor:e,state:n,from:r,to:i,rule:s,pasteEvent:o,dropEvent:l}=t,{commands:a,chain:u,can:c}=new Ca({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,i,(h,p)=>{if(!h.isTextblock||h.type.spec.code)return;const m=Math.max(r,p),y=Math.min(i,p+h.content.size),g=h.textBetween(m-p,y-p,void 0,"");yO(g,s.find,o).forEach(w=>{if(w.index===void 0)return;const x=m+w.index+1,b=x+w[0].length,S={from:n.tr.mapping.map(x),to:n.tr.mapping.map(b)},E=s.handler({state:n,range:S,match:w,commands:a,chain:u,can:c,pasteEvent:o,dropEvent:l});d.push(E)})}),d.every(h=>h!==null)}let Bo=null;const wO=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function kO(t){const{editor:e,rules:n}=t;let r=null,i=!1,s=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const a=({state:c,from:d,to:f,rule:h,pasteEvt:p})=>{const m=c.tr,y=ba({state:c,transaction:m});if(!(!vO({editor:e,state:y,from:Math.max(d-1,0),to:f.b-1,rule:h,pasteEvent:p,dropEvent:l})||!m.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return n.map(c=>new He({view(d){const f=p=>{var m;r=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?d.dom.parentElement:null,r&&(Bo=e)},h=()=>{Bo&&(Bo=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(d,f)=>{if(s=r===d.dom.parentElement,l=f,!s){const h=Bo;h&&setTimeout(()=>{const p=h.state.selection;p&&h.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,f)=>{var h;const p=(h=f.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return o=f,i=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(d,f,h)=>{const p=d[0],m=p.getMeta("uiEvent")==="paste"&&!i,y=p.getMeta("uiEvent")==="drop"&&!s,g=p.getMeta("applyPasteRules"),v=!!g;if(!m&&!y&&!v)return;if(v){let{text:b}=g;typeof b=="string"?b=b:b=Nf(T.from(b),h.schema);const{from:S}=g,E=S+b.length,_=wO(b);return a({rule:c,state:h,from:S,to:{b:E},pasteEvt:_})}const w=f.doc.content.findDiffStart(h.doc.content),x=f.doc.content.findDiffEnd(h.doc.content);if(!(!mO(w)||!x||w===x.b))return a({rule:c,state:h,from:w,to:x,pasteEvt:o})}}))}function xO(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class ni{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=ni.resolve(e),this.schema=cO(this.extensions,n),this.setupExtensions()}static resolve(e){const n=ni.sort(ni.flatten(e)),r=xO(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=A(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=A(r,"priority")||100,o=A(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Ou(n.name,this.schema)},i=A(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=ni.sort([...this.extensions].reverse()),r=[],i=[],s=n.map(o=>{const l={name:o.name,options:o.options,storage:o.storage,editor:e,type:Ou(o.name,this.schema)},a=[],u=A(o,"addKeyboardShortcuts",l);let c={};if(o.type==="mark"&&A(o,"exitable",l)&&(c.ArrowRight=()=>sn.handleExit({editor:e,mark:o})),u){const m=Object.fromEntries(Object.entries(u()).map(([y,g])=>[y,()=>g({editor:e})]));c={...c,...m}}const d=BT(c);a.push(d);const f=A(o,"addInputRules",l);Sm(o,e.options.enableInputRules)&&f&&r.push(...f());const h=A(o,"addPasteRules",l);Sm(o,e.options.enablePasteRules)&&h&&i.push(...h());const p=A(o,"addProseMirrorPlugins",l);if(p){const m=p();a.push(...m)}return a}).flat();return[hO({editor:e,rules:r}),...kO({editor:e,rules:i}),...s]}get attributes(){return cw(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Ea(this.extensions);return Object.fromEntries(n.filter(r=>!!A(r,"addNodeView")).map(r=>{const i=this.attributes.filter(a=>a.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:ke(r.name,this.schema)},o=A(r,"addNodeView",s);if(!o)return[];const l=(a,u,c,d,f)=>{const h=nd(a,i);return o()({node:a,view:u,getPos:c,decorations:d,innerDecorations:f,editor:e,extension:r,HTMLAttributes:h})};return[r.name,l]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Ou(e.name,this.schema)};e.type==="mark"&&(!((n=B(A(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=A(e,"onBeforeCreate",r),s=A(e,"onCreate",r),o=A(e,"onUpdate",r),l=A(e,"onSelectionUpdate",r),a=A(e,"onTransaction",r),u=A(e,"onFocus",r),c=A(e,"onBlur",r),d=A(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),a&&this.editor.on("transaction",a),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}}class De{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=B(A(this,"addOptions",{name:this.name}))),this.storage=B(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new De(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Ta(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new De({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=B(A(n,"addOptions",{name:n.name})),n.storage=B(A(n,"addStorage",{name:n.name,options:n.options})),n}}function fw(t,e,n){const{from:r,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=n||{};let l="";return t.nodesBetween(r,i,(a,u,c,d)=>{var f;a.isBlock&&u>r&&(l+=s);const h=o==null?void 0:o[a.type.name];if(h)return c&&(l+=h({node:a,pos:u,parent:c,index:d,range:e})),!1;a.isText&&(l+=(f=a==null?void 0:a.text)===null||f===void 0?void 0:f.slice(Math.max(r,u)-u,i-u))}),l}function hw(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const SO=De.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new He({key:new Pt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(c=>c.$from.pos)),l=Math.max(...s.map(c=>c.$to.pos)),a=hw(n);return fw(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),bO=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),CO=(t=!1)=>({commands:e})=>e.setContent("",t),EO=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:s,$to:o})=>{t.doc.nodesBetween(s.pos,o.pos,(l,a)=>{if(l.type.isText)return;const{doc:u,mapping:c}=e,d=u.resolve(c.map(a)),f=u.resolve(c.map(a+l.nodeSize)),h=d.blockRange(f);if(!h)return;const p=Pi(h);if(l.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},_O=t=>e=>t(e),TO=()=>({state:t,dispatch:e})=>ow(t,e),OO=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,s=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,s.content),r.setSelection(new j(r.doc.resolve(o-1))),!0},NO=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(e){const l=i.before(s),a=i.after(s);t.delete(l,a).scrollIntoView()}return!0}return!1},MO=t=>({tr:e,state:n,dispatch:r})=>{const i=ke(t,n.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const a=s.before(o),u=s.after(o);e.delete(a,u).scrollIntoView()}return!0}return!1},PO=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},AO=()=>({state:t,dispatch:e})=>Cf(t,e),IO=()=>({commands:t})=>t.keyboardShortcut("Enter"),RO=()=>({state:t,dispatch:e})=>qT(t,e);function Ul(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:Mf(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function pw(t,e,n={}){return t.find(r=>r.type===e&&Ul(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function bm(t,e,n={}){return!!pw(t,e,n)}function Pf(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!pw([...i.node.marks],e,n)))return;let o=i.index,l=t.start()+i.offset,a=o+1,u=l+i.node.nodeSize;for(;o>0&&bm([...t.parent.child(o-1).marks],e,n);)o-=1,l-=t.parent.child(o).nodeSize;for(;a<t.parent.childCount&&bm([...t.parent.child(a).marks],e,n);)u+=t.parent.child(a).nodeSize,a+=1;return{from:l,to:u}}function Kn(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const DO=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const s=Kn(t,r.schema),{doc:o,selection:l}=n,{$from:a,from:u,to:c}=l;if(i){const d=Pf(a,s,e);if(d&&d.from<=u&&d.to>=c){const f=j.create(o,d.from,d.to);n.setSelection(f)}}return!0},jO=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function mw(t){return t instanceof j}function ar(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function gw(t,e=null){if(!e)return null;const n=z.atStart(t),r=z.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,s=r.to;return e==="all"?j.create(t,ar(0,i,s),ar(t.content.size,i,s)):j.create(t,ar(e,i,s),ar(e,i,s))}function LO(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Af(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const $O=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{(Af()||LO())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!mw(n.state.selection))return o(),!0;const l=gw(i.doc,t)||n.state.selection,a=n.state.selection.eq(l);return s&&(a||i.setSelection(l),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},zO=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),BO=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),yw=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&yw(r)}return t};function Fo(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return yw(n)}function Ws(t,e,n){if(t instanceof In||t instanceof T)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return T.fromArray(t.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),Ws("",e,n)}if(i){if(n.errorOnInvalidContent){let o=!1,l="";const a=new Z0({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(o=!0,l=typeof u=="string"?u:u.outerHTML,null)}]}})});if(n.slice?Rn.fromSchema(a).parseSlice(Fo(t),n.parseOptions):Rn.fromSchema(a).parse(Fo(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=Rn.fromSchema(e);return n.slice?s.parseSlice(Fo(t),n.parseOptions).content:s.parse(Fo(t),n.parseOptions)}return Ws("",e,n)}function FO(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof ge||i instanceof ve))return;const s=t.mapping.maps[r];let o=0;s.forEach((l,a,u,c)=>{o===0&&(o=c)}),t.setSelection(z.near(t.doc.resolve(o),n))}const UO=t=>!("type"in t),VO=(t,e,n)=>({tr:r,dispatch:i,editor:s})=>{var o;if(i){n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const a=y=>{s.emit("contentError",{editor:s,error:y,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Ws(e,s.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(y){a(y)}try{l=Ws(e,s.schema,{parseOptions:u,errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:s.options.enableContentCheck})}catch(y){return a(y),!1}let{from:c,to:d}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},f=!0,h=!0;if((UO(l)?l:[l]).forEach(y=>{y.check(),f=f?y.isText&&y.marks.length===0:!1,h=h?y.isBlock:!1}),c===d&&h){const{parent:y}=r.doc.resolve(c);y.isTextblock&&!y.type.spec.code&&!y.childCount&&(c-=1,d+=1)}let m;if(f){if(Array.isArray(e))m=e.map(y=>y.text||"").join("");else if(e instanceof T){let y="";e.forEach(g=>{g.text&&(y+=g.text)}),m=y}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,c,d)}else m=l,r.replaceWith(c,d,m);n.updateSelection&&FO(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:m}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:m})}return!0},HO=()=>({state:t,dispatch:e})=>VT(t,e),WO=()=>({state:t,dispatch:e})=>HT(t,e),qO=()=>({state:t,dispatch:e})=>Zv(t,e),KO=()=>({state:t,dispatch:e})=>rw(t,e),JO=()=>({state:t,dispatch:e,tr:n})=>{try{const r=ya(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},GO=()=>({state:t,dispatch:e,tr:n})=>{try{const r=ya(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},QO=()=>({state:t,dispatch:e})=>FT(t,e),YO=()=>({state:t,dispatch:e})=>UT(t,e);function vw(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function XO(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,s,o;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))Af()||vw()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}const ZO=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const s=XO(t).split(/-(?!$)/),o=s.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,l))});return a==null||a.steps.forEach(u=>{const c=u.map(r.mapping);c&&i&&r.maybeStep(c)}),!0};function qs(t,e,n={}){const{from:r,to:i,empty:s}=t.selection,o=e?ke(e,t.schema):null,l=[];t.doc.nodesBetween(r,i,(d,f)=>{if(d.isText)return;const h=Math.max(r,f),p=Math.min(i,f+d.nodeSize);l.push({node:d,from:h,to:p})});const a=i-r,u=l.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>Ul(d.node.attrs,n,{strict:!1}));return s?!!u.length:u.reduce((d,f)=>d+f.to-f.from,0)>=a}const eN=(t,e={})=>({state:n,dispatch:r})=>{const i=ke(t,n.schema);return qs(n,i,e)?WT(n,r):!1},tN=()=>({state:t,dispatch:e})=>lw(t,e),nN=t=>({state:e,dispatch:n})=>{const r=ke(t,e.schema);return rO(r)(e,n)},rN=()=>({state:t,dispatch:e})=>sw(t,e);function Oa(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Cm(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const iN=(t,e)=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const l=Oa(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(s=ke(t,r.schema)),l==="mark"&&(o=Kn(t,r.schema)),i&&n.selection.ranges.forEach(a=>{r.doc.nodesBetween(a.$from.pos,a.$to.pos,(u,c)=>{s&&s===u.type&&n.setNodeMarkup(c,void 0,Cm(u.attrs,e)),o&&u.marks.length&&u.marks.forEach(d=>{o===d.type&&n.addMark(c,c+u.nodeSize,o.create(Cm(d.attrs,e)))})})}),!0):!1},sN=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),oN=()=>({tr:t,dispatch:e})=>{if(e){const n=new ot(t.doc);t.setSelection(n)}return!0},lN=()=>({state:t,dispatch:e})=>tw(t,e),aN=()=>({state:t,dispatch:e})=>iw(t,e),uN=()=>({state:t,dispatch:e})=>GT(t,e),cN=()=>({state:t,dispatch:e})=>XT(t,e),dN=()=>({state:t,dispatch:e})=>YT(t,e);function rd(t,e,n={},r={}){return Ws(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const fN=(t,e=!1,n={},r={})=>({editor:i,tr:s,dispatch:o,commands:l})=>{var a,u;const{doc:c}=s;if(n.preserveWhitespace!=="full"){const d=rd(t,i.schema,n,{errorOnInvalidContent:(a=r.errorOnInvalidContent)!==null&&a!==void 0?a:i.options.enableContentCheck});return o&&s.replaceWith(0,c.content.size,d).setMeta("preventUpdate",!e),!0}return o&&s.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:c.content.size},t,{parseOptions:n,errorOnInvalidContent:(u=r.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck})};function ww(t,e){const n=Kn(e,t.schema),{from:r,to:i,empty:s}=t.selection,o=[];s?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,a=>{o.push(...a.marks)});const l=o.find(a=>a.type.name===n.name);return l?{...l.attrs}:{}}function hN(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function pN(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function If(t){return e=>pN(e.$from,t)}function mN(t,e){const n={from:0,to:t.content.size};return fw(t,n,e)}function gN(t,e){const n=ke(e,t.schema),{from:r,to:i}=t.selection,s=[];t.doc.nodesBetween(r,i,l=>{s.push(l)});const o=s.reverse().find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function yN(t,e){const n=Oa(typeof e=="string"?e:e.name,t.schema);return n==="node"?gN(t,e):n==="mark"?ww(t,e):{}}function kw(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const s=n.resolve(t),o=Pf(s,i.type);o&&r.push({mark:i,...o})}):n.nodesBetween(t,e,(i,s)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function rl(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(s=>s.type===e&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}function id(t,e,n={}){const{empty:r,ranges:i}=t.selection,s=e?Kn(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>s?s.name===d.type.name:!0).find(d=>Ul(d.attrs,n,{strict:!1}));let o=0;const l=[];if(i.forEach(({$from:d,$to:f})=>{const h=d.pos,p=f.pos;t.doc.nodesBetween(h,p,(m,y)=>{if(!m.isText&&!m.marks.length)return;const g=Math.max(h,y),v=Math.min(p,y+m.nodeSize),w=v-g;o+=w,l.push(...m.marks.map(x=>({mark:x,from:g,to:v})))})}),o===0)return!1;const a=l.filter(d=>s?s.name===d.mark.type.name:!0).filter(d=>Ul(d.mark.attrs,n,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),u=l.filter(d=>s?d.mark.type!==s&&d.mark.type.excludes(s):!0).reduce((d,f)=>d+f.to-f.from,0);return(a>0?a+u:a)>=o}function vN(t,e,n={}){if(!e)return qs(t,null,n)||id(t,null,n);const r=Oa(e,t.schema);return r==="node"?qs(t,e,n):r==="mark"?id(t,e,n):!1}function Em(t,e){const{nodeExtensions:n}=Ea(e),r=n.find(o=>o.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=B(A(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Na(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(s=>{i!==!1&&(Na(s,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function wN(t){return t instanceof I}function kN(t,e,n){var r;const{selection:i}=e;let s=null;if(mw(i)&&(s=i.$cursor),s){const l=(r=t.storedMarks)!==null&&r!==void 0?r:s.marks();return!!n.isInSet(l)||!l.some(a=>a.type.excludes(n))}const{ranges:o}=i;return o.some(({$from:l,$to:a})=>{let u=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,a.pos,(c,d,f)=>{if(u)return!1;if(c.isInline){const h=!f||f.type.allowsMarkType(n),p=!!n.isInSet(c.marks)||!c.marks.some(m=>m.type.excludes(n));u=h&&p}return!u}),u})}const xN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:s}=n,{empty:o,ranges:l}=s,a=Kn(t,r.schema);if(i)if(o){const u=ww(r,a);n.addStoredMark(a.create({...u,...e}))}else l.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;r.doc.nodesBetween(c,d,(f,h)=>{const p=Math.max(h,c),m=Math.min(h+f.nodeSize,d);f.marks.find(g=>g.type===a)?f.marks.forEach(g=>{a===g.type&&n.addMark(p,m,a.create({...g.attrs,...e}))}):n.addMark(p,m,a.create(e))})});return kN(r,n,a)},SN=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),bN=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const s=ke(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:l})=>wm(s,{...o,...e})(n)?!0:l.clearNodes()).command(({state:l})=>wm(s,{...o,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},CN=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=ar(t,0,r.content.size),s=I.create(r,i);e.setSelection(s)}return!0},EN=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:s}=typeof t=="number"?{from:t,to:t}:t,o=j.atStart(r).from,l=j.atEnd(r).to,a=ar(i,o,l),u=ar(s,o,l),c=j.create(r,a,u);e.setSelection(c)}return!0},_N=t=>({state:e,dispatch:n})=>{const r=ke(t,e.schema);return oO(r)(e,n)};function _m(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const TN=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:l,$to:a}=s,u=i.extensionManager.attributes,c=rl(u,l.node().type.name,l.node().attrs);if(s instanceof I&&s.node.isBlock)return!l.parentOffset||!Xt(o,l.pos)?!1:(r&&(t&&_m(n,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const d=a.parentOffset===a.parent.content.size,f=l.depth===0?void 0:hN(l.node(-1).contentMatchAt(l.indexAfter(-1)));let h=d&&f?[{type:f,attrs:c}]:void 0,p=Xt(e.doc,e.mapping.map(l.pos),1,h);if(!h&&!p&&Xt(e.doc,e.mapping.map(l.pos),1,f?[{type:f}]:void 0)&&(p=!0,h=f?[{type:f,attrs:c}]:void 0),r){if(p&&(s instanceof j&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,h),f&&!d&&!l.parentOffset&&l.parent.type!==f)){const m=e.mapping.map(l.before()),y=e.doc.resolve(m);l.node(-1).canReplaceWith(y.index(),y.index()+1,f)&&e.setNodeMarkup(e.mapping.map(l.before()),f)}t&&_m(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return p},ON=(t,e={})=>({tr:n,state:r,dispatch:i,editor:s})=>{var o;const l=ke(t,r.schema),{$from:a,$to:u}=r.selection,c=r.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(u))return!1;const d=a.node(-1);if(d.type!==l)return!1;const f=s.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==l||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let g=T.empty;const v=a.index(-1)?1:a.index(-2)?2:3;for(let _=a.depth-v;_>=a.depth-3;_-=1)g=T.from(a.node(_).copy(g));const w=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,x={...rl(f,a.node().type.name,a.node().attrs),...e},b=((o=l.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(x))||void 0;g=g.append(T.from(l.createAndFill(null,b)||void 0));const S=a.before(a.depth-(v-1));n.replace(S,a.after(-w),new N(g,4-v,0));let E=-1;n.doc.nodesBetween(S,n.doc.content.size,(_,D)=>{if(E>-1)return!1;_.isTextblock&&_.content.size===0&&(E=D+1)}),E>-1&&n.setSelection(j.near(n.doc.resolve(E))),n.scrollIntoView()}return!0}const h=u.pos===a.end()?d.contentMatchAt(0).defaultType:null,p={...rl(f,d.type.name,d.attrs),...e},m={...rl(f,a.node().type.name,a.node().attrs),...e};n.delete(a.pos,u.pos);const y=h?[{type:l,attrs:p},{type:h,attrs:m}]:[{type:l,attrs:p}];if(!Xt(n.doc,a.pos,2))return!1;if(i){const{selection:g,storedMarks:v}=r,{splittableMarks:w}=s.extensionManager,x=v||g.$to.parentOffset&&g.$from.marks();if(n.split(a.pos,2,y).scrollIntoView(),!x||!i)return!0;const b=x.filter(S=>w.includes(S.type.name));n.ensureMarks(b)}return!0},Nu=(t,e)=>{const n=If(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Wn(t.doc,n.pos)&&t.join(n.pos),!0},Mu=(t,e)=>{const n=If(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Wn(t.doc,r)&&t.join(r),!0},NN=(t,e,n,r={})=>({editor:i,tr:s,state:o,dispatch:l,chain:a,commands:u,can:c})=>{const{extensions:d,splittableMarks:f}=i.extensionManager,h=ke(t,o.schema),p=ke(e,o.schema),{selection:m,storedMarks:y}=o,{$from:g,$to:v}=m,w=g.blockRange(v),x=y||m.$to.parentOffset&&m.$from.marks();if(!w)return!1;const b=If(S=>Em(S.type.name,d))(m);if(w.depth>=1&&b&&w.depth-b.depth<=1){if(b.node.type===h)return u.liftListItem(p);if(Em(b.node.type.name,d)&&h.validContent(b.node.content)&&l)return a().command(()=>(s.setNodeMarkup(b.pos,h),!0)).command(()=>Nu(s,h)).command(()=>Mu(s,h)).run()}return!n||!x||!l?a().command(()=>c().wrapInList(h,r)?!0:u.clearNodes()).wrapInList(h,r).command(()=>Nu(s,h)).command(()=>Mu(s,h)).run():a().command(()=>{const S=c().wrapInList(h,r),E=x.filter(_=>f.includes(_.type.name));return s.ensureMarks(E),S?!0:u.clearNodes()}).wrapInList(h,r).command(()=>Nu(s,h)).command(()=>Mu(s,h)).run()},MN=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=n,o=Kn(t,r.schema);return id(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},PN=(t,e,n={})=>({state:r,commands:i})=>{const s=ke(t,r.schema),o=ke(e,r.schema),l=qs(r,s,n);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),l?i.setNode(o,a):i.setNode(s,{...a,...n})},AN=(t,e={})=>({state:n,commands:r})=>{const i=ke(t,n.schema);return qs(n,i,e)?r.lift(i):r.wrapIn(i,e)},IN=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let s;if(i.spec.isInputRules&&(s=i.getState(t))){if(e){const o=t.tr,l=s.transform;for(let a=l.steps.length-1;a>=0;a-=1)o.step(l.steps[a].invert(l.docs[a]));if(s.text){const a=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,t.schema.text(s.text,a))}else o.delete(s.from,s.to)}return!0}}return!1},RN=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},DN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=n,a=Kn(t,r.schema),{$from:u,empty:c,ranges:d}=l;if(!i)return!0;if(c&&o){let{from:f,to:h}=l;const p=(s=u.marks().find(y=>y.type===a))===null||s===void 0?void 0:s.attrs,m=Pf(u,a,p);m&&(f=m.from,h=m.to),n.removeMark(f,h,a)}else d.forEach(f=>{n.removeMark(f.$from.pos,f.$to.pos,a)});return n.removeStoredMark(a),!0},jN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const l=Oa(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(s=ke(t,r.schema)),l==="mark"&&(o=Kn(t,r.schema)),i&&n.selection.ranges.forEach(a=>{const u=a.$from.pos,c=a.$to.pos;let d,f,h,p;n.selection.empty?r.doc.nodesBetween(u,c,(m,y)=>{s&&s===m.type&&(h=Math.max(y,u),p=Math.min(y+m.nodeSize,c),d=y,f=m)}):r.doc.nodesBetween(u,c,(m,y)=>{y<u&&s&&s===m.type&&(h=Math.max(y,u),p=Math.min(y+m.nodeSize,c),d=y,f=m),y>=u&&y<=c&&(s&&s===m.type&&n.setNodeMarkup(y,void 0,{...m.attrs,...e}),o&&m.marks.length&&m.marks.forEach(g=>{if(o===g.type){const v=Math.max(y,u),w=Math.min(y+m.nodeSize,c);n.addMark(v,w,o.create({...g.attrs,...e}))}}))}),f&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...f.attrs,...e}),o&&f.marks.length&&f.marks.forEach(m=>{o===m.type&&n.addMark(h,p,o.create({...m.attrs,...e}))}))}),!0):!1},LN=(t,e={})=>({state:n,dispatch:r})=>{const i=ke(t,n.schema);return ZT(i,e)(n,r)},$N=(t,e={})=>({state:n,dispatch:r})=>{const i=ke(t,n.schema);return eO(i,e)(n,r)};var zN=Object.freeze({__proto__:null,blur:bO,clearContent:CO,clearNodes:EO,command:_O,createParagraphNear:TO,cut:OO,deleteCurrentNode:NO,deleteNode:MO,deleteRange:PO,deleteSelection:AO,enter:IO,exitCode:RO,extendMarkRange:DO,first:jO,focus:$O,forEach:zO,insertContent:BO,insertContentAt:VO,joinBackward:qO,joinDown:WO,joinForward:KO,joinItemBackward:JO,joinItemForward:GO,joinTextblockBackward:QO,joinTextblockForward:YO,joinUp:HO,keyboardShortcut:ZO,lift:eN,liftEmptyBlock:tN,liftListItem:nN,newlineInCode:rN,resetAttributes:iN,scrollIntoView:sN,selectAll:oN,selectNodeBackward:lN,selectNodeForward:aN,selectParentNode:uN,selectTextblockEnd:cN,selectTextblockStart:dN,setContent:fN,setMark:xN,setMeta:SN,setNode:bN,setNodeSelection:CN,setTextSelection:EN,sinkListItem:_N,splitBlock:TN,splitListItem:ON,toggleList:NN,toggleMark:MN,toggleNode:PN,toggleWrap:AN,undoInputRule:IN,unsetAllMarks:RN,unsetMark:DN,updateAttributes:jN,wrapIn:LN,wrapInList:$N});const BN=De.create({name:"commands",addCommands(){return{...zN}}}),FN=De.create({name:"drop",addProseMirrorPlugins(){return[new He({key:new Pt("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),UN=De.create({name:"editable",addProseMirrorPlugins(){return[new He({key:new Pt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),VN=new Pt("focusEvents"),HN=De.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new He({key:VN,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),WN=De.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:a,doc:u}=l,{empty:c,$anchor:d}=a,{pos:f,parent:h}=d,p=d.parent.isTextblock&&f>0?l.doc.resolve(f-1):d,m=p.parent.type.spec.isolating,y=d.pos-d.parentOffset,g=m&&p.parent.childCount===1?y===d.pos:z.atStart(u).from===f;return!c||!h.type.isTextblock||h.textContent.length||!g||g&&d.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Af()||vw()?s:i},addProseMirrorPlugins(){return[new He({key:new Pt("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(m=>m.getMeta("composition")))return;const r=t.some(m=>m.docChanged)&&!e.doc.eq(n.doc),i=t.some(m=>m.getMeta("preventClearDocument"));if(!r||i)return;const{empty:s,from:o,to:l}=e.selection,a=z.atStart(e.doc).from,u=z.atEnd(e.doc).to;if(s||!(o===a&&l===u)||!Na(n.doc))return;const f=n.tr,h=ba({state:n,transaction:f}),{commands:p}=new Ca({editor:this.editor,state:h});if(p.clearNodes(),!!f.steps.length)return f}})]}}),qN=De.create({name:"paste",addProseMirrorPlugins(){return[new He({key:new Pt("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),KN=De.create({name:"tabindex",addProseMirrorPlugins(){return[new He({key:new Pt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class nr{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new nr(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new nr(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new nr(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,o=this.pos+r+(s?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(o);if(!i&&l.depth<=this.depth)return;const a=new nr(l,this.editor,i,i?n:null);i&&(a.actualDepth=this.depth+1),e.push(new nr(l,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const s=i.node.attrs,o=Object.keys(n);for(let l=0;l<o.length;l+=1){const a=o[l];if(s[a]!==n[a])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const s=Object.keys(n);return this.children.forEach(o=>{r&&i.length>0||(o.node.type.name===e&&s.every(a=>n[a]===o.node.attrs[a])&&i.push(o),!(r&&i.length>0)&&(i=i.concat(o.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const JN=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function GN(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}let QN=class extends lO{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=GN(JN,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=dw(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(s=>{const o=typeof s=="string"?`${s}$`:s.key;r=r.filter(l=>!l.key.startsWith(o))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[UN,SO.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),BN,HN,WN,KN,FN,qN].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s==null?void 0:s.type));this.extensionManager=new ni(i,this)}createCommandManager(){this.commandManager=new Ca({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=rd(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()}}),n=rd(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=gw(n,this.options.autofocus);this.view=new Qv(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:ti.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(o)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return yN(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return vN(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Nf(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return mN(this.state.doc,{blockSeparator:n,textSerializers:{...hw(this.schema),...r}})}get isEmpty(){return Na(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new nr(n,this)}get $doc(){return this.$pos(0)}};function _r(t){return new _a({find:t.find,handler:({state:e,range:n,match:r})=>{const i=B(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],l=r[0];if(o){const a=l.search(/\S/),u=n.from+l.indexOf(o),c=u+o.length;if(kw(n.from,n.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===t.type&&m!==h.mark.type)).filter(h=>h.to>u).length)return null;c<n.to&&s.delete(c,n.to),u>n.from&&s.delete(n.from+a,u);const f=n.from+a+o.length;s.addMark(n.from+a,f,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}function YN(t){return new _a({find:t.find,handler:({state:e,range:n,match:r})=>{const i=B(t.getAttributes,void 0,r)||{},{tr:s}=e,o=n.from;let l=n.to;const a=t.type.create(i);if(r[1]){const u=r[0].lastIndexOf(r[1]);let c=o+u;c>l?c=l:l=c+r[1].length;const d=r[0][r[0].length-1];s.insertText(d,o+r[0].length-1),s.replaceWith(c,l,a)}else if(r[0]){const u=t.type.isInline?o:o-1;s.insert(u,t.type.create(i)).delete(s.mapping.map(o),s.mapping.map(l))}s.scrollIntoView()}})}function sd(t){return new _a({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),s=B(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})}function Ks(t){return new _a({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const s=B(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),a=o.doc.resolve(n.from).blockRange(),u=a&&hf(a,t.type,s);if(!u)return null;if(o.wrap(a,u),t.keepMarks&&t.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:h}=t.editor.extensionManager,p=f||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(y=>h.includes(y.type.name));o.ensureMarks(m)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,s).run()}const c=o.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&Wn(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&o.join(n.from-1)}})}class Ze{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=B(A(this,"addOptions",{name:this.name}))),this.storage=B(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ze(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Ta(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Ze(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=B(A(n,"addOptions",{name:n.name})),n.storage=B(A(n,"addStorage",{name:n.name,options:n.options})),n}}function Tr(t){return new gO({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const s=B(t.getAttributes,void 0,r,i);if(s===!1||s===null)return null;const{tr:o}=e,l=r[r.length-1],a=r[0];let u=n.to;if(l){const c=a.search(/\S/),d=n.from+a.indexOf(l),f=d+l.length;if(kw(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(y=>y===t.type&&y!==p.mark.type)).filter(p=>p.to>d).length)return null;f<n.to&&o.delete(f,n.to),d>n.from&&o.delete(n.from+c,d),u=n.from+c+l.length,o.addMark(n.from+c,u,t.type.create(s||{})),o.removeStoredMark(t.type)}}})}function XN(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof I){const s=r.index();return r.parent.canReplaceWith(s,s+1,e)}let i=r.depth;for(;i>=0;){const s=r.index(i);if(r.node(i).contentMatchAt(s).matchType(e))return!0;i-=1}return!1}function ZN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xw={exports:{}},Pu={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm;function eM(){if(Tm)return Pu;Tm=1;var t=me;function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function l(d,f){var h=f(),p=r({inst:{value:h,getSnapshot:f}}),m=p[0].inst,y=p[1];return s(function(){m.value=h,m.getSnapshot=f,a(m)&&y({inst:m})},[d,h,f]),i(function(){return a(m)&&y({inst:m}),d(function(){a(m)&&y({inst:m})})},[d]),o(h),h}function a(d){var f=d.getSnapshot;d=d.value;try{var h=f();return!n(d,h)}catch{return!0}}function u(d,f){return f()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return Pu.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:c,Pu}xw.exports=eM();var Rf=xw.exports;const tM=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},nM=({contentComponent:t})=>{const e=Rf.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return me.createElement(me.Fragment,null,Object.values(e))};function rM(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:cx.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class iM extends me.Component{constructor(e){var n;super(e),this.editorContentRef=me.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=rM(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return me.createElement(me.Fragment,null,me.createElement("div",{ref:tM(n,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&me.createElement(nM,{contentComponent:e.contentComponent}))}}const sM=C.forwardRef((t,e)=>{const n=me.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return me.createElement(iM,{key:n,innerRef:e,...t})}),oM=me.memo(sM);var lM=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!(o==="_owner"&&e.$$typeof)&&!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},aM=ZN(lM),Sw={exports:{}},Au={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Om;function uM(){if(Om)return Au;Om=1;var t=me,e=Rf;function n(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,l=t.useMemo,a=t.useDebugValue;return Au.useSyncExternalStoreWithSelector=function(u,c,d,f,h){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=l(function(){function g(S){if(!v){if(v=!0,w=S,S=f(S),h!==void 0&&m.hasValue){var E=m.value;if(h(E,S))return x=E}return x=S}if(E=x,r(w,S))return E;var _=f(S);return h!==void 0&&h(E,_)?E:(w=S,x=_)}var v=!1,w,x,b=d===void 0?null:d;return[function(){return g(c())},b===null?void 0:function(){return g(b())}]},[c,d,f,h]);var y=i(u,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=y},[y]),a(y),y},Au}Sw.exports=uM();var cM=Sw.exports;const dM=typeof window<"u"?C.useLayoutEffect:C.useEffect;class fM{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function hM(t){var e;const[n]=C.useState(()=>new fM(t.editor)),r=cM.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:aM);return dM(()=>n.watch(t.editor),[t.editor,n]),C.useDebugValue(r),r}const pM=!1,od=typeof window>"u",mM=od||!!(typeof window<"u"&&window.next);class Df{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?od||mM?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onBeforeCreate)===null||s===void 0?void 0:s.call(i,...r)},onBlur:(...r)=>{var i,s;return(s=(i=this.options.current).onBlur)===null||s===void 0?void 0:s.call(i,...r)},onCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onCreate)===null||s===void 0?void 0:s.call(i,...r)},onDestroy:(...r)=>{var i,s;return(s=(i=this.options.current).onDestroy)===null||s===void 0?void 0:s.call(i,...r)},onFocus:(...r)=>{var i,s;return(s=(i=this.options.current).onFocus)===null||s===void 0?void 0:s.call(i,...r)},onSelectionUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onSelectionUpdate)===null||s===void 0?void 0:s.call(i,...r)},onTransaction:(...r)=>{var i,s;return(s=(i=this.options.current).onTransaction)===null||s===void 0?void 0:s.call(i,...r)},onUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onUpdate)===null||s===void 0?void 0:s.call(i,...r)},onContentError:(...r)=>{var i,s;return(s=(i=this.options.current).onContentError)===null||s===void 0?void 0:s.call(i,...r)},onDrop:(...r)=>{var i,s;return(s=(i=this.options.current).onDrop)===null||s===void 0?void 0:s.call(i,...r)},onPaste:(...r)=>{var i,s;return(s=(i=this.options.current).onPaste)===null||s===void 0?void 0:s.call(i,...r)}};return new QN(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,s)=>{var o;return i===((o=n.extensions)===null||o===void 0?void 0:o[s])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Df.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function gM(t={},e=[]){const n=C.useRef(t);n.current=t;const[r]=C.useState(()=>new Df(n)),i=Rf.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return C.useDebugValue(i),C.useEffect(r.onRender(e)),hM({editor:i,selector:({transactionNumber:s})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&s===0?0:s+1}),i}const yM=C.createContext({editor:null});yM.Consumer;const vM=C.createContext({onDragStart:void 0}),wM=()=>C.useContext(vM);me.forwardRef((t,e)=>{const{onDragStart:n}=wM(),r=t.as||"div";return me.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const kM=/^\s*>\s$/,xM=Ze.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ks({find:kM,type:this.type})]}}),SM=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,bM=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,CM=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,EM=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,_M=sn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[_r({find:SM,type:this.type}),_r({find:CM,type:this.type})]},addPasteRules(){return[Tr({find:bM,type:this.type}),Tr({find:EM,type:this.type})]}}),TM="listItem",Nm="textStyle",Mm=/^\s*([-+*])\s$/,OM=Ze.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(TM,this.editor.getAttributes(Nm)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Ks({find:Mm,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ks({find:Mm,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Nm),editor:this.editor})),[t]}}),NM=/(^|[^`])`([^`]+)`(?!`)/,MM=/(^|[^`])`([^`]+)`(?!`)/g,PM=sn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[_r({find:NM,type:this.type})]},addPasteRules(){return[Tr({find:MM,type:this.type})]}}),AM=/^```([a-z]+)?[\s\n]$/,IM=/^~~~([a-z]+)?[\s\n]$/,RM=Ze.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,s=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Re(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:s}=n;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:u})=>(u.setSelection(z.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[sd({find:AM,type:this.type,getAttributes:t=>({language:t[1]})}),sd({find:IM,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new He({key:new Pt("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i==null?void 0:i.mode;if(!n||!s)return!1;const{tr:o,schema:l}=t.state,a=l.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:s},a)),o.selection.$from.parent.type!==this.type&&o.setSelection(j.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),DM=Ze.create({name:"doc",topNode:!0,content:"block+"});function jM(t={}){return new He({view(e){return new LM(e,t)}})}class LM{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,s=i.getBoundingClientRect(),o=s.width/i.offsetWidth,l=s.height/i.offsetHeight;if(n){let d=e.nodeBefore,f=e.nodeAfter;if(d||f){let h=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(h){let p=h.getBoundingClientRect(),m=d?p.bottom:p.top;d&&f&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let y=this.width/2*l;r={left:p.left,right:p.right,top:m-y,bottom:m+y}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),f=this.width/2*o;r={left:d.left-f,right:d.left+f,top:d.top,bottom:d.bottom}}let a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let u,c;if(!a||a==document.body&&getComputedStyle(a).position=="static")u=-pageXOffset,c=-pageYOffset;else{let d=a.getBoundingClientRect(),f=d.width/a.offsetWidth,h=d.height/a.offsetHeight;u=d.left-a.scrollLeft*f,c=d.top-a.scrollTop*h}this.element.style.left=(r.left-u)/o+"px",this.element.style.top=(r.top-c)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!s){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=cv(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const $M=De.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[jM(this.options)]}});class re extends z{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return re.valid(r)?new re(r):z.near(r)}content(){return N.empty}eq(e){return e instanceof re&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new re(e.resolve(n.pos))}getBookmark(){return new jf(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!zM(e)||!BM(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&re.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(n>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=n;let a=e.doc.resolve(i);if(re.valid(a))return a}for(;;){let o=n>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!I.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*n),r=!1;continue e}break}s=o,i+=n;let l=e.doc.resolve(i);if(re.valid(l))return l}return null}}}re.prototype.visible=!1;re.findFrom=re.findGapCursorFrom;z.jsonID("gapcursor",re);class jf{constructor(e){this.pos=e}map(e){return new jf(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return re.valid(n)?new re(n):z.near(n)}}function zM(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function BM(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function FM(){return new He({props:{decorations:WM,createSelectionBetween(t,e,n){return e.pos==n.pos&&re.valid(n)?new re(n):null},handleClick:VM,handleKeyDown:UM,handleDOMEvents:{beforeinput:HM}}})}const UM=Yv({ArrowLeft:Uo("horiz",-1),ArrowRight:Uo("horiz",1),ArrowUp:Uo("vert",-1),ArrowDown:Uo("vert",1)});function Uo(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,l=e>0?o.$to:o.$from,a=o.empty;if(o instanceof j){if(!s.endOfTextblock(n)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=re.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new re(u))),!0):!1}}function VM(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!re.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&I.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new re(r))),!0)}function HM(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof re))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=T.empty;for(let o=r.length-1;o>=0;o--)i=T.from(r[o].createAndFill(null,i));let s=t.state.tr.replace(n.pos,n.pos,new N(i,0,0));return s.setSelection(j.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function WM(t){if(!(t.selection instanceof re))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",oe.create(t.doc,[it.widget(t.selection.head,e,{key:"gapcursor"})])}const qM=De.create({name:"gapCursor",addProseMirrorPlugins(){return[FM()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=B(A(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),KM=Ze.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Re(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:s}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,a=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&a&&o){const d=a.filter(f=>l.includes(f.type.name));u.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),JM=Ze.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Re(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>sd({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var Vl=200,we=function(){};we.prototype.append=function(e){return e.length?(e=we.from(e),!this.length&&e||e.length<Vl&&this.leafAppend(e)||this.length<Vl&&e.leafPrepend(this)||this.appendInner(e)):this};we.prototype.prepend=function(e){return e.length?we.from(e).append(this):this};we.prototype.appendInner=function(e){return new GM(this,e)};we.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?we.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};we.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};we.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};we.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},n,r),i};we.from=function(e){return e instanceof we?e:e&&e.length?new bw(e):we.empty};var bw=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var a=s;a<o;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var a=s-1;a>=o;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Vl)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Vl)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(we);we.empty=new bw([]);var GM=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(we);const QM=500;class _t{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;n&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,l,a,u=[],c=[];return this.items.forEach((d,f)=>{if(!d.step){i||(i=this.remapping(r,f+1),s=i.maps.length),s--,c.push(d);return}if(i){c.push(new Rt(d.map));let h=d.step.map(i.slice(s)),p;h&&o.maybeStep(h).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],u.push(new Rt(p,void 0,void 0,u.length+c.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(d.step);if(d.selection)return l=i?d.selection.map(i.slice(s)):d.selection,a=new _t(this.items.slice(0,r).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,n,r,i){let s=[],o=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let c=0;c<e.steps.length;c++){let d=e.steps[c].invert(e.docs[c]),f=new Rt(e.mapping.maps[c],d,n),h;(h=a&&a.merge(f))&&(f=h,c?s.pop():l=l.slice(0,l.length-1)),s.push(f),n&&(o++,n=void 0),i||(a=f)}let u=o-r.depth;return u>XM&&(l=YM(l,u),o-=u),new _t(l.append(s),o)}remapping(e,n){let r=new Bs;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new _t(this.items.append(e.map(n=>new Rt(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(f=>{f.selection&&l--},i);let a=n;this.items.forEach(f=>{let h=s.getMirror(--a);if(h==null)return;o=Math.min(o,h);let p=s.maps[h];if(f.step){let m=e.steps[h].invert(e.docs[h]),y=f.selection&&f.selection.map(s.slice(a+1,h));y&&l++,r.push(new Rt(p,m,y))}else r.push(new Rt(p))},i);let u=[];for(let f=n;f<o;f++)u.push(new Rt(s.maps[f]));let c=this.items.slice(0,i).append(u).append(r),d=new _t(c,l);return d.emptyItemCount()>QM&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let a=o.step.map(n.slice(r)),u=a&&a.getMap();if(r--,u&&n.appendMap(u,r),a){let c=o.selection&&o.selection.map(n.slice(r));c&&s++;let d=new Rt(u.invert(),a,c),f,h=i.length-1;(f=i.length&&i[h].merge(d))?i[h]=f:i.push(d)}}else o.map&&r--},this.items.length,0),new _t(we.from(i.reverse()),s)}}_t.empty=new _t(we.empty,0);function YM(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class Rt{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Rt(n.getMap().invert(),n,this.selection)}}}class pn{constructor(e,n,r,i,s){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const XM=20;function ZM(t,e,n,r){let i=n.getMeta(gr),s;if(i)return i.historyState;n.getMeta(nP)&&(t=new pn(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(gr))return o.getMeta(gr).redo?new pn(t.done.addTransform(n,void 0,r,il(e)),t.undone,Pm(n.mapping.maps),t.prevTime,t.prevComposition):new pn(t.done,t.undone.addTransform(n,void 0,r,il(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),a=t.prevTime==0||!o&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!eP(n,t.prevRanges)),u=o?Iu(t.prevRanges,n.mapping):Pm(n.mapping.maps);return new pn(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,il(e)),_t.empty,u,n.time,l??t.prevComposition)}else return(s=n.getMeta("rebased"))?new pn(t.done.rebased(n,s),t.undone.rebased(n,s),Iu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new pn(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Iu(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function eP(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(n=!0)}),n}function Pm(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,s,o)=>e.push(s,o));return e}function Iu(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),s=e.map(t[r+1],-1);i<=s&&n.push(i,s)}return n}function tP(t,e,n){let r=il(e),i=gr.get(e).spec.config,s=(n?t.undone:t.done).popEvent(e,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(n?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),i,r),a=new pn(n?l:s.remaining,n?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(gr,{redo:n,historyState:a})}let Ru=!1,Am=null;function il(t){let e=t.plugins;if(Am!=e){Ru=!1,Am=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Ru=!0;break}}return Ru}const gr=new Pt("history"),nP=new Pt("closeHistory");function rP(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new He({key:gr,state:{init(){return new pn(_t.empty,_t.empty,null,0,-1)},apply(e,n,r){return ZM(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?Ew:r=="historyRedo"?_w:null;return i?(n.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function Cw(t,e){return(n,r)=>{let i=gr.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let s=tP(i,n,t);s&&r(e?s.scrollIntoView():s)}return!0}}const Ew=Cw(!1,!0),_w=Cw(!0,!0),iP=De.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>Ew(t,e),redo:()=>({state:t,dispatch:e})=>_w(t,e)}},addProseMirrorPlugins(){return[rP(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),sP=Ze.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Re(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!XN(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:r,$to:i}=n,s=t();return r.parentOffset===0?s.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):wN(n)?s.insertContentAt(i.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:o,dispatch:l})=>{var a;if(l){const{$to:u}=o.selection,c=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(j.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(I.create(o.doc,u.pos)):o.setSelection(j.create(o.doc,u.pos));else{const d=(a=u.parent.type.contentMatch.defaultType)===null||a===void 0?void 0:a.create();d&&(o.insert(c,d),o.setSelection(j.create(o.doc,c+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[YN({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),oP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,lP=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,aP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,uP=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,cP=sn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[_r({find:oP,type:this.type}),_r({find:aP,type:this.type})]},addPasteRules(){return[Tr({find:lP,type:this.type}),Tr({find:uP,type:this.type})]}}),dP=Ze.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Re(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),fP="listItem",Im="textStyle",Rm=/^(\d+)\.\s$/,hP=Ze.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Re(this.options.HTMLAttributes,n),0]:["ol",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(fP,this.editor.getAttributes(Im)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Ks({find:Rm,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ks({find:Rm,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Im)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),pP=Ze.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),mP=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,gP=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,yP=sn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[_r({find:mP,type:this.type})]},addPasteRules(){return[Tr({find:gP,type:this.type})]}}),vP=Ze.create({name:"text",group:"inline"}),wP=De.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(_M.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(xM.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(OM.configure(this.options.bulletList)),this.options.code!==!1&&t.push(PM.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(RM.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(DM.configure(this.options.document)),this.options.dropcursor!==!1&&t.push($M.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(qM.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(KM.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(JM.configure(this.options.heading)),this.options.history!==!1&&t.push(iP.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(sP.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(cP.configure(this.options.italic)),this.options.listItem!==!1&&t.push(dP.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(hP.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(pP.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(yP.configure(this.options.strike)),this.options.text!==!1&&t.push(vP.configure(this.options.text)),t}}),kP=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,xP=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,SP=sn.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",Re(this.options.HTMLAttributes,t),0]},addCommands(){return{setHighlight:t=>({commands:e})=>e.setMark(this.name,t),toggleHighlight:t=>({commands:e})=>e.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[_r({find:kP,type:this.type})]},addPasteRules(){return[Tr({find:xP,type:this.type})]}}),bP=De.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new He({key:new Pt("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!n)return null;const s=this.editor.isEmpty;return t.descendants((o,l)=>{const a=r>=l&&r<=l+o.nodeSize,u=!o.isLeaf&&Na(o);if((a||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];s&&c.push(this.options.emptyEditorClass);const d=it.node(l,l+o.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:l,hasAnchor:a}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),oe.create(t,i)}}})]}}),CP=SP.configure({multicolor:!0,HTMLAttributes:{class:"relative group"}}).extend({addAttributes(){var t;return{...(t=this.parent)==null?void 0:t.call(this),borderColor:{default:null,parseHTML:e=>e.getAttribute("data-border-color"),renderHTML:e=>e.borderColor?{"data-border-color":e.borderColor,style:`border-bottom: 2px solid ${e.borderColor}`}:{}},title:{default:null,parseHTML:e=>e.getAttribute("title"),renderHTML:e=>e.title?{title:e.title}:{}}}}});function EP({value:t,onChange:e,highlights:n=[],onApplyFix:r}){const i=gM({onBeforeCreate({editor:s}){s.setOptions({content:t===void 0?"":t})},editable:!0,extensions:[wP,CP,bP.configure({placeholder:"Start typing your text here...",emptyEditorClass:"is-editor-empty"})],content:t===void 0?"":t,autofocus:"end",onUpdate:({editor:s})=>{const o=s.getText();console.log("Editor content updated:",o),e(o)},onCreate:({editor:s})=>{console.log("Editor created with content:",s.getText())},editorProps:{attributes:{class:"prose prose-lg max-w-none focus:outline-none min-h-[200px] p-4"}}});return C.useEffect(()=>{i&&t!==void 0&&t!==i.getText()&&i.commands.setContent(t)},[i,t]),C.useEffect(()=>{if(!i)return;i.commands.unsetHighlight(),console.log("Highlights to apply:",n),[...n].sort((o,l)=>l.start-o.start).forEach(({start:o,end:l,type:a,incorrect:u,correction:c,message:d})=>{if(typeof o!="number"||typeof l!="number"||isNaN(o)||isNaN(l)||o<0||l<o){console.warn("Skipping invalid highlight:",{start:o,end:l,type:a});return}try{i.commands.setTextSelection({from:o+1,to:l+1});const f=a==="spelling"?"#fecaca":a==="grammar"?"#fef3c7":"#dbeafe",h=a==="spelling"?"#ef4444":a==="grammar"?"#f59e0b":"#3b82f6",p=d?`${d} | Suggestion: ${c}`:`${a.charAt(0).toUpperCase()+a.slice(1)} error: "${u}"  "${c}"`;i.commands.setHighlight({color:f,borderColor:h,title:p})}catch(f){console.error("Failed to apply highlight:",{start:o,end:l,type:a,error:f})}}),i.commands.setTextSelection(0)},[i,n]),k.jsxs("div",{className:"card flex-1 overflow-hidden bg-white rounded-lg shadow-sm border border-gray-200",children:[k.jsx("div",{className:"border-b border-gray-200 px-4 py-3",children:k.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Document Editor"})}),k.jsxs("div",{className:"h-full overflow-y-auto relative",children:[(!t||t.trim()==="")&&k.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:k.jsxs("div",{className:"text-center text-gray-400",children:[k.jsx("div",{className:"text-xl mb-2",children:""}),k.jsx("p",{className:"text-lg font-medium mb-1",children:"Start writing your document"}),k.jsx("p",{className:"text-sm",children:"Click here to begin typing..."})]})}),k.jsx("style",{children:`
            .ProseMirror {
              min-height: 200px;
              padding: 1rem;
              border-radius: 0.5rem;
              outline: none;
              background: white;
            }
            .ProseMirror.is-editor-empty:first-child::before {
              content: attr(data-placeholder);
              float: left;
              color: #adb5bd;
              pointer-events: none;
              height: 0;
              font-style: italic;
            }
            .ProseMirror.is-editor-empty:first-child > *:first-child {
              min-height: 1.5em;
            }
            .ProseMirror mark[data-border-color] {
              background: transparent;
              position: relative;
              cursor: help;
            }
            .ProseMirror mark[data-border-color]:hover::after {
              content: attr(title);
              position: absolute;
              left: 0;
              bottom: 100%;
              background: #1f2937;
              color: white;
              padding: 4px 8px;
              border-radius: 4px;
              font-size: 14px;
              white-space: nowrap;
              z-index: 10;
              transform: translateY(-4px);
            }
          `}),k.jsx(oM,{editor:i,className:"h-full"})]})]})}var _P={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const TP=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OP=(t,e)=>{const n=C.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:o,children:l,...a},u)=>C.createElement("svg",{ref:u,..._P,width:i,height:i,stroke:r,strokeWidth:o?Number(s)*24/Number(i):s,className:`lucide lucide-${TP(t)}`,...a},[...e.map(([c,d])=>C.createElement(c,d)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n};var q=OP;const NP=q("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),MP=q("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Tw=q("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),Ow=q("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Nw=q("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),PP=q("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),AP=q("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),IP=q("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),RP=q("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),DP=q("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),jP=q("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),LP=q("FilePlus",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"12",x2:"12",y1:"18",y2:"12",key:"1tsf04"}],["line",{x1:"9",x2:"15",y1:"15",y2:"15",key:"110plj"}]]),Ci=q("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Ai=q("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),$P=q("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),zP=q("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),BP=q("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]),FP=q("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Mw=q("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]),UP=q("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),VP=q("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),HP=q("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Pw=q("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),WP=q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Aw=q("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),qP=q("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),KP=q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),JP=q("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),GP=[{name:"spellcheck",label:"Grammar Check"},{name:"argument-mapper",label:"Argument Graph"},{name:"citation-annotator",label:"Citation Fixer"},{name:"optimize-thesis",label:"Thesis Optimizer"},{name:"virtual-reviewer",label:"Reviewer"},{name:"abstract-synthesizer",label:"Abstract"}];class QP{constructor(){Di(this,"publicKey");Di(this,"privateKey");Di(this,"apiUrl","https://api.sapling.ai/api/v1/edits");Di(this,"isInitialized",!1);this.publicKey="DPu9vrZwZJi0MrHwyS19vaLFdCcoykh-DScRq8J_ONEzc_yQJCYzdhsuuz6vVlhc_2xbRBtLD2l6dqnkWVhpTA%3D%3D",this.privateKey="UOVD1B3WB6VMTSUA5YMTV983SJQ8QYSR"}async initialize(){if(!this.isInitialized)try{await this.testConnection(),this.isInitialized=!0,console.log("Sapling grammar checker initialized successfully")}catch(e){console.error("Failed to initialize Sapling:",e),this.isInitialized=!1}}async testConnection(){const n=await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:this.privateKey,text:"This is a test.",session_id:"test-session"})});if(!n.ok){const r=await n.text();throw console.error("Sapling API test error response:",r),new Error(`Sapling API test failed: ${n.status} ${n.statusText} - ${r}`)}}async checkText(e){if(await this.initialize(),!this.isInitialized)return console.warn("Sapling service not available, returning empty results"),[];if(!e||e.trim().length===0)return console.log("Empty text provided, returning empty results"),[];try{console.log("Checking text with Sapling:",e.substring(0,100)+(e.length>100?"...":""));const n=await fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:this.privateKey,text:e,session_id:`session-${Date.now()}`})});if(!n.ok){const s=await n.text();throw console.error("Sapling API error response:",s),new Error(`Sapling API request failed: ${n.status} ${n.statusText} - ${s}`)}const r=await n.json();console.log("Sapling API response:",r),r.edits&&r.edits.length>0&&(console.log("Raw edits from Sapling:"),r.edits.forEach((s,o)=>{console.log(`Edit ${o+1}:`,{error_type:s.error_type,general_error_type:s.general_error_type,start:s.start,end:s.end,sentence_start:s.sentence_start,replacement:s.replacement,sentence:s.sentence})}));const i=this.convertEditsToErrors(r.edits||[],e);return console.log("Converted errors:",i),i}catch(n){return console.error("Sapling text checking failed:",n),[]}}isAvailable(){return this.isInitialized}convertEditsToErrors(e,n){return e.map(r=>{const i=r.sentence_start+r.start,s=r.sentence_start+r.end,o=Math.max(0,Math.min(i,n.length)),l=Math.max(o,Math.min(s,n.length));return{start:o,end:l,message:this.generateErrorMessage(r),type:this.classifyErrorType(r),incorrect:n.slice(o,l),correction:r.replacement||""}})}generateErrorMessage(e){const n=e.general_error_type||"",r=e.error_type||"",i=e.replacement;return i?n.toLowerCase().includes("spelling")?`Spelling: "${i}" may be the correct spelling`:n.toLowerCase().includes("grammar")?`Grammar: Consider changing to "${i}"`:n.toLowerCase().includes("punctuation")?`Punctuation: Consider using "${i}"`:`${n||r}: Consider changing to "${i}"`:`${n||r||"Issue"} detected`}classifyErrorType(e){const n=(e.general_error_type||"").toLowerCase(),r=(e.error_type||"").toLowerCase();if(n.includes("spelling"))return"spelling";if(n.includes("punctuation"))return"punctuation";if(n.includes("grammar"))return"grammar";const i=n||r;return i.includes("spell")||i.includes("misspell")||i.includes("typo")||i.includes("word_choice")?"spelling":i.includes("punct")||i.includes("comma")||i.includes("period")||i.includes("apostrophe")||i.includes("quotation")||i.includes("colon")||i.includes("semicolon")?"punctuation":(i.includes("grammar")||i.includes("syntax")||i.includes("agreement")||i.includes("tense")||i.includes("capitalization")||i.includes("spacing")||i.includes("word_order")||i.includes("article")||i.includes("preposition")||i.includes("verb")||i.includes("noun")||i.includes("adjective"),"grammar")}}const YP=new QP;async function XP(t){if(!t.trim())return{errors:[]};try{return{errors:await YP.checkText(t)}}catch(e){return console.error("Sapling text checking failed:",e),{errors:[]}}}const ao={async synthesizeAbstract(t,e){const n=await fetch("https://rjkunveqbiltuhetakmm.supabase.co/functions/v1/optimize-thesis",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentId:t,text:e})});if(!n.ok)throw new Error("Thesis optimization failed");const r=n.headers.get("Content-Type");return r!=null&&r.includes("application/json")?await n.json():await n.text()},async generateArgumentMap(t,e){try{const n=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are an expert at analyzing arguments and creating argument maps. Analyze the following text and create a well-formatted, structured analysis of the main arguments, supporting evidence, and logical connections. Use clear headings, bullet points, and organize the content for easy reading."},{role:"user",content:e}]})});if(!n.ok){const s=await n.text();throw new Error(`OpenAI API error: ${s}`)}return(await n.json()).choices[0].message.content}catch(n){throw console.error("Argument mapper error:",n),new Error(n instanceof Error?n.message:"Failed to generate argument map")}},async suggestCitations(t,e){const n=await fetch("https://rjkunveqbiltuhetakmm.supabase.co/functions/v1/citation-annotator",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentId:t,text:e})});if(!n.ok)throw new Error("Citation annotation failed");const r=n.headers.get("Content-Type");return r!=null&&r.includes("application/json")?await n.json():await n.text()},async runVirtualReview(t,e){const n=await fetch("https://rjkunveqbiltuhetakmm.supabase.co/functions/v1/virtual-reviewer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentId:t,text:e})});if(!n.ok)throw new Error("Reviewer feedback failed");const r=n.headers.get("Content-Type");return r!=null&&r.includes("application/json")?await n.json():await n.text()},async generateAbstract(t,e){const n=await fetch("https://rjkunveqbiltuhetakmm.supabase.co/functions/v1/abstract-synthesizer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentId:t,text:e})});if(!n.ok)throw new Error("Abstract generation failed");const r=n.headers.get("Content-Type");return r!=null&&r.includes("application/json")?await n.json():await n.text()}};function uo({title:t,content:e,isLoading:n=!1}){const[r,i]=C.useState(!1),s=async()=>{try{await navigator.clipboard.writeText(e),i(!0),setTimeout(()=>i(!1),2e3)}catch(l){console.error("Failed to copy text:",l)}},o=l=>{var p;const u=l.replace(/^\s*[\[\{]\s*$/gm,"").replace(/^\s*[\]\}]\s*$/gm,"").replace(/\}\s*$/gm,"").replace(/\{\s*$/gm,"").replace(/```[a-zA-Z]*\n?/g,"").replace(/\*\*\*([^*]+)\*\*\*/g,"**$1**").replace(/^\s*"([^"]+)"\s*$/gm,"$1").replace(/^\s*"([^"]+)"\s*,?\s*$/gm,"$1").replace(/^\s*,\s*$/gm,"").trim().split(`
`),c=[];let d=[],f=null;const h=()=>{if(d.length>0){const m=f==="ordered"?"ol":"ul",y=f==="ordered"?"list-decimal list-inside space-y-3 mb-6 pl-4 bg-gray-50 rounded-lg p-4":"list-disc list-inside space-y-3 mb-6 pl-4 bg-blue-50 rounded-lg p-4 border-l-4 border-blue-200";c.push(k.jsx(m,{className:y,children:d.map((g,v)=>{const x=g.match(/^(Citation|Source|Reference|Suggested|Recommended)\s*:?/i)?"text-gray-800 leading-relaxed font-medium":"text-gray-700 leading-relaxed";return k.jsx("li",{className:x,children:g},v)})},c.length)),d=[],f=null}};for(let m=0;m<u.length;m++){const y=u[m].trim();if(!y){h();continue}if(y.startsWith("#")){h();const g=((p=y.match(/^#+/))==null?void 0:p[0].length)||1,v=y.replace(/^#+\s*/,"").replace(/\*\*/g,""),w=`h${Math.min(g+2,6)}`,x=g===1?"text-xl font-bold text-gray-900 mt-6 mb-4 first:mt-0 border-b border-gray-200 pb-2":g===2?"text-lg font-semibold text-gray-900 mt-5 mb-3 first:mt-0":"text-base font-semibold text-gray-900 mt-4 mb-2 first:mt-0";c.push(k.jsx(w,{className:x,children:v},c.length))}else if(y.match(/^\*\*[^*]+\*\*\s*:?\s*$/)||y.match(/^\*\*[A-Z][^*]*\*\*$/)){h();const g=y.replace(/\*\*/g,"").replace(/:$/,"");c.push(k.jsx("h4",{className:"text-lg font-semibold text-gray-900 mt-5 mb-3 first:mt-0 text-blue-800",children:g},c.length))}else if(y.match(/^(Citation[s]?\s*(Needed|Required|Suggestions?)|Sources?|References?|Recommended\s*Citations?)\s*:?\s*$/i))h(),c.push(k.jsx("h4",{className:"text-lg font-semibold text-blue-700 mt-5 mb-3 first:mt-0 border-l-4 border-blue-500 pl-3",children:y.replace(/:$/,"")},c.length));else if(y.length<80&&y===y.toUpperCase()&&y.includes(" ")&&!y.match(/^\d+\.|^[\-\*]/))h(),c.push(k.jsx("h4",{className:"text-base font-semibold text-gray-900 mt-4 mb-2 first:mt-0",children:y},c.length));else if(y.match(/^\d+\.\s/)){const g=y.replace(/^\d+\.\s*/,"");f!=="ordered"&&(h(),f="ordered"),d.push(g)}else if(y.match(/^[\-\*]\s/)||y.match(/^\s*[\-\*]\s/)||y.match(/^\s*[]\s/)){const g=y.replace(/^\s*[\-\*]\s*/,"").replace(/\*\*/g,"");f!=="unordered"&&(h(),f="unordered"),d.push(g)}else if(y.match(/^\s*[\-\*]\s*(Citation|Source|Reference|Suggested|Recommended)\s*:?/i)){const g=y.replace(/^\s*[\-\*]\s*/,"");f!=="unordered"&&(h(),f="unordered"),d.push(g)}else{h();let g=y,v=m+1;for(;v<u.length&&u[v].trim()&&!u[v].trim().startsWith("#")&&!u[v].trim().match(/^\d+\.\s/)&&!u[v].trim().match(/^[\-\*]\s/)&&!(u[v].trim().length<80&&u[v].trim()===u[v].trim().toUpperCase()&&u[v].trim().includes(" "));)g+=" "+u[v].trim(),v++;if(m=v-1,g){const w=g.split(/\*\*([^*]+)\*\*/).map((x,b)=>b%2===1?k.jsx("strong",{className:"font-semibold",children:x},b):x);c.push(k.jsx("p",{className:"text-gray-700 mb-4 leading-relaxed",children:w},c.length))}}}return h(),c};return n?k.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:k.jsxs("div",{className:"animate-pulse",children:[k.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/4 mb-4"}),k.jsxs("div",{className:"space-y-3",children:[k.jsx("div",{className:"h-3 bg-gray-300 rounded w-full"}),k.jsx("div",{className:"h-3 bg-gray-300 rounded w-5/6"}),k.jsx("div",{className:"h-3 bg-gray-300 rounded w-4/6"})]})]})}):k.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[k.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50",children:[k.jsx("h5",{className:"font-semibold text-gray-900",children:t}),k.jsx("button",{onClick:s,className:"flex items-center space-x-1 text-sm text-gray-600 hover:text-gray-900 transition-colors",title:"Copy to clipboard",children:r?k.jsxs(k.Fragment,{children:[k.jsx(Nw,{className:"w-4 h-4 text-green-600"}),k.jsx("span",{className:"text-green-600",children:"Copied!"})]}):k.jsxs(k.Fragment,{children:[k.jsx(jP,{className:"w-4 h-4"}),k.jsx("span",{children:"Copy"})]})})]}),k.jsx("div",{className:"p-6",children:k.jsx("div",{className:"prose prose-sm max-w-none text-gray-800",children:o(e)})})]})}function ZP({documentId:t,documentText:e}){const[n,r]=C.useState(!1),[i,s]=C.useState(null),o=async()=>{if(!e.trim()){s("Please add some content to your document first.");return}r(!0);try{const l=await ao.synthesizeAbstract(t,e);s(typeof l=="string"?l:JSON.stringify(l,null,2))}catch(l){s(`Error: ${l instanceof Error?l.message:"Unknown error"}`)}finally{r(!1)}};return k.jsxs("div",{className:"p-6 space-y-6",children:[k.jsxs("div",{className:"flex items-start space-x-4",children:[k.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:k.jsx(Pw,{className:"w-6 h-6 text-orange-600"})}),k.jsxs("div",{className:"flex-1",children:[k.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Thesis Optimizer"}),k.jsx("p",{className:"text-gray-600 mb-4",children:"Analyze and strengthen your thesis statement to make it more compelling, clear, and academically rigorous."}),k.jsx("button",{onClick:o,disabled:n,className:"btn-primary",children:n?k.jsxs(k.Fragment,{children:[k.jsx(Ai,{className:"w-4 h-4 mr-2 animate-spin"}),"Optimizing Thesis..."]}):k.jsxs(k.Fragment,{children:[k.jsx(JP,{className:"w-4 h-4 mr-2"}),"Optimize Thesis"]})})]})]}),(i||n)&&k.jsx(uo,{title:"Thesis Optimization",content:i||"",isLoading:n})]})}function eA({documentId:t,documentText:e}){const[n,r]=C.useState(!1),[i,s]=C.useState(null),o=async()=>{if(!e.trim()){s("Please add some content to your document first.");return}r(!0);try{console.log("Sending text to argument mapper:",e);const l=await ao.generateArgumentMap(t,e);console.log("Argument mapper response:",l),s(typeof l=="string"?l:JSON.stringify(l,null,2))}catch(l){console.error("Argument mapper error:",l),s(`Error: ${l instanceof Error?l.message:"Unknown error"}`)}finally{r(!1)}};return k.jsxs("div",{className:"p-6 space-y-6",children:[k.jsxs("div",{className:"flex items-start space-x-4",children:[k.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:k.jsx(Tw,{className:"w-6 h-6 text-purple-600"})}),k.jsxs("div",{className:"flex-1",children:[k.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Argument Mapper"}),k.jsx("p",{className:"text-gray-600 mb-4",children:"Analyze your document's logical structure and create a visual map of arguments, claims, and supporting evidence."}),k.jsx("button",{onClick:o,disabled:n,className:"btn-primary",children:n?k.jsxs(k.Fragment,{children:[k.jsx(Ai,{className:"w-4 h-4 mr-2 animate-spin"}),"Analyzing Arguments..."]}):k.jsxs(k.Fragment,{children:[k.jsx(BP,{className:"w-4 h-4 mr-2"}),"Generate Argument Map"]})})]})]}),(i||n)&&k.jsx(uo,{title:"Argument Analysis",content:i||"",isLoading:n})]})}const tA=t=>{const e=(n,r=0)=>typeof n=="string"?n:Array.isArray(n)?n.map(i=>typeof i=="string"?` ${i}`:typeof i=="object"&&i!==null?e(i,r+1):` ${String(i)}`).join(`
`):typeof n=="object"&&n!==null?Object.entries(n).map(([i,s])=>{const o=i.replace(/([A-Z])/g," $1").replace(/^./,l=>l.toUpperCase()).replace(/\s+/g," ").trim();return Array.isArray(s)?`## ${o}

${e(s,r+1)}`:typeof s=="object"&&s!==null?`## ${o}

${e(s,r+1)}`:`**${o}:** ${String(s)}`}).join(`

`):String(n);return e(t)};function nA({documentId:t,documentText:e}){const[n,r]=C.useState(!1),[i,s]=C.useState(null),o=async()=>{if(!e.trim()){s("Please add some content to your document first.");return}r(!0);try{const l=await ao.suggestCitations(t,e);let a;typeof l=="string"?a=l:typeof l=="object"&&l!==null?a=tA(l):a=String(l),s(a)}catch(l){s(`Error: ${l instanceof Error?l.message:"Unknown error"}`)}finally{r(!1)}};return k.jsxs("div",{className:"p-6 space-y-6",children:[k.jsxs("div",{className:"flex items-start space-x-4",children:[k.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:k.jsx(Mw,{className:"w-6 h-6 text-green-600"})}),k.jsxs("div",{className:"flex-1",children:[k.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Citation Harmonizer"}),k.jsx("p",{className:"text-gray-600 mb-4",children:"Identify areas that need citations and suggest relevant sources to strengthen your arguments and claims."}),k.jsx("button",{onClick:o,disabled:n,className:"btn-primary",children:n?k.jsxs(k.Fragment,{children:[k.jsx(Ai,{className:"w-4 h-4 mr-2 animate-spin"}),"Finding Citations..."]}):k.jsxs(k.Fragment,{children:[k.jsx(MP,{className:"w-4 h-4 mr-2"}),"Suggest Citations"]})})]})]}),(i||n)&&k.jsx(uo,{title:"Citation Suggestions",content:i||"",isLoading:n})]})}function rA({documentId:t,documentText:e}){const[n,r]=C.useState(!1),[i,s]=C.useState(null),o=async()=>{if(!e.trim()){s("Please add some content to your document first.");return}r(!0);try{const l=await ao.runVirtualReview(t,e);s(typeof l=="string"?l:JSON.stringify(l,null,2))}catch(l){s(`Error: ${l instanceof Error?l.message:"Unknown error"}`)}finally{r(!1)}};return k.jsxs("div",{className:"p-6 space-y-6",children:[k.jsxs("div",{className:"flex items-start space-x-4",children:[k.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:k.jsx(Aw,{className:"w-6 h-6 text-blue-600"})}),k.jsxs("div",{className:"flex-1",children:[k.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Virtual Reviewer"}),k.jsx("p",{className:"text-gray-600 mb-4",children:"Get comprehensive feedback on your writing from an AI reviewer that evaluates structure, clarity, and academic rigor."}),k.jsx("button",{onClick:o,disabled:n,className:"btn-primary",children:n?k.jsxs(k.Fragment,{children:[k.jsx(Ai,{className:"w-4 h-4 mr-2 animate-spin"}),"Reviewing Document..."]}):k.jsxs(k.Fragment,{children:[k.jsx(zP,{className:"w-4 h-4 mr-2"}),"Get Review"]})})]})]}),(i||n)&&k.jsx(uo,{title:"Review Feedback",content:i||"",isLoading:n})]})}function iA({documentId:t,documentText:e}){const[n,r]=C.useState(!1),[i,s]=C.useState(null),o=async()=>{if(!e.trim()){s("Please add some content to your document first.");return}r(!0);try{const l=await ao.generateAbstract(t,e);s(typeof l=="string"?l:JSON.stringify(l,null,2))}catch(l){s(`Error: ${l instanceof Error?l.message:"Unknown error"}`)}finally{r(!1)}};return k.jsxs("div",{className:"p-6 space-y-6",children:[k.jsxs("div",{className:"flex items-start space-x-4",children:[k.jsx("div",{className:"p-3 bg-primary-100 rounded-lg",children:k.jsx(Ci,{className:"w-6 h-6 text-primary-600"})}),k.jsxs("div",{className:"flex-1",children:[k.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Abstract Synthesizer"}),k.jsx("p",{className:"text-gray-600 mb-4",children:"Generate a comprehensive abstract that summarizes your document's key points, methodology, and conclusions."}),k.jsx("button",{onClick:o,disabled:n,className:"btn-primary",children:n?k.jsxs(k.Fragment,{children:[k.jsx(Ai,{className:"w-4 h-4 mr-2 animate-spin"}),"Synthesizing Abstract..."]}):k.jsxs(k.Fragment,{children:[k.jsx(HP,{className:"w-4 h-4 mr-2"}),"Generate Abstract"]})})]})]}),(i||n)&&k.jsx(uo,{title:"Generated Abstract",content:i||"",isLoading:n})]})}function sA({documentId:t,documentText:e,onErrorsChange:n,onApplyFix:r}){const[i,s]=C.useState(!1),[o,l]=C.useState([]),[a,u]=C.useState();return C.useEffect(()=>{let c=!0,d=null;return d=setTimeout(async()=>{if(!e.trim()){c&&(l([]),n==null||n([]));return}try{if(!c)return;s(!0),u(void 0);const h=await XP(e);if(!c)return;const p=h.errors||[];l(p),n==null||n(p)}catch(h){if(!c)return;const p=h instanceof Error?h.message:"Failed to check grammar";console.error("Grammar check error:",p),u(p),l([]),n==null||n([])}finally{c&&s(!1)}},1e3),()=>{c=!1,d&&clearTimeout(d)}},[t,e]),a?k.jsx("div",{className:"p-4 text-red-500",children:k.jsx("p",{children:a})}):i?k.jsx("div",{className:"flex items-center justify-center p-8",children:k.jsx(Ai,{className:"w-6 h-6 animate-spin text-gray-400"})}):k.jsxs("div",{className:"p-4",children:[k.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Grammar & Spelling Check"}),o.length===0?k.jsx("p",{className:"text-green-600",children:"No errors found"}):k.jsx("ul",{className:"space-y-3",children:o.map((c,d)=>{c.type==="spelling"||c.type;const f=c.type==="spelling"?"bg-red-50":c.type==="grammar"?"bg-yellow-50":"bg-blue-50",h=c.type==="spelling"?"border-red-100":c.type==="grammar"?"border-yellow-100":"border-blue-100",p=c.type==="spelling"?"text-red-600":c.type==="grammar"?"text-yellow-600":"text-blue-600";return k.jsxs("li",{className:`p-3 ${f} border ${h} rounded-lg`,children:[k.jsxs("div",{className:"flex items-start justify-between",children:[k.jsxs("div",{className:"flex-1",children:[k.jsxs("div",{className:"flex items-start",children:[k.jsxs("span",{className:`${p} font-medium`,children:[c.type.charAt(0).toUpperCase()+c.type.slice(1),":"]}),k.jsx("p",{className:"ml-2 text-gray-700",children:c.message})]}),k.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:['Context: "',e.slice(Math.max(0,c.start-10),c.start),'"',k.jsx("span",{className:`${p} font-semibold`,children:e.slice(c.start,c.end)}),'"',e.slice(c.end,Math.min(e.length,c.end+10)),'"']})]}),r&&k.jsx("button",{onClick:()=>r(c.start,c.end,c.correction),className:`ml-3 px-3 py-1 text-sm font-medium text-white rounded-md transition-colors ${c.type==="spelling"?"bg-red-500 hover:bg-red-600":c.type==="grammar"?"bg-yellow-500 hover:bg-yellow-600":"bg-blue-500 hover:bg-blue-600"}`,title:`Apply fix: ${c.correction}`,children:"Fix"})]}),k.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[k.jsx("strong",{children:"Suggestion:"}),' "',c.correction,'"']})]},d)})})]})}const oA={spellcheck:Nw,"argument-mapper":Tw,"citation-annotator":Mw,"optimize-thesis":Pw,"virtual-reviewer":Aw,"abstract-synthesizer":Ci};function lA({onGrammarErrorsChange:t,onApplyFix:e}={}){const[n,r]=C.useState("spellcheck"),[i,s]=C.useState(!0),{currentDoc:o}=ma(),l=()=>{if(!o)return k.jsxs("div",{className:"p-8 text-center text-gray-500",children:[k.jsx(Ci,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),k.jsx("p",{children:"No document loaded"})]});switch(n){case"spellcheck":return k.jsx(sA,{documentId:o.id,documentText:o.content||"",onErrorsChange:t,onApplyFix:e});case"argument-mapper":return k.jsx(eA,{documentId:o.id,documentText:o.content||""});case"citation-annotator":return k.jsx(nA,{documentId:o.id,documentText:o.content||""});case"optimize-thesis":return k.jsx(ZP,{documentId:o.id,documentText:o.content||""});case"virtual-reviewer":return k.jsx(rA,{documentId:o.id,documentText:o.content||""});case"abstract-synthesizer":return k.jsx(iA,{documentId:o.id,documentText:o.content||""});default:return k.jsx("div",{className:"p-4",children:"Unknown tool"})}};return k.jsxs("div",{className:"card",children:[k.jsxs("div",{className:"border-b border-gray-200",children:[k.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[k.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Writing Tools"}),k.jsx("button",{onClick:()=>s(!i),className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:i?k.jsx(RP,{className:"w-5 h-5 text-gray-500"}):k.jsx(PP,{className:"w-5 h-5 text-gray-500"})})]}),i&&k.jsx("div",{className:"flex overflow-x-auto px-6",children:GP.map(a=>{const u=oA[a.name];return k.jsxs("button",{onClick:()=>r(a.name),className:`flex items-center space-x-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${n===a.name?"border-primary-500 text-primary-600 bg-primary-50":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:[k.jsx(u,{className:"w-4 h-4"}),k.jsx("span",{children:a.label})]},a.name)})})]}),i&&k.jsx("div",{className:"min-h-[300px]",children:l()})]})}function aA({onNewDocument:t,onSave:e}){const{currentDoc:n,updateTitle:r}=ma(),i=sf(),[s,o]=C.useState(!1),[l,a]=C.useState(""),u=async()=>{try{await YC(),i("/login")}catch(f){console.error("Failed to log out:",f)}},c=()=>{a((n==null?void 0:n.title)||"Untitled Document"),o(!0)},d=async()=>{if(!n||l.trim()===""){o(!1);return}const f=l.trim();if(f===n.title){o(!1);return}try{r(f),o(!1),n.id.startsWith("local-")||(await tE(n.id,f),console.log("Title updated successfully"))}catch(h){console.error("Failed to update title:",h),r(n.title),a(n.title)}};return k.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsxs("div",{className:"flex items-center space-x-4",children:[k.jsxs("div",{className:"flex items-center space-x-2",children:[k.jsx(Ci,{className:"w-6 h-6 text-primary-600"}),k.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Word-Wise"})]}),k.jsx("div",{className:"h-6 w-px bg-gray-300"}),k.jsx("div",{className:"text-sm text-gray-600",children:s?k.jsx("input",{type:"text",value:l,onChange:f=>a(f.target.value),onBlur:d,onKeyDown:f=>{f.key==="Enter"?d():f.key==="Escape"&&(o(!1),a((n==null?void 0:n.title)||"Untitled Document"))},className:"bg-transparent border-b border-gray-300 focus:border-primary-500 focus:outline-none px-1 py-0.5",autoFocus:!0}):k.jsx("button",{onClick:c,className:"hover:bg-gray-100 px-2 py-1 rounded transition-colors",title:"Click to edit title",children:(n==null?void 0:n.title)||"Untitled Document"})})]}),k.jsxs("div",{className:"flex items-center space-x-3",children:[k.jsxs("button",{onClick:t,className:"btn-secondary",children:[k.jsx(LP,{className:"w-4 h-4 mr-2"}),"New Document"]}),k.jsx("button",{className:"btn-ghost",children:k.jsx(VP,{className:"w-4 h-4"})}),k.jsxs("button",{onClick:e,className:"btn-secondary",disabled:!e,children:[k.jsx(UP,{className:"w-4 h-4 mr-2"}),"Save"]}),k.jsx("button",{onClick:u,className:"btn-ghost text-gray-600 hover:text-gray-900",children:k.jsx($P,{className:"w-4 h-4"})})]})]})})}function uA({isCollapsed:t,onToggle:e}){const[n,r]=C.useState([]),[i,s]=C.useState(!1),{currentDoc:o,setDoc:l,setDocumentListRefreshCallback:a}=ma();C.useEffect(()=>{u(),a(u)},[a]);const u=async()=>{try{const p=await eE();r(p)}catch(p){console.error("Failed to load documents:",p)}},c=async()=>{if(!i){s(!0);try{const p=await zc("Untitled Document");l(p),await u()}catch(p){console.error("Failed to create document:",p)}finally{s(!1)}}},d=p=>{l(p)},f=async(p,m)=>{if(m.stopPropagation(),!!confirm("Are you sure you want to delete this document?"))try{if(await nE(p),(o==null?void 0:o.id)===p){const y=n.filter(g=>g.id!==p);l(y.length>0?y[0]:null)}await u()}catch(y){console.error("Failed to delete document:",y)}},h=p=>{const m=new Date(p),g=Math.floor((new Date().getTime()-m.getTime())/(1e3*60*60));if(g<1)return"Just now";if(g<24)return`${g} hours ago`;const v=Math.floor(g/24);return v===1?"1 day ago":v<7?`${v} days ago`:m.toLocaleDateString()};return k.jsx("aside",{className:`bg-white border-r border-gray-200 transition-all duration-300 ${t?"w-16":"w-64"}`,children:k.jsxs("div",{className:"p-4",children:[k.jsxs("div",{className:"flex items-center justify-between mb-6",children:[!t&&k.jsx("h2",{className:"text-sm font-medium text-gray-900",children:"Documents"}),k.jsx("button",{onClick:e,className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors",children:t?k.jsx(IP,{className:"w-4 h-4 text-gray-500"}):k.jsx(AP,{className:"w-4 h-4 text-gray-500"})})]}),!t&&k.jsxs(k.Fragment,{children:[k.jsxs("button",{onClick:c,disabled:i,className:"btn-primary w-full mb-4 disabled:opacity-50",children:[k.jsx(FP,{className:"w-4 h-4 mr-2"}),i?"Creating...":"New Document"]}),k.jsxs("div",{className:"space-y-2",children:[n.map(p=>k.jsx("div",{onClick:()=>d(p),className:`group p-3 rounded-lg cursor-pointer transition-colors ${(o==null?void 0:o.id)===p.id?"bg-primary-50 border border-primary-200":"hover:bg-gray-50"}`,children:k.jsxs("div",{className:"flex items-start space-x-3",children:[k.jsx(Ci,{className:`w-4 h-4 mt-0.5 ${(o==null?void 0:o.id)===p.id?"text-primary-600":"text-gray-400 group-hover:text-primary-500"}`}),k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsx("p",{className:`text-sm font-medium truncate ${(o==null?void 0:o.id)===p.id?"text-primary-900":"text-gray-900"}`,children:p.title||"Untitled Document"}),k.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h(p.updated_at||p.created_at)})]}),k.jsx("button",{onClick:m=>f(p.id,m),className:"p-1 hover:bg-gray-200 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:k.jsx(WP,{className:"w-4 h-4 text-gray-500 hover:text-red-500"})})]})},p.id)),n.length===0&&k.jsxs("div",{className:"text-center py-8 text-gray-500",children:[k.jsx(Ci,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),k.jsx("p",{className:"text-sm",children:"No documents yet"}),k.jsx("p",{className:"text-xs",children:"Create your first document"})]})]})]})]})})}function cA({wordCount:t,issueCount:e,lastSaved:n}){return k.jsx("div",{className:"bg-white border-t border-gray-200 px-6 py-2",children:k.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[k.jsxs("div",{className:"flex items-center space-x-6",children:[k.jsx("div",{className:"flex items-center space-x-1",children:k.jsxs("span",{children:[t," words"]})}),k.jsx("div",{className:"flex items-center space-x-1",children:e>0?k.jsxs(k.Fragment,{children:[k.jsx(NP,{className:"w-4 h-4 text-amber-500"}),k.jsxs("span",{className:"text-amber-600",children:[e," issues"]})]}):k.jsxs(k.Fragment,{children:[k.jsx(Ow,{className:"w-4 h-4 text-green-500"}),k.jsx("span",{className:"text-green-600",children:"No issues"})]})})]}),n&&k.jsxs("div",{className:"flex items-center space-x-1",children:[k.jsx(DP,{className:"w-4 h-4"}),k.jsxs("span",{children:["Saved ",n]})]})]})})}function dA({message:t,type:e,onClose:n,duration:r=3e3}){C.useEffect(()=>{const a=setTimeout(()=>{n()},r);return()=>clearTimeout(a)},[n,r]);const i=e==="success"?"bg-green-50 border-green-200":"bg-red-50 border-red-200",s=e==="success"?"text-green-800":"text-red-800",o=e==="success"?"text-green-400":"text-red-400",l=e==="success"?Ow:qP;return k.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center p-4 border rounded-lg shadow-lg ${i} ${s} max-w-sm`,children:[k.jsx(l,{className:`w-5 h-5 mr-3 ${o}`}),k.jsx("span",{className:"flex-1 text-sm font-medium",children:t}),k.jsx("button",{onClick:n,className:`ml-3 ${o} hover:opacity-70`,children:k.jsx(KP,{className:"w-4 h-4"})})]})}function fA({toasts:t,onRemoveToast:e}){return k.jsx(k.Fragment,{children:t.map(n=>k.jsx(dA,{message:n.message,type:n.type,onClose:()=>e(n.id)},n.id))})}function hA(){const[t,e]=C.useState([]),n=(o,l)=>{const a=Date.now().toString();e(u=>[...u,{id:a,message:o,type:l}])};return{toasts:t,showSuccess:o=>n(o,"success"),showError:o=>n(o,"error"),removeToast:o=>{e(l=>l.filter(a=>a.id!==o))}}}function pA(){const{currentDoc:t,setDoc:e,updateContent:n,refreshDocuments:r}=ma(),{toasts:i,showSuccess:s,showError:o,removeToast:l}=hA();C.useEffect(()=>{if(!t){const S={id:"local-"+Date.now(),title:"Untitled Document",content:""};console.log("Initializing with local document:",S),e(S)}},[t,e]);const[a,u]=C.useState([]),[c,d]=C.useState([]),[f,h]=C.useState(!1),[p,m]=C.useState(0),y=async()=>{try{const S=await zc();e(S)}catch(S){console.error("Failed to create new document:",S)}};C.useEffect(()=>{if(t!=null&&t.content){const S=t.content.trim().split(/\s+/).filter(E=>E.length>0);m(S.length)}else m(0)},[t==null?void 0:t.content]);const[g,v]=C.useState([]),w=(S,E,_)=>{if(!t)return;const D=t.content||"",R=D.slice(0,S)+_+D.slice(E);n(R)};C.useEffect(()=>{d(g),u(g)},[g]);const x=async()=>{var S;if(t){console.log("Attempting to save document:",{id:t.id,contentLength:((S=t.content)==null?void 0:S.length)||0,title:t.title});try{if(t.id.startsWith("local-")){console.log("Creating new document in database for local document");const E=await zc(t.title);await kp(E.id,t.content||""),e({...t,id:E.id}),console.log(" Local document created and saved to database with ID:",E.id),s("Document saved successfully!")}else await kp(t.id,t.content||""),console.log(" Document saved successfully to database"),s("Document saved successfully!");r()}catch(E){console.error(" Save failed:",E),console.error("Error details:",{message:E.message,stack:E.stack}),o("Failed to save document. Please try again.")}}else console.warn(" No document to save")},b=S=>{console.log("Content change received:",S),n(S)};return C.useEffect(()=>{console.log("Current document state:",t)},[t]),k.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[k.jsx(aA,{onNewDocument:y,onSave:x}),k.jsx(fA,{toasts:i,onRemoveToast:l}),k.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[k.jsx(uA,{isCollapsed:f,onToggle:()=>h(!f)}),k.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden",children:[k.jsx("div",{className:"flex-1 p-6 space-y-6 overflow-y-auto",children:k.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[k.jsx("div",{className:"lg:col-span-2 flex flex-col",children:k.jsx(EP,{value:t==null?void 0:t.content,onChange:b,highlights:c,onApplyFix:w})}),k.jsx("div",{className:"lg:col-span-1",children:k.jsx(lA,{onGrammarErrorsChange:v,onApplyFix:w})})]})}),k.jsx(cA,{wordCount:p,issueCount:a.length,lastSaved:"just now"})]})]})]})}function mA(){const t=sf(),[e,n]=C.useState(!1),[r,i]=C.useState(""),[s,o]=C.useState(""),[l,a]=C.useState(!1),[u,c]=C.useState(""),d=async f=>{f.preventDefault(),c(""),a(!0);try{e?(await GC(r,s),c("Please check your email for verification link")):(await QC(r,s),t("/"))}catch(h){c(h.message)}finally{a(!1)}};return k.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:k.jsxs("div",{className:"max-w-md w-full space-y-8",children:[k.jsx("div",{children:k.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:e?"Create your account":"Sign in to your account"})}),k.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[k.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[k.jsxs("div",{children:[k.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),k.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,value:r,onChange:f=>i(f.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),k.jsxs("div",{children:[k.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),k.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:s,onChange:f=>o(f.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),u&&k.jsx("div",{className:"text-sm text-center text-red-600",children:u}),k.jsx("div",{children:k.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:l?"Processing...":e?"Sign up":"Sign in"})}),k.jsx("div",{className:"text-sm text-center",children:k.jsx("button",{type:"button",onClick:()=>n(!e),className:"font-medium text-primary-600 hover:text-primary-500",children:e?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})]})})}function gA({children:t}){const{user:e,loading:n,initialized:r}=L0();return!r||n?k.jsx("div",{className:"h-screen flex items-center justify-center",children:"Loading..."}):e?k.jsx(k.Fragment,{children:t}):k.jsx(Zx,{to:"/login",replace:!0})}function yA(){const t=L0(e=>e.initialize);return C.useEffect(()=>{t()},[t]),k.jsx(iS,{children:k.jsxs(tS,{children:[k.jsx(Nc,{path:"/login",element:k.jsx(mA,{})}),k.jsx(Nc,{path:"/",element:k.jsx(gA,{children:k.jsx(pA,{})})})]})})}Du.createRoot(document.getElementById("root")).render(k.jsx(me.StrictMode,{children:k.jsx(yA,{})}));
